[HIT] ucp_config_read
#0  ucp_config_read (env_prefix=0x7d2c999de719 "TORCH", filename=0x0, config_p=0x7fffa58d5510) at core/ucp_context.c:685
#1  0x00007d2c9999a57f in c10d::CommUCX::CommUCX (this=0x1229efe8, comm_size=2, logger=...) at /data/ZYH/torch_ucc/src/torch_ucc_comm.cpp:40
#2  0x00007d2c9992efba in c10d::Comm::Comm (this=0x1229efd0, logger_=..., oob_=std::shared_ptr<c10d::torch_ucc_oob_coll_info_t> (use count 4, weak count 0) = {...}, dev=..., is_health_check=false) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:336
#3  0x00007d2c9998dfd0 in std::_Construct<c10d::Comm, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (__p=0x1229efd0) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/stl_construct.h:119
#4  0x00007d2c9998a36c in std::allocator_traits<std::allocator<void> >::construct<c10d::Comm, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (__p=0x1229efd0) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/alloc_traits.h:635
#5  0x00007d2c9998494a in std::_Sp_counted_ptr_inplace<c10d::Comm, std::allocator<void>, (__gnu_cxx::_Lock_policy)2>::_Sp_counted_ptr_inplace<c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (this=0x1229efc0, __a=...) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr_base.h:604
#6  0x00007d2c9997b2d0 in std::__shared_count<(__gnu_cxx::_Lock_policy)2>::__shared_count<c10d::Comm, std::allocator<void>, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (this=0x7fffa58d5c88, __p=@0x7fffa58d5c80: 0x0, __a=...) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr_base.h:971
#7  0x00007d2c9996e535 in std::__shared_ptr<c10d::Comm, (__gnu_cxx::_Lock_policy)2>::__shared_ptr<std::allocator<void>, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (this=0x7fffa58d5c80, __tag=...) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr_base.h:1715
#8  0x00007d2c9995fb42 in std::shared_ptr<c10d::Comm>::shared_ptr<std::allocator<void>, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (this=0x7fffa58d5c80, __tag=...) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr.h:464
#9  0x00007d2c99949448 in std::make_shared<c10d::Comm, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> () at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr.h:1010
#10 0x00007d2c9992fc97 in c10d::Comm::get_comm (id=@0xa9b14f8: 0, dev=..., oob=std::shared_ptr<c10d::torch_ucc_oob_coll_info_t> (use count 4, weak count 0) = {...}, logger=..., is_health_check=false) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:407
#11 0x00007d2c9993e3b2 in c10d::ProcessGroupUCC::initComm (this=0xa9b13a0, dev=...) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:1873
#12 0x00007d2c9993d8d9 in c10d::ProcessGroupUCC::send (this=0xa9b13a0, tensors=std::vector of length 1, capacity 1 = {...}, dstRank=1, tag=0) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:1710
#13 0x00007d2dca343100 in pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}::operator()(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int) const (__closure=0x96f13f8, c=0xa9b13a0, args#0=std::vector of length 1, capacity 1 = {...}, args#1=1, args#2=0) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:136
#14 0x00007d2dca41dc91 in pybind11::detail::argument_loader<c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int>::call_impl<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&, 0ul, 1ul, 2ul, 3ul, pybind11::gil_scoped_release>(pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&, std::integer_sequence<unsigned long, 0ul, 1ul, 2ul, 3ul>, pybind11::gil_scoped_release&&) && (this=0x7fffa58d6340, f=...) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/cast.h:1631
#15 0x00007d2dca3e930e in pybind11::detail::argument_loader<c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int>::call<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, pybind11::gil_scoped_release, pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&>(pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&) && (this=0x7fffa58d6340, f=...) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/cast.h:1600
#16 0x00007d2dca39a925 in pybind11::cpp_function::initialize<pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&&, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (*)(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(pybind11::detail::function_call&)#1}::operator()(pybind11::detail::function_call&) const (__closure=0x0, call=...) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:278
#17 0x00007d2dca39ab46 in pybind11::cpp_function::initialize<pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&&, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (*)(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(pybind11::detail::function_call&)#1}::_FUN(pybind11::detail::function_call&) () at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:249
#18 0x00007d2dc8fe0da1 in pybind11::cpp_function::dispatcher (self=0x7d2c9bc16820, args_in=0x7d2dcbd4c400, kwargs_in=0x0) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:971
#19 0x0000000000528db7 in cfunction_call (func=0x7d2c9bc1b1a0, args=<optimized out>, kwargs=<optimized out>) at /usr/local/src/conda/python-3.11.13/Objects/methodobject.c:542
#20 0x000000000050454c in _PyObject_MakeTpCall (tstate=0x8a9518 <_PyRuntime+166328>, callable=0x7d2c9bc1b1a0, args=<optimized out>, nargs=<optimized out>, keywords=0x0) at /usr/local/src/conda/python-3.11.13/Objects/call.c:214
#21 0x0000000000511cf6 in _PyEval_EvalFrameDefault (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, frame=<optimized out>, frame@entry=0x7d2dcc5831e0, throwflag=throwflag@entry=0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:4769
#22 0x0000000000539503 in _PyEval_EvalFrame (throwflag=0, frame=0x7d2dcc5831e0, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Include/internal/pycore_ceval.h:73
#23 _PyEval_Vector (kwnames=<optimized out>, argcount=1, args=0x7d2d647caa78, locals=0x0, func=<optimized out>, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:6434
#24 _PyFunction_Vectorcall (func=<optimized out>, stack=0x7d2d647caa78, nargsf=<optimized out>, kwnames=<optimized out>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:393
#25 0x000000000054358c in _PyVectorcall_Call (kwargs=<optimized out>, tuple=<optimized out>, callable=0x7d2c9bcd13a0, func=0x539390 <_PyFunction_Vectorcall>, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:257
#26 _PyObject_Call (kwargs=<optimized out>, args=<optimized out>, callable=0x7d2c9bcd13a0, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:328
#27 PyObject_Call (callable=0x7d2c9bcd13a0, args=<optimized out>, kwargs=<optimized out>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:355
#28 0x0000000000515f58 in do_call_core (use_tracing=<optimized out>, kwdict=0x7d2c99b21b80, callargs=0x7d2dcc1be590, func=0x7d2c9bcd13a0, tstate=<optimized out>) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:7349
#29 _PyEval_EvalFrameDefault (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, frame=<optimized out>, frame@entry=0x7d2dcc583020, throwflag=throwflag@entry=0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:5376
#30 0x00000000005cd0aa in _PyEval_EvalFrame (throwflag=0, frame=0x7d2dcc583020, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Include/internal/pycore_ceval.h:73
#31 _PyEval_Vector (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, func=func@entry=0x7d2dcc1d60c0, locals=locals@entry=0x7d2dcc1f69c0, args=args@entry=0x0, argcount=argcount@entry=0, kwnames=kwnames@entry=0x0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:6434
#32 0x00000000005cc77f in PyEval_EvalCode (co=co@entry=0x7d2dcc1c8030, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:1148
#33 0x00000000005ed557 in run_eval_code_obj (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, co=co@entry=0x7d2dcc1c8030, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:1741
#34 0x00000000005e9080 in run_mod (mod=mod@entry=0x5431ae0, filename=filename@entry=0x7d2dcc1ff780, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0, flags=flags@entry=0x7fffa58d6dd8, arena=arena@entry=0x7d2dcc11b670) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:1762
#35 0x00000000005fde72 in pyrun_file (fp=fp@entry=0x53c05a0, filename=filename@entry=0x7d2dcc1ff780, start=start@entry=257, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0, closeit=closeit@entry=1, flags=0x7fffa58d6dd8) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:1657
#36 0x00000000005fd28f in _PyRun_SimpleFileObject (fp=0x53c05a0, filename=0x7d2dcc1ff780, closeit=1, flags=0x7fffa58d6dd8) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:440
#37 0x00000000005fcfb3 in _PyRun_AnyFileObject (fp=0x53c05a0, filename=filename@entry=0x7d2dcc1ff780, closeit=closeit@entry=1, flags=flags@entry=0x7fffa58d6dd8) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:79
#38 0x00000000005f7dae in pymain_run_file_obj (skip_source_first_line=0, filename=0x7d2dcc1ff780, program_name=0x7d2dcc1973b0) at /usr/local/src/conda/python-3.11.13/Modules/main.c:360
#39 pymain_run_file (config=0x88f560 <_PyRuntime+59904>) at /usr/local/src/conda/python-3.11.13/Modules/main.c:379
#40 pymain_run_python (exitcode=0x7fffa58d6dd0) at /usr/local/src/conda/python-3.11.13/Modules/main.c:605
#41 Py_RunMain () at /usr/local/src/conda/python-3.11.13/Modules/main.c:684
#42 0x00000000005bcdf9 in Py_BytesMain (argc=<optimized out>, argv=<optimized out>) at /usr/local/src/conda/python-3.11.13/Modules/main.c:738
#43 0x00007d2dcc22a1ca in __libc_start_call_main (main=main@entry=0x5bcd50 <main>, argc=argc@entry=3, argv=argv@entry=0x7fffa58d7038) at ../sysdeps/nptl/libc_start_call_main.h:58
#44 0x00007d2dcc22a28b in __libc_start_main_impl (main=0x5bcd50 <main>, argc=3, argv=0x7fffa58d7038, init=<optimized out>, fini=<optimized out>, rtld_fini=<optimized out>, stack_end=0x7fffa58d7028) at ../csu/libc-start.c:360
#45 0x00000000005bcc43 in _start ()
---
[HIT] ucp_init
#0  ucp_init (params=0x7fffa58d5530, config=0xab9b810, context_p=0x1229eff8) at /data/ZYH/ucx-1.18.1/install/include/ucp/api/ucp.h:2095
#1  0x00007d2c9999a7c9 in c10d::CommUCX::CommUCX (this=0x1229efe8, comm_size=2, logger=...) at /data/ZYH/torch_ucc/src/torch_ucc_comm.cpp:55
#2  0x00007d2c9992efba in c10d::Comm::Comm (this=0x1229efd0, logger_=..., oob_=std::shared_ptr<c10d::torch_ucc_oob_coll_info_t> (use count 4, weak count 0) = {...}, dev=..., is_health_check=false) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:336
#3  0x00007d2c9998dfd0 in std::_Construct<c10d::Comm, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (__p=0x1229efd0) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/stl_construct.h:119
#4  0x00007d2c9998a36c in std::allocator_traits<std::allocator<void> >::construct<c10d::Comm, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (__p=0x1229efd0) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/alloc_traits.h:635
#5  0x00007d2c9998494a in std::_Sp_counted_ptr_inplace<c10d::Comm, std::allocator<void>, (__gnu_cxx::_Lock_policy)2>::_Sp_counted_ptr_inplace<c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (this=0x1229efc0, __a=...) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr_base.h:604
#6  0x00007d2c9997b2d0 in std::__shared_count<(__gnu_cxx::_Lock_policy)2>::__shared_count<c10d::Comm, std::allocator<void>, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (this=0x7fffa58d5c88, __p=@0x7fffa58d5c80: 0x0, __a=...) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr_base.h:971
#7  0x00007d2c9996e535 in std::__shared_ptr<c10d::Comm, (__gnu_cxx::_Lock_policy)2>::__shared_ptr<std::allocator<void>, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (this=0x7fffa58d5c80, __tag=...) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr_base.h:1715
#8  0x00007d2c9995fb42 in std::shared_ptr<c10d::Comm>::shared_ptr<std::allocator<void>, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (this=0x7fffa58d5c80, __tag=...) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr.h:464
#9  0x00007d2c99949448 in std::make_shared<c10d::Comm, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> () at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr.h:1010
#10 0x00007d2c9992fc97 in c10d::Comm::get_comm (id=@0xa9b14f8: 0, dev=..., oob=std::shared_ptr<c10d::torch_ucc_oob_coll_info_t> (use count 4, weak count 0) = {...}, logger=..., is_health_check=false) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:407
#11 0x00007d2c9993e3b2 in c10d::ProcessGroupUCC::initComm (this=0xa9b13a0, dev=...) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:1873
#12 0x00007d2c9993d8d9 in c10d::ProcessGroupUCC::send (this=0xa9b13a0, tensors=std::vector of length 1, capacity 1 = {...}, dstRank=1, tag=0) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:1710
#13 0x00007d2dca343100 in pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}::operator()(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int) const (__closure=0x96f13f8, c=0xa9b13a0, args#0=std::vector of length 1, capacity 1 = {...}, args#1=1, args#2=0) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:136
#14 0x00007d2dca41dc91 in pybind11::detail::argument_loader<c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int>::call_impl<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&, 0ul, 1ul, 2ul, 3ul, pybind11::gil_scoped_release>(pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&, std::integer_sequence<unsigned long, 0ul, 1ul, 2ul, 3ul>, pybind11::gil_scoped_release&&) && (this=0x7fffa58d6340, f=...) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/cast.h:1631
#15 0x00007d2dca3e930e in pybind11::detail::argument_loader<c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int>::call<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, pybind11::gil_scoped_release, pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&>(pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&) && (this=0x7fffa58d6340, f=...) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/cast.h:1600
#16 0x00007d2dca39a925 in pybind11::cpp_function::initialize<pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&&, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (*)(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(pybind11::detail::function_call&)#1}::operator()(pybind11::detail::function_call&) const (__closure=0x0, call=...) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:278
#17 0x00007d2dca39ab46 in pybind11::cpp_function::initialize<pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&&, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (*)(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(pybind11::detail::function_call&)#1}::_FUN(pybind11::detail::function_call&) () at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:249
#18 0x00007d2dc8fe0da1 in pybind11::cpp_function::dispatcher (self=0x7d2c9bc16820, args_in=0x7d2dcbd4c400, kwargs_in=0x0) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:971
#19 0x0000000000528db7 in cfunction_call (func=0x7d2c9bc1b1a0, args=<optimized out>, kwargs=<optimized out>) at /usr/local/src/conda/python-3.11.13/Objects/methodobject.c:542
#20 0x000000000050454c in _PyObject_MakeTpCall (tstate=0x8a9518 <_PyRuntime+166328>, callable=0x7d2c9bc1b1a0, args=<optimized out>, nargs=<optimized out>, keywords=0x0) at /usr/local/src/conda/python-3.11.13/Objects/call.c:214
#21 0x0000000000511cf6 in _PyEval_EvalFrameDefault (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, frame=<optimized out>, frame@entry=0x7d2dcc5831e0, throwflag=throwflag@entry=0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:4769
#22 0x0000000000539503 in _PyEval_EvalFrame (throwflag=0, frame=0x7d2dcc5831e0, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Include/internal/pycore_ceval.h:73
#23 _PyEval_Vector (kwnames=<optimized out>, argcount=1, args=0x7d2d647caa78, locals=0x0, func=<optimized out>, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:6434
#24 _PyFunction_Vectorcall (func=<optimized out>, stack=0x7d2d647caa78, nargsf=<optimized out>, kwnames=<optimized out>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:393
#25 0x000000000054358c in _PyVectorcall_Call (kwargs=<optimized out>, tuple=<optimized out>, callable=0x7d2c9bcd13a0, func=0x539390 <_PyFunction_Vectorcall>, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:257
#26 _PyObject_Call (kwargs=<optimized out>, args=<optimized out>, callable=0x7d2c9bcd13a0, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:328
#27 PyObject_Call (callable=0x7d2c9bcd13a0, args=<optimized out>, kwargs=<optimized out>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:355
#28 0x0000000000515f58 in do_call_core (use_tracing=<optimized out>, kwdict=0x7d2c99b21b80, callargs=0x7d2dcc1be590, func=0x7d2c9bcd13a0, tstate=<optimized out>) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:7349
#29 _PyEval_EvalFrameDefault (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, frame=<optimized out>, frame@entry=0x7d2dcc583020, throwflag=throwflag@entry=0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:5376
#30 0x00000000005cd0aa in _PyEval_EvalFrame (throwflag=0, frame=0x7d2dcc583020, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Include/internal/pycore_ceval.h:73
#31 _PyEval_Vector (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, func=func@entry=0x7d2dcc1d60c0, locals=locals@entry=0x7d2dcc1f69c0, args=args@entry=0x0, argcount=argcount@entry=0, kwnames=kwnames@entry=0x0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:6434
#32 0x00000000005cc77f in PyEval_EvalCode (co=co@entry=0x7d2dcc1c8030, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:1148
#33 0x00000000005ed557 in run_eval_code_obj (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, co=co@entry=0x7d2dcc1c8030, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:1741
#34 0x00000000005e9080 in run_mod (mod=mod@entry=0x5431ae0, filename=filename@entry=0x7d2dcc1ff780, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0, flags=flags@entry=0x7fffa58d6dd8, arena=arena@entry=0x7d2dcc11b670) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:1762
#35 0x00000000005fde72 in pyrun_file (fp=fp@entry=0x53c05a0, filename=filename@entry=0x7d2dcc1ff780, start=start@entry=257, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0, closeit=closeit@entry=1, flags=0x7fffa58d6dd8) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:1657
#36 0x00000000005fd28f in _PyRun_SimpleFileObject (fp=0x53c05a0, filename=0x7d2dcc1ff780, closeit=1, flags=0x7fffa58d6dd8) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:440
#37 0x00000000005fcfb3 in _PyRun_AnyFileObject (fp=0x53c05a0, filename=filename@entry=0x7d2dcc1ff780, closeit=closeit@entry=1, flags=flags@entry=0x7fffa58d6dd8) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:79
#38 0x00000000005f7dae in pymain_run_file_obj (skip_source_first_line=0, filename=0x7d2dcc1ff780, program_name=0x7d2dcc1973b0) at /usr/local/src/conda/python-3.11.13/Modules/main.c:360
#39 pymain_run_file (config=0x88f560 <_PyRuntime+59904>) at /usr/local/src/conda/python-3.11.13/Modules/main.c:379
#40 pymain_run_python (exitcode=0x7fffa58d6dd0) at /usr/local/src/conda/python-3.11.13/Modules/main.c:605
#41 Py_RunMain () at /usr/local/src/conda/python-3.11.13/Modules/main.c:684
#42 0x00000000005bcdf9 in Py_BytesMain (argc=<optimized out>, argv=<optimized out>) at /usr/local/src/conda/python-3.11.13/Modules/main.c:738
#43 0x00007d2dcc22a1ca in __libc_start_call_main (main=main@entry=0x5bcd50 <main>, argc=argc@entry=3, argv=argv@entry=0x7fffa58d7038) at ../sysdeps/nptl/libc_start_call_main.h:58
#44 0x00007d2dcc22a28b in __libc_start_main_impl (main=0x5bcd50 <main>, argc=3, argv=0x7fffa58d7038, init=<optimized out>, fini=<optimized out>, rtld_fini=<optimized out>, stack_end=0x7fffa58d7028) at ../csu/libc-start.c:360
#45 0x00000000005bcc43 in _start ()
---
[HIT] ucp_init_version
#0  ucp_init_version (api_major_version=1, api_minor_version=18, params=0x7fffa58d5530, config=0xab9b810, context_p=0x1229eff8) at core/ucp_context.c:2264
#1  0x00007d2c99999dbe in ucp_init (params=0x7fffa58d5530, config=0xab9b810, context_p=0x1229eff8) at /data/ZYH/ucx-1.18.1/install/include/ucp/api/ucp.h:2095
#2  0x00007d2c9999a7c9 in c10d::CommUCX::CommUCX (this=0x1229efe8, comm_size=2, logger=...) at /data/ZYH/torch_ucc/src/torch_ucc_comm.cpp:55
#3  0x00007d2c9992efba in c10d::Comm::Comm (this=0x1229efd0, logger_=..., oob_=std::shared_ptr<c10d::torch_ucc_oob_coll_info_t> (use count 4, weak count 0) = {...}, dev=..., is_health_check=false) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:336
#4  0x00007d2c9998dfd0 in std::_Construct<c10d::Comm, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (__p=0x1229efd0) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/stl_construct.h:119
#5  0x00007d2c9998a36c in std::allocator_traits<std::allocator<void> >::construct<c10d::Comm, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (__p=0x1229efd0) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/alloc_traits.h:635
#6  0x00007d2c9998494a in std::_Sp_counted_ptr_inplace<c10d::Comm, std::allocator<void>, (__gnu_cxx::_Lock_policy)2>::_Sp_counted_ptr_inplace<c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (this=0x1229efc0, __a=...) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr_base.h:604
#7  0x00007d2c9997b2d0 in std::__shared_count<(__gnu_cxx::_Lock_policy)2>::__shared_count<c10d::Comm, std::allocator<void>, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (this=0x7fffa58d5c88, __p=@0x7fffa58d5c80: 0x0, __a=...) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr_base.h:971
#8  0x00007d2c9996e535 in std::__shared_ptr<c10d::Comm, (__gnu_cxx::_Lock_policy)2>::__shared_ptr<std::allocator<void>, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (this=0x7fffa58d5c80, __tag=...) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr_base.h:1715
#9  0x00007d2c9995fb42 in std::shared_ptr<c10d::Comm>::shared_ptr<std::allocator<void>, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (this=0x7fffa58d5c80, __tag=...) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr.h:464
#10 0x00007d2c99949448 in std::make_shared<c10d::Comm, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> () at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr.h:1010
#11 0x00007d2c9992fc97 in c10d::Comm::get_comm (id=@0xa9b14f8: 0, dev=..., oob=std::shared_ptr<c10d::torch_ucc_oob_coll_info_t> (use count 4, weak count 0) = {...}, logger=..., is_health_check=false) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:407
#12 0x00007d2c9993e3b2 in c10d::ProcessGroupUCC::initComm (this=0xa9b13a0, dev=...) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:1873
#13 0x00007d2c9993d8d9 in c10d::ProcessGroupUCC::send (this=0xa9b13a0, tensors=std::vector of length 1, capacity 1 = {...}, dstRank=1, tag=0) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:1710
#14 0x00007d2dca343100 in pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}::operator()(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int) const (__closure=0x96f13f8, c=0xa9b13a0, args#0=std::vector of length 1, capacity 1 = {...}, args#1=1, args#2=0) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:136
#15 0x00007d2dca41dc91 in pybind11::detail::argument_loader<c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int>::call_impl<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&, 0ul, 1ul, 2ul, 3ul, pybind11::gil_scoped_release>(pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&, std::integer_sequence<unsigned long, 0ul, 1ul, 2ul, 3ul>, pybind11::gil_scoped_release&&) && (this=0x7fffa58d6340, f=...) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/cast.h:1631
#16 0x00007d2dca3e930e in pybind11::detail::argument_loader<c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int>::call<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, pybind11::gil_scoped_release, pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&>(pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&) && (this=0x7fffa58d6340, f=...) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/cast.h:1600
#17 0x00007d2dca39a925 in pybind11::cpp_function::initialize<pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&&, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (*)(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(pybind11::detail::function_call&)#1}::operator()(pybind11::detail::function_call&) const (__closure=0x0, call=...) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:278
#18 0x00007d2dca39ab46 in pybind11::cpp_function::initialize<pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&&, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (*)(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(pybind11::detail::function_call&)#1}::_FUN(pybind11::detail::function_call&) () at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:249
#19 0x00007d2dc8fe0da1 in pybind11::cpp_function::dispatcher (self=0x7d2c9bc16820, args_in=0x7d2dcbd4c400, kwargs_in=0x0) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:971
#20 0x0000000000528db7 in cfunction_call (func=0x7d2c9bc1b1a0, args=<optimized out>, kwargs=<optimized out>) at /usr/local/src/conda/python-3.11.13/Objects/methodobject.c:542
#21 0x000000000050454c in _PyObject_MakeTpCall (tstate=0x8a9518 <_PyRuntime+166328>, callable=0x7d2c9bc1b1a0, args=<optimized out>, nargs=<optimized out>, keywords=0x0) at /usr/local/src/conda/python-3.11.13/Objects/call.c:214
#22 0x0000000000511cf6 in _PyEval_EvalFrameDefault (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, frame=<optimized out>, frame@entry=0x7d2dcc5831e0, throwflag=throwflag@entry=0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:4769
#23 0x0000000000539503 in _PyEval_EvalFrame (throwflag=0, frame=0x7d2dcc5831e0, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Include/internal/pycore_ceval.h:73
#24 _PyEval_Vector (kwnames=<optimized out>, argcount=1, args=0x7d2d647caa78, locals=0x0, func=<optimized out>, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:6434
#25 _PyFunction_Vectorcall (func=<optimized out>, stack=0x7d2d647caa78, nargsf=<optimized out>, kwnames=<optimized out>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:393
#26 0x000000000054358c in _PyVectorcall_Call (kwargs=<optimized out>, tuple=<optimized out>, callable=0x7d2c9bcd13a0, func=0x539390 <_PyFunction_Vectorcall>, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:257
#27 _PyObject_Call (kwargs=<optimized out>, args=<optimized out>, callable=0x7d2c9bcd13a0, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:328
#28 PyObject_Call (callable=0x7d2c9bcd13a0, args=<optimized out>, kwargs=<optimized out>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:355
#29 0x0000000000515f58 in do_call_core (use_tracing=<optimized out>, kwdict=0x7d2c99b21b80, callargs=0x7d2dcc1be590, func=0x7d2c9bcd13a0, tstate=<optimized out>) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:7349
#30 _PyEval_EvalFrameDefault (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, frame=<optimized out>, frame@entry=0x7d2dcc583020, throwflag=throwflag@entry=0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:5376
#31 0x00000000005cd0aa in _PyEval_EvalFrame (throwflag=0, frame=0x7d2dcc583020, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Include/internal/pycore_ceval.h:73
#32 _PyEval_Vector (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, func=func@entry=0x7d2dcc1d60c0, locals=locals@entry=0x7d2dcc1f69c0, args=args@entry=0x0, argcount=argcount@entry=0, kwnames=kwnames@entry=0x0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:6434
#33 0x00000000005cc77f in PyEval_EvalCode (co=co@entry=0x7d2dcc1c8030, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:1148
#34 0x00000000005ed557 in run_eval_code_obj (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, co=co@entry=0x7d2dcc1c8030, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:1741
#35 0x00000000005e9080 in run_mod (mod=mod@entry=0x5431ae0, filename=filename@entry=0x7d2dcc1ff780, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0, flags=flags@entry=0x7fffa58d6dd8, arena=arena@entry=0x7d2dcc11b670) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:1762
#36 0x00000000005fde72 in pyrun_file (fp=fp@entry=0x53c05a0, filename=filename@entry=0x7d2dcc1ff780, start=start@entry=257, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0, closeit=closeit@entry=1, flags=0x7fffa58d6dd8) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:1657
#37 0x00000000005fd28f in _PyRun_SimpleFileObject (fp=0x53c05a0, filename=0x7d2dcc1ff780, closeit=1, flags=0x7fffa58d6dd8) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:440
#38 0x00000000005fcfb3 in _PyRun_AnyFileObject (fp=0x53c05a0, filename=filename@entry=0x7d2dcc1ff780, closeit=closeit@entry=1, flags=flags@entry=0x7fffa58d6dd8) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:79
#39 0x00000000005f7dae in pymain_run_file_obj (skip_source_first_line=0, filename=0x7d2dcc1ff780, program_name=0x7d2dcc1973b0) at /usr/local/src/conda/python-3.11.13/Modules/main.c:360
#40 pymain_run_file (config=0x88f560 <_PyRuntime+59904>) at /usr/local/src/conda/python-3.11.13/Modules/main.c:379
#41 pymain_run_python (exitcode=0x7fffa58d6dd0) at /usr/local/src/conda/python-3.11.13/Modules/main.c:605
#42 Py_RunMain () at /usr/local/src/conda/python-3.11.13/Modules/main.c:684
#43 0x00000000005bcdf9 in Py_BytesMain (argc=<optimized out>, argv=<optimized out>) at /usr/local/src/conda/python-3.11.13/Modules/main.c:738
#44 0x00007d2dcc22a1ca in __libc_start_call_main (main=main@entry=0x5bcd50 <main>, argc=argc@entry=3, argv=argv@entry=0x7fffa58d7038) at ../sysdeps/nptl/libc_start_call_main.h:58
#45 0x00007d2dcc22a28b in __libc_start_main_impl (main=0x5bcd50 <main>, argc=3, argv=0x7fffa58d7038, init=<optimized out>, fini=<optimized out>, rtld_fini=<optimized out>, stack_end=0x7fffa58d7028) at ../csu/libc-start.c:360
#46 0x00000000005bcc43 in _start ()
---
[HIT] ucp_get_version_string
#0  ucp_get_version_string () at core/ucp_version.c:17
#1  0x00007d2c9943ecf5 in ucp_version_check (api_major_version=1, api_minor_version=18) at core/ucp_context.c:2240
#2  0x00007d2c9943ee8a in ucp_init_version (api_major_version=1, api_minor_version=18, params=0x7fffa58d5530, config=0xab9b810, context_p=0x1229eff8) at core/ucp_context.c:2269
#3  0x00007d2c99999dbe in ucp_init (params=0x7fffa58d5530, config=0xab9b810, context_p=0x1229eff8) at /data/ZYH/ucx-1.18.1/install/include/ucp/api/ucp.h:2095
#4  0x00007d2c9999a7c9 in c10d::CommUCX::CommUCX (this=0x1229efe8, comm_size=2, logger=...) at /data/ZYH/torch_ucc/src/torch_ucc_comm.cpp:55
#5  0x00007d2c9992efba in c10d::Comm::Comm (this=0x1229efd0, logger_=..., oob_=std::shared_ptr<c10d::torch_ucc_oob_coll_info_t> (use count 4, weak count 0) = {...}, dev=..., is_health_check=false) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:336
#6  0x00007d2c9998dfd0 in std::_Construct<c10d::Comm, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (__p=0x1229efd0) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/stl_construct.h:119
#7  0x00007d2c9998a36c in std::allocator_traits<std::allocator<void> >::construct<c10d::Comm, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (__p=0x1229efd0) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/alloc_traits.h:635
#8  0x00007d2c9998494a in std::_Sp_counted_ptr_inplace<c10d::Comm, std::allocator<void>, (__gnu_cxx::_Lock_policy)2>::_Sp_counted_ptr_inplace<c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (this=0x1229efc0, __a=...) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr_base.h:604
#9  0x00007d2c9997b2d0 in std::__shared_count<(__gnu_cxx::_Lock_policy)2>::__shared_count<c10d::Comm, std::allocator<void>, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (this=0x7fffa58d5c88, __p=@0x7fffa58d5c80: 0x0, __a=...) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr_base.h:971
#10 0x00007d2c9996e535 in std::__shared_ptr<c10d::Comm, (__gnu_cxx::_Lock_policy)2>::__shared_ptr<std::allocator<void>, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (this=0x7fffa58d5c80, __tag=...) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr_base.h:1715
#11 0x00007d2c9995fb42 in std::shared_ptr<c10d::Comm>::shared_ptr<std::allocator<void>, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (this=0x7fffa58d5c80, __tag=...) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr.h:464
#12 0x00007d2c99949448 in std::make_shared<c10d::Comm, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> () at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr.h:1010
#13 0x00007d2c9992fc97 in c10d::Comm::get_comm (id=@0xa9b14f8: 0, dev=..., oob=std::shared_ptr<c10d::torch_ucc_oob_coll_info_t> (use count 4, weak count 0) = {...}, logger=..., is_health_check=false) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:407
#14 0x00007d2c9993e3b2 in c10d::ProcessGroupUCC::initComm (this=0xa9b13a0, dev=...) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:1873
#15 0x00007d2c9993d8d9 in c10d::ProcessGroupUCC::send (this=0xa9b13a0, tensors=std::vector of length 1, capacity 1 = {...}, dstRank=1, tag=0) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:1710
#16 0x00007d2dca343100 in pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}::operator()(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int) const (__closure=0x96f13f8, c=0xa9b13a0, args#0=std::vector of length 1, capacity 1 = {...}, args#1=1, args#2=0) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:136
#17 0x00007d2dca41dc91 in pybind11::detail::argument_loader<c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int>::call_impl<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&, 0ul, 1ul, 2ul, 3ul, pybind11::gil_scoped_release>(pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&, std::integer_sequence<unsigned long, 0ul, 1ul, 2ul, 3ul>, pybind11::gil_scoped_release&&) && (this=0x7fffa58d6340, f=...) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/cast.h:1631
#18 0x00007d2dca3e930e in pybind11::detail::argument_loader<c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int>::call<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, pybind11::gil_scoped_release, pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&>(pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&) && (this=0x7fffa58d6340, f=...) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/cast.h:1600
#19 0x00007d2dca39a925 in pybind11::cpp_function::initialize<pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&&, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (*)(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(pybind11::detail::function_call&)#1}::operator()(pybind11::detail::function_call&) const (__closure=0x0, call=...) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:278
#20 0x00007d2dca39ab46 in pybind11::cpp_function::initialize<pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&&, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (*)(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(pybind11::detail::function_call&)#1}::_FUN(pybind11::detail::function_call&) () at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:249
#21 0x00007d2dc8fe0da1 in pybind11::cpp_function::dispatcher (self=0x7d2c9bc16820, args_in=0x7d2dcbd4c400, kwargs_in=0x0) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:971
#22 0x0000000000528db7 in cfunction_call (func=0x7d2c9bc1b1a0, args=<optimized out>, kwargs=<optimized out>) at /usr/local/src/conda/python-3.11.13/Objects/methodobject.c:542
#23 0x000000000050454c in _PyObject_MakeTpCall (tstate=0x8a9518 <_PyRuntime+166328>, callable=0x7d2c9bc1b1a0, args=<optimized out>, nargs=<optimized out>, keywords=0x0) at /usr/local/src/conda/python-3.11.13/Objects/call.c:214
#24 0x0000000000511cf6 in _PyEval_EvalFrameDefault (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, frame=<optimized out>, frame@entry=0x7d2dcc5831e0, throwflag=throwflag@entry=0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:4769
#25 0x0000000000539503 in _PyEval_EvalFrame (throwflag=0, frame=0x7d2dcc5831e0, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Include/internal/pycore_ceval.h:73
#26 _PyEval_Vector (kwnames=<optimized out>, argcount=1, args=0x7d2d647caa78, locals=0x0, func=<optimized out>, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:6434
#27 _PyFunction_Vectorcall (func=<optimized out>, stack=0x7d2d647caa78, nargsf=<optimized out>, kwnames=<optimized out>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:393
#28 0x000000000054358c in _PyVectorcall_Call (kwargs=<optimized out>, tuple=<optimized out>, callable=0x7d2c9bcd13a0, func=0x539390 <_PyFunction_Vectorcall>, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:257
#29 _PyObject_Call (kwargs=<optimized out>, args=<optimized out>, callable=0x7d2c9bcd13a0, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:328
#30 PyObject_Call (callable=0x7d2c9bcd13a0, args=<optimized out>, kwargs=<optimized out>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:355
#31 0x0000000000515f58 in do_call_core (use_tracing=<optimized out>, kwdict=0x7d2c99b21b80, callargs=0x7d2dcc1be590, func=0x7d2c9bcd13a0, tstate=<optimized out>) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:7349
#32 _PyEval_EvalFrameDefault (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, frame=<optimized out>, frame@entry=0x7d2dcc583020, throwflag=throwflag@entry=0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:5376
#33 0x00000000005cd0aa in _PyEval_EvalFrame (throwflag=0, frame=0x7d2dcc583020, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Include/internal/pycore_ceval.h:73
#34 _PyEval_Vector (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, func=func@entry=0x7d2dcc1d60c0, locals=locals@entry=0x7d2dcc1f69c0, args=args@entry=0x0, argcount=argcount@entry=0, kwnames=kwnames@entry=0x0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:6434
#35 0x00000000005cc77f in PyEval_EvalCode (co=co@entry=0x7d2dcc1c8030, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:1148
#36 0x00000000005ed557 in run_eval_code_obj (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, co=co@entry=0x7d2dcc1c8030, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:1741
#37 0x00000000005e9080 in run_mod (mod=mod@entry=0x5431ae0, filename=filename@entry=0x7d2dcc1ff780, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0, flags=flags@entry=0x7fffa58d6dd8, arena=arena@entry=0x7d2dcc11b670) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:1762
#38 0x00000000005fde72 in pyrun_file (fp=fp@entry=0x53c05a0, filename=filename@entry=0x7d2dcc1ff780, start=start@entry=257, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0, closeit=closeit@entry=1, flags=0x7fffa58d6dd8) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:1657
#39 0x00000000005fd28f in _PyRun_SimpleFileObject (fp=0x53c05a0, filename=0x7d2dcc1ff780, closeit=1, flags=0x7fffa58d6dd8) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:440
#40 0x00000000005fcfb3 in _PyRun_AnyFileObject (fp=0x53c05a0, filename=filename@entry=0x7d2dcc1ff780, closeit=closeit@entry=1, flags=flags@entry=0x7fffa58d6dd8) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:79
#41 0x00000000005f7dae in pymain_run_file_obj (skip_source_first_line=0, filename=0x7d2dcc1ff780, program_name=0x7d2dcc1973b0) at /usr/local/src/conda/python-3.11.13/Modules/main.c:360
#42 pymain_run_file (config=0x88f560 <_PyRuntime+59904>) at /usr/local/src/conda/python-3.11.13/Modules/main.c:379
#43 pymain_run_python (exitcode=0x7fffa58d6dd0) at /usr/local/src/conda/python-3.11.13/Modules/main.c:605
#44 Py_RunMain () at /usr/local/src/conda/python-3.11.13/Modules/main.c:684
#45 0x00000000005bcdf9 in Py_BytesMain (argc=<optimized out>, argv=<optimized out>) at /usr/local/src/conda/python-3.11.13/Modules/main.c:738
#46 0x00007d2dcc22a1ca in __libc_start_call_main (main=main@entry=0x5bcd50 <main>, argc=argc@entry=3, argv=argv@entry=0x7fffa58d7038) at ../sysdeps/nptl/libc_start_call_main.h:58
#47 0x00007d2dcc22a28b in __libc_start_main_impl (main=0x5bcd50 <main>, argc=3, argv=0x7fffa58d7038, init=<optimized out>, fini=<optimized out>, rtld_fini=<optimized out>, stack_end=0x7fffa58d7028) at ../csu/libc-start.c:360
#48 0x00000000005bcc43 in _start ()
---
[HIT] ucm_sbrk
#0  ucm_sbrk (increment=139264) at event/event.c:385
#1  0x00007d2d95632064 in ucm_override_sbrk (arg0=139264) at util/replace.c:58
#2  0x00007d2dcc2aaa26 in __glibc_morecore (increment=increment@entry=139264) at ./malloc/morecore.c:29
#3  0x00007d2dcc2acbf7 in sysmalloc (av=0x7d2dcc403ac0 <main_arena>, nb=16400) at ./malloc/malloc.c:2709
#4  _int_malloc (av=av@entry=0x7d2dcc403ac0 <main_arena>, bytes=bytes@entry=16384) at ./malloc/malloc.c:4481
#5  0x00007d2dcc2ad6f4 in __GI___libc_malloc (bytes=16384) at ./malloc/malloc.c:3336
#6  0x00007d2d94fad389 in nl_recv () from /lib/x86_64-linux-gnu/libnl-3.so.200
#7  0x00007d2d94fadcf5 in nl_recvmsgs_report () from /lib/x86_64-linux-gnu/libnl-3.so.200
#8  0x00007d2d94fae31d in nl_recvmsgs () from /lib/x86_64-linux-gnu/libnl-3.so.200
#9  0x00007d2d6b2f1f98 in ?? () from /lib/x86_64-linux-gnu/libibverbs.so.1
#10 0x00007d2d6b2f515a in ibv_get_device_list () from /lib/x86_64-linux-gnu/libibverbs.so.1
#11 0x00007d2d3e1adb21 in uct_ib_query_md_resources (component=0x7d2c56a9eee0 <uct_gga_component>, resources_p=0x7fffa58d51f0, num_resources_p=0x7fffa58d51ec) at base/ib_md.c:821
#12 0x00007d2d646b1275 in uct_component_query (component=0x7d2c56a9eee0 <uct_gga_component>, component_attr=0x122a9f10) at base/uct_component.c:91
#13 0x00007d2c9943d22f in ucp_fill_resources (context=0x122a21e0, config=0xab9b810) at core/ucp_context.c:1799
#14 0x00007d2c9943ef80 in ucp_init_version (api_major_version=1, api_minor_version=18, params=0x7fffa58d5530, config=0xab9b810, context_p=0x1229eff8) at core/ucp_context.c:2299
#15 0x00007d2c99999dbe in ucp_init (params=0x7fffa58d5530, config=0xab9b810, context_p=0x1229eff8) at /data/ZYH/ucx-1.18.1/install/include/ucp/api/ucp.h:2095
#16 0x00007d2c9999a7c9 in c10d::CommUCX::CommUCX (this=0x1229efe8, comm_size=2, logger=...) at /data/ZYH/torch_ucc/src/torch_ucc_comm.cpp:55
#17 0x00007d2c9992efba in c10d::Comm::Comm (this=0x1229efd0, logger_=..., oob_=std::shared_ptr<c10d::torch_ucc_oob_coll_info_t> (use count 4, weak count 0) = {...}, dev=..., is_health_check=false) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:336
#18 0x00007d2c9998dfd0 in std::_Construct<c10d::Comm, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (__p=0x1229efd0) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/stl_construct.h:119
#19 0x00007d2c9998a36c in std::allocator_traits<std::allocator<void> >::construct<c10d::Comm, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (__p=0x1229efd0) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/alloc_traits.h:635
#20 0x00007d2c9998494a in std::_Sp_counted_ptr_inplace<c10d::Comm, std::allocator<void>, (__gnu_cxx::_Lock_policy)2>::_Sp_counted_ptr_inplace<c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (this=0x1229efc0, __a=...) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr_base.h:604
#21 0x00007d2c9997b2d0 in std::__shared_count<(__gnu_cxx::_Lock_policy)2>::__shared_count<c10d::Comm, std::allocator<void>, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (this=0x7fffa58d5c88, __p=@0x7fffa58d5c80: 0x0, __a=...) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr_base.h:971
#22 0x00007d2c9996e535 in std::__shared_ptr<c10d::Comm, (__gnu_cxx::_Lock_policy)2>::__shared_ptr<std::allocator<void>, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (this=0x7fffa58d5c80, __tag=...) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr_base.h:1715
#23 0x00007d2c9995fb42 in std::shared_ptr<c10d::Comm>::shared_ptr<std::allocator<void>, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (this=0x7fffa58d5c80, __tag=...) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr.h:464
#24 0x00007d2c99949448 in std::make_shared<c10d::Comm, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> () at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr.h:1010
#25 0x00007d2c9992fc97 in c10d::Comm::get_comm (id=@0xa9b14f8: 0, dev=..., oob=std::shared_ptr<c10d::torch_ucc_oob_coll_info_t> (use count 4, weak count 0) = {...}, logger=..., is_health_check=false) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:407
#26 0x00007d2c9993e3b2 in c10d::ProcessGroupUCC::initComm (this=0xa9b13a0, dev=...) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:1873
#27 0x00007d2c9993d8d9 in c10d::ProcessGroupUCC::send (this=0xa9b13a0, tensors=std::vector of length 1, capacity 1 = {...}, dstRank=1, tag=0) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:1710
#28 0x00007d2dca343100 in pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}::operator()(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int) const (__closure=0x96f13f8, c=0xa9b13a0, args#0=std::vector of length 1, capacity 1 = {...}, args#1=1, args#2=0) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:136
#29 0x00007d2dca41dc91 in pybind11::detail::argument_loader<c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int>::call_impl<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&, 0ul, 1ul, 2ul, 3ul, pybind11::gil_scoped_release>(pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&, std::integer_sequence<unsigned long, 0ul, 1ul, 2ul, 3ul>, pybind11::gil_scoped_release&&) && (this=0x7fffa58d6340, f=...) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/cast.h:1631
#30 0x00007d2dca3e930e in pybind11::detail::argument_loader<c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int>::call<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, pybind11::gil_scoped_release, pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&>(pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&) && (this=0x7fffa58d6340, f=...) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/cast.h:1600
#31 0x00007d2dca39a925 in pybind11::cpp_function::initialize<pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&&, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (*)(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(pybind11::detail::function_call&)#1}::operator()(pybind11::detail::function_call&) const (__closure=0x0, call=...) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:278
#32 0x00007d2dca39ab46 in pybind11::cpp_function::initialize<pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&&, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (*)(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(pybind11::detail::function_call&)#1}::_FUN(pybind11::detail::function_call&) () at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:249
#33 0x00007d2dc8fe0da1 in pybind11::cpp_function::dispatcher (self=0x7d2c9bc16820, args_in=0x7d2dcbd4c400, kwargs_in=0x0) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:971
#34 0x0000000000528db7 in cfunction_call (func=0x7d2c9bc1b1a0, args=<optimized out>, kwargs=<optimized out>) at /usr/local/src/conda/python-3.11.13/Objects/methodobject.c:542
#35 0x000000000050454c in _PyObject_MakeTpCall (tstate=0x8a9518 <_PyRuntime+166328>, callable=0x7d2c9bc1b1a0, args=<optimized out>, nargs=<optimized out>, keywords=0x0) at /usr/local/src/conda/python-3.11.13/Objects/call.c:214
#36 0x0000000000511cf6 in _PyEval_EvalFrameDefault (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, frame=<optimized out>, frame@entry=0x7d2dcc5831e0, throwflag=throwflag@entry=0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:4769
#37 0x0000000000539503 in _PyEval_EvalFrame (throwflag=0, frame=0x7d2dcc5831e0, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Include/internal/pycore_ceval.h:73
#38 _PyEval_Vector (kwnames=<optimized out>, argcount=1, args=0x7d2d647caa78, locals=0x0, func=<optimized out>, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:6434
#39 _PyFunction_Vectorcall (func=<optimized out>, stack=0x7d2d647caa78, nargsf=<optimized out>, kwnames=<optimized out>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:393
#40 0x000000000054358c in _PyVectorcall_Call (kwargs=<optimized out>, tuple=<optimized out>, callable=0x7d2c9bcd13a0, func=0x539390 <_PyFunction_Vectorcall>, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:257
#41 _PyObject_Call (kwargs=<optimized out>, args=<optimized out>, callable=0x7d2c9bcd13a0, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:328
#42 PyObject_Call (callable=0x7d2c9bcd13a0, args=<optimized out>, kwargs=<optimized out>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:355
#43 0x0000000000515f58 in do_call_core (use_tracing=<optimized out>, kwdict=0x7d2c99b21b80, callargs=0x7d2dcc1be590, func=0x7d2c9bcd13a0, tstate=<optimized out>) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:7349
#44 _PyEval_EvalFrameDefault (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, frame=<optimized out>, frame@entry=0x7d2dcc583020, throwflag=throwflag@entry=0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:5376
#45 0x00000000005cd0aa in _PyEval_EvalFrame (throwflag=0, frame=0x7d2dcc583020, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Include/internal/pycore_ceval.h:73
#46 _PyEval_Vector (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, func=func@entry=0x7d2dcc1d60c0, locals=locals@entry=0x7d2dcc1f69c0, args=args@entry=0x0, argcount=argcount@entry=0, kwnames=kwnames@entry=0x0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:6434
#47 0x00000000005cc77f in PyEval_EvalCode (co=co@entry=0x7d2dcc1c8030, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:1148
#48 0x00000000005ed557 in run_eval_code_obj (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, co=co@entry=0x7d2dcc1c8030, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:1741
#49 0x00000000005e9080 in run_mod (mod=mod@entry=0x5431ae0, filename=filename@entry=0x7d2dcc1ff780, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0, flags=flags@entry=0x7fffa58d6dd8, arena=arena@entry=0x7d2dcc11b670) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:1762
---
[HIT] ucm_event_enter
#0  ucm_event_enter () at event/event.c:163
#1  0x00007d2d9562b644 in ucm_sbrk (increment=139264) at event/event.c:388
#2  0x00007d2d95632064 in ucm_override_sbrk (arg0=139264) at util/replace.c:58
#3  0x00007d2dcc2aaa26 in __glibc_morecore (increment=increment@entry=139264) at ./malloc/morecore.c:29
#4  0x00007d2dcc2acbf7 in sysmalloc (av=0x7d2dcc403ac0 <main_arena>, nb=16400) at ./malloc/malloc.c:2709
#5  _int_malloc (av=av@entry=0x7d2dcc403ac0 <main_arena>, bytes=bytes@entry=16384) at ./malloc/malloc.c:4481
#6  0x00007d2dcc2ad6f4 in __GI___libc_malloc (bytes=16384) at ./malloc/malloc.c:3336
#7  0x00007d2d94fad389 in nl_recv () from /lib/x86_64-linux-gnu/libnl-3.so.200
#8  0x00007d2d94fadcf5 in nl_recvmsgs_report () from /lib/x86_64-linux-gnu/libnl-3.so.200
#9  0x00007d2d94fae31d in nl_recvmsgs () from /lib/x86_64-linux-gnu/libnl-3.so.200
#10 0x00007d2d6b2f1f98 in ?? () from /lib/x86_64-linux-gnu/libibverbs.so.1
#11 0x00007d2d6b2f515a in ibv_get_device_list () from /lib/x86_64-linux-gnu/libibverbs.so.1
#12 0x00007d2d3e1adb21 in uct_ib_query_md_resources (component=0x7d2c56a9eee0 <uct_gga_component>, resources_p=0x7fffa58d51f0, num_resources_p=0x7fffa58d51ec) at base/ib_md.c:821
#13 0x00007d2d646b1275 in uct_component_query (component=0x7d2c56a9eee0 <uct_gga_component>, component_attr=0x122a9f10) at base/uct_component.c:91
#14 0x00007d2c9943d22f in ucp_fill_resources (context=0x122a21e0, config=0xab9b810) at core/ucp_context.c:1799
#15 0x00007d2c9943ef80 in ucp_init_version (api_major_version=1, api_minor_version=18, params=0x7fffa58d5530, config=0xab9b810, context_p=0x1229eff8) at core/ucp_context.c:2299
#16 0x00007d2c99999dbe in ucp_init (params=0x7fffa58d5530, config=0xab9b810, context_p=0x1229eff8) at /data/ZYH/ucx-1.18.1/install/include/ucp/api/ucp.h:2095
#17 0x00007d2c9999a7c9 in c10d::CommUCX::CommUCX (this=0x1229efe8, comm_size=2, logger=...) at /data/ZYH/torch_ucc/src/torch_ucc_comm.cpp:55
#18 0x00007d2c9992efba in c10d::Comm::Comm (this=0x1229efd0, logger_=..., oob_=std::shared_ptr<c10d::torch_ucc_oob_coll_info_t> (use count 4, weak count 0) = {...}, dev=..., is_health_check=false) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:336
#19 0x00007d2c9998dfd0 in std::_Construct<c10d::Comm, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (__p=0x1229efd0) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/stl_construct.h:119
#20 0x00007d2c9998a36c in std::allocator_traits<std::allocator<void> >::construct<c10d::Comm, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (__p=0x1229efd0) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/alloc_traits.h:635
#21 0x00007d2c9998494a in std::_Sp_counted_ptr_inplace<c10d::Comm, std::allocator<void>, (__gnu_cxx::_Lock_policy)2>::_Sp_counted_ptr_inplace<c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (this=0x1229efc0, __a=...) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr_base.h:604
#22 0x00007d2c9997b2d0 in std::__shared_count<(__gnu_cxx::_Lock_policy)2>::__shared_count<c10d::Comm, std::allocator<void>, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (this=0x7fffa58d5c88, __p=@0x7fffa58d5c80: 0x0, __a=...) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr_base.h:971
#23 0x00007d2c9996e535 in std::__shared_ptr<c10d::Comm, (__gnu_cxx::_Lock_policy)2>::__shared_ptr<std::allocator<void>, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (this=0x7fffa58d5c80, __tag=...) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr_base.h:1715
#24 0x00007d2c9995fb42 in std::shared_ptr<c10d::Comm>::shared_ptr<std::allocator<void>, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (this=0x7fffa58d5c80, __tag=...) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr.h:464
#25 0x00007d2c99949448 in std::make_shared<c10d::Comm, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> () at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr.h:1010
#26 0x00007d2c9992fc97 in c10d::Comm::get_comm (id=@0xa9b14f8: 0, dev=..., oob=std::shared_ptr<c10d::torch_ucc_oob_coll_info_t> (use count 4, weak count 0) = {...}, logger=..., is_health_check=false) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:407
#27 0x00007d2c9993e3b2 in c10d::ProcessGroupUCC::initComm (this=0xa9b13a0, dev=...) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:1873
#28 0x00007d2c9993d8d9 in c10d::ProcessGroupUCC::send (this=0xa9b13a0, tensors=std::vector of length 1, capacity 1 = {...}, dstRank=1, tag=0) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:1710
#29 0x00007d2dca343100 in pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}::operator()(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int) const (__closure=0x96f13f8, c=0xa9b13a0, args#0=std::vector of length 1, capacity 1 = {...}, args#1=1, args#2=0) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:136
#30 0x00007d2dca41dc91 in pybind11::detail::argument_loader<c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int>::call_impl<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&, 0ul, 1ul, 2ul, 3ul, pybind11::gil_scoped_release>(pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&, std::integer_sequence<unsigned long, 0ul, 1ul, 2ul, 3ul>, pybind11::gil_scoped_release&&) && (this=0x7fffa58d6340, f=...) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/cast.h:1631
#31 0x00007d2dca3e930e in pybind11::detail::argument_loader<c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int>::call<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, pybind11::gil_scoped_release, pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&>(pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&) && (this=0x7fffa58d6340, f=...) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/cast.h:1600
#32 0x00007d2dca39a925 in pybind11::cpp_function::initialize<pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&&, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (*)(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(pybind11::detail::function_call&)#1}::operator()(pybind11::detail::function_call&) const (__closure=0x0, call=...) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:278
#33 0x00007d2dca39ab46 in pybind11::cpp_function::initialize<pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&&, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (*)(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(pybind11::detail::function_call&)#1}::_FUN(pybind11::detail::function_call&) () at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:249
#34 0x00007d2dc8fe0da1 in pybind11::cpp_function::dispatcher (self=0x7d2c9bc16820, args_in=0x7d2dcbd4c400, kwargs_in=0x0) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:971
#35 0x0000000000528db7 in cfunction_call (func=0x7d2c9bc1b1a0, args=<optimized out>, kwargs=<optimized out>) at /usr/local/src/conda/python-3.11.13/Objects/methodobject.c:542
#36 0x000000000050454c in _PyObject_MakeTpCall (tstate=0x8a9518 <_PyRuntime+166328>, callable=0x7d2c9bc1b1a0, args=<optimized out>, nargs=<optimized out>, keywords=0x0) at /usr/local/src/conda/python-3.11.13/Objects/call.c:214
#37 0x0000000000511cf6 in _PyEval_EvalFrameDefault (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, frame=<optimized out>, frame@entry=0x7d2dcc5831e0, throwflag=throwflag@entry=0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:4769
#38 0x0000000000539503 in _PyEval_EvalFrame (throwflag=0, frame=0x7d2dcc5831e0, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Include/internal/pycore_ceval.h:73
#39 _PyEval_Vector (kwnames=<optimized out>, argcount=1, args=0x7d2d647caa78, locals=0x0, func=<optimized out>, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:6434
#40 _PyFunction_Vectorcall (func=<optimized out>, stack=0x7d2d647caa78, nargsf=<optimized out>, kwnames=<optimized out>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:393
#41 0x000000000054358c in _PyVectorcall_Call (kwargs=<optimized out>, tuple=<optimized out>, callable=0x7d2c9bcd13a0, func=0x539390 <_PyFunction_Vectorcall>, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:257
#42 _PyObject_Call (kwargs=<optimized out>, args=<optimized out>, callable=0x7d2c9bcd13a0, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:328
#43 PyObject_Call (callable=0x7d2c9bcd13a0, args=<optimized out>, kwargs=<optimized out>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:355
#44 0x0000000000515f58 in do_call_core (use_tracing=<optimized out>, kwdict=0x7d2c99b21b80, callargs=0x7d2dcc1be590, func=0x7d2c9bcd13a0, tstate=<optimized out>) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:7349
#45 _PyEval_EvalFrameDefault (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, frame=<optimized out>, frame@entry=0x7d2dcc583020, throwflag=throwflag@entry=0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:5376
#46 0x00000000005cd0aa in _PyEval_EvalFrame (throwflag=0, frame=0x7d2dcc583020, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Include/internal/pycore_ceval.h:73
#47 _PyEval_Vector (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, func=func@entry=0x7d2dcc1d60c0, locals=locals@entry=0x7d2dcc1f69c0, args=args@entry=0x0, argcount=argcount@entry=0, kwnames=kwnames@entry=0x0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:6434
#48 0x00000000005cc77f in PyEval_EvalCode (co=co@entry=0x7d2dcc1c8030, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:1148
#49 0x00000000005ed557 in run_eval_code_obj (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, co=co@entry=0x7d2dcc1c8030, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:1741
---
[HIT] ucm_event_memory_cleanup
#0  ucm_event_dispatch (event_type=UCM_EVENT_SBRK, event=0x7fffa58d4c50) at event/event.c:143
#1  0x00007d2d9562b76c in ucm_sbrk (increment=139264) at event/event.c:400
#2  0x00007d2d95632064 in ucm_override_sbrk (arg0=139264) at util/replace.c:58
#3  0x00007d2dcc2aaa26 in __glibc_morecore (increment=increment@entry=139264) at ./malloc/morecore.c:29
#4  0x00007d2dcc2acbf7 in sysmalloc (av=0x7d2dcc403ac0 <main_arena>, nb=16400) at ./malloc/malloc.c:2709
#5  _int_malloc (av=av@entry=0x7d2dcc403ac0 <main_arena>, bytes=bytes@entry=16384) at ./malloc/malloc.c:4481
#6  0x00007d2dcc2ad6f4 in __GI___libc_malloc (bytes=16384) at ./malloc/malloc.c:3336
#7  0x00007d2d94fad389 in nl_recv () from /lib/x86_64-linux-gnu/libnl-3.so.200
#8  0x00007d2d94fadcf5 in nl_recvmsgs_report () from /lib/x86_64-linux-gnu/libnl-3.so.200
#9  0x00007d2d94fae31d in nl_recvmsgs () from /lib/x86_64-linux-gnu/libnl-3.so.200
#10 0x00007d2d6b2f1f98 in ?? () from /lib/x86_64-linux-gnu/libibverbs.so.1
#11 0x00007d2d6b2f515a in ibv_get_device_list () from /lib/x86_64-linux-gnu/libibverbs.so.1
#12 0x00007d2d3e1adb21 in uct_ib_query_md_resources (component=0x7d2c56a9eee0 <uct_gga_component>, resources_p=0x7fffa58d51f0, num_resources_p=0x7fffa58d51ec) at base/ib_md.c:821
#13 0x00007d2d646b1275 in uct_component_query (component=0x7d2c56a9eee0 <uct_gga_component>, component_attr=0x122a9f10) at base/uct_component.c:91
#14 0x00007d2c9943d22f in ucp_fill_resources (context=0x122a21e0, config=0xab9b810) at core/ucp_context.c:1799
#15 0x00007d2c9943ef80 in ucp_init_version (api_major_version=1, api_minor_version=18, params=0x7fffa58d5530, config=0xab9b810, context_p=0x1229eff8) at core/ucp_context.c:2299
#16 0x00007d2c99999dbe in ucp_init (params=0x7fffa58d5530, config=0xab9b810, context_p=0x1229eff8) at /data/ZYH/ucx-1.18.1/install/include/ucp/api/ucp.h:2095
#17 0x00007d2c9999a7c9 in c10d::CommUCX::CommUCX (this=0x1229efe8, comm_size=2, logger=...) at /data/ZYH/torch_ucc/src/torch_ucc_comm.cpp:55
#18 0x00007d2c9992efba in c10d::Comm::Comm (this=0x1229efd0, logger_=..., oob_=std::shared_ptr<c10d::torch_ucc_oob_coll_info_t> (use count 4, weak count 0) = {...}, dev=..., is_health_check=false) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:336
#19 0x00007d2c9998dfd0 in std::_Construct<c10d::Comm, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (__p=0x1229efd0) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/stl_construct.h:119
#20 0x00007d2c9998a36c in std::allocator_traits<std::allocator<void> >::construct<c10d::Comm, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (__p=0x1229efd0) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/alloc_traits.h:635
#21 0x00007d2c9998494a in std::_Sp_counted_ptr_inplace<c10d::Comm, std::allocator<void>, (__gnu_cxx::_Lock_policy)2>::_Sp_counted_ptr_inplace<c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (this=0x1229efc0, __a=...) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr_base.h:604
#22 0x00007d2c9997b2d0 in std::__shared_count<(__gnu_cxx::_Lock_policy)2>::__shared_count<c10d::Comm, std::allocator<void>, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (this=0x7fffa58d5c88, __p=@0x7fffa58d5c80: 0x0, __a=...) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr_base.h:971
#23 0x00007d2c9996e535 in std::__shared_ptr<c10d::Comm, (__gnu_cxx::_Lock_policy)2>::__shared_ptr<std::allocator<void>, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (this=0x7fffa58d5c80, __tag=...) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr_base.h:1715
#24 0x00007d2c9995fb42 in std::shared_ptr<c10d::Comm>::shared_ptr<std::allocator<void>, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (this=0x7fffa58d5c80, __tag=...) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr.h:464
#25 0x00007d2c99949448 in std::make_shared<c10d::Comm, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> () at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr.h:1010
#26 0x00007d2c9992fc97 in c10d::Comm::get_comm (id=@0xa9b14f8: 0, dev=..., oob=std::shared_ptr<c10d::torch_ucc_oob_coll_info_t> (use count 4, weak count 0) = {...}, logger=..., is_health_check=false) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:407
#27 0x00007d2c9993e3b2 in c10d::ProcessGroupUCC::initComm (this=0xa9b13a0, dev=...) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:1873
#28 0x00007d2c9993d8d9 in c10d::ProcessGroupUCC::send (this=0xa9b13a0, tensors=std::vector of length 1, capacity 1 = {...}, dstRank=1, tag=0) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:1710
#29 0x00007d2dca343100 in pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}::operator()(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int) const (__closure=0x96f13f8, c=0xa9b13a0, args#0=std::vector of length 1, capacity 1 = {...}, args#1=1, args#2=0) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:136
#30 0x00007d2dca41dc91 in pybind11::detail::argument_loader<c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int>::call_impl<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&, 0ul, 1ul, 2ul, 3ul, pybind11::gil_scoped_release>(pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&, std::integer_sequence<unsigned long, 0ul, 1ul, 2ul, 3ul>, pybind11::gil_scoped_release&&) && (this=0x7fffa58d6340, f=...) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/cast.h:1631
#31 0x00007d2dca3e930e in pybind11::detail::argument_loader<c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int>::call<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, pybind11::gil_scoped_release, pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&>(pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&) && (this=0x7fffa58d6340, f=...) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/cast.h:1600
#32 0x00007d2dca39a925 in pybind11::cpp_function::initialize<pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&&, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (*)(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(pybind11::detail::function_call&)#1}::operator()(pybind11::detail::function_call&) const (__closure=0x0, call=...) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:278
#33 0x00007d2dca39ab46 in pybind11::cpp_function::initialize<pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&&, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (*)(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(pybind11::detail::function_call&)#1}::_FUN(pybind11::detail::function_call&) () at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:249
#34 0x00007d2dc8fe0da1 in pybind11::cpp_function::dispatcher (self=0x7d2c9bc16820, args_in=0x7d2dcbd4c400, kwargs_in=0x0) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:971
#35 0x0000000000528db7 in cfunction_call (func=0x7d2c9bc1b1a0, args=<optimized out>, kwargs=<optimized out>) at /usr/local/src/conda/python-3.11.13/Objects/methodobject.c:542
#36 0x000000000050454c in _PyObject_MakeTpCall (tstate=0x8a9518 <_PyRuntime+166328>, callable=0x7d2c9bc1b1a0, args=<optimized out>, nargs=<optimized out>, keywords=0x0) at /usr/local/src/conda/python-3.11.13/Objects/call.c:214
#37 0x0000000000511cf6 in _PyEval_EvalFrameDefault (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, frame=<optimized out>, frame@entry=0x7d2dcc5831e0, throwflag=throwflag@entry=0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:4769
#38 0x0000000000539503 in _PyEval_EvalFrame (throwflag=0, frame=0x7d2dcc5831e0, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Include/internal/pycore_ceval.h:73
#39 _PyEval_Vector (kwnames=<optimized out>, argcount=1, args=0x7d2d647caa78, locals=0x0, func=<optimized out>, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:6434
#40 _PyFunction_Vectorcall (func=<optimized out>, stack=0x7d2d647caa78, nargsf=<optimized out>, kwnames=<optimized out>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:393
#41 0x000000000054358c in _PyVectorcall_Call (kwargs=<optimized out>, tuple=<optimized out>, callable=0x7d2c9bcd13a0, func=0x539390 <_PyFunction_Vectorcall>, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:257
#42 _PyObject_Call (kwargs=<optimized out>, args=<optimized out>, callable=0x7d2c9bcd13a0, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:328
#43 PyObject_Call (callable=0x7d2c9bcd13a0, args=<optimized out>, kwargs=<optimized out>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:355
#44 0x0000000000515f58 in do_call_core (use_tracing=<optimized out>, kwdict=0x7d2c99b21b80, callargs=0x7d2dcc1be590, func=0x7d2c9bcd13a0, tstate=<optimized out>) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:7349
#45 _PyEval_EvalFrameDefault (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, frame=<optimized out>, frame@entry=0x7d2dcc583020, throwflag=throwflag@entry=0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:5376
#46 0x00000000005cd0aa in _PyEval_EvalFrame (throwflag=0, frame=0x7d2dcc583020, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Include/internal/pycore_ceval.h:73
#47 _PyEval_Vector (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, func=func@entry=0x7d2dcc1d60c0, locals=locals@entry=0x7d2dcc1f69c0, args=args@entry=0x0, argcount=argcount@entry=0, kwnames=kwnames@entry=0x0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:6434
#48 0x00000000005cc77f in PyEval_EvalCode (co=co@entry=0x7d2dcc1c8030, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:1148
#49 0x00000000005ed557 in run_eval_code_obj (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, co=co@entry=0x7d2dcc1c8030, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:1741
---
[HIT] ucm_orig_sbrk
#0  ucm_orig_sbrk (increment=139264) at util/replace.c:147
#1  0x00007d2d9562a58f in ucm_event_call_orig (event_type=UCM_EVENT_SBRK, event=0x7fffa58d4c50, arg=0x0) at event/event.c:106
#2  0x00007d2d9562a682 in ucm_event_dispatch (event_type=UCM_EVENT_SBRK, event=0x7fffa58d4c50) at event/event.c:145
#3  0x00007d2d9562b76c in ucm_sbrk (increment=139264) at event/event.c:400
#4  0x00007d2d95632064 in ucm_override_sbrk (arg0=139264) at util/replace.c:58
#5  0x00007d2dcc2aaa26 in __glibc_morecore (increment=increment@entry=139264) at ./malloc/morecore.c:29
#6  0x00007d2dcc2acbf7 in sysmalloc (av=0x7d2dcc403ac0 <main_arena>, nb=16400) at ./malloc/malloc.c:2709
#7  _int_malloc (av=av@entry=0x7d2dcc403ac0 <main_arena>, bytes=bytes@entry=16384) at ./malloc/malloc.c:4481
#8  0x00007d2dcc2ad6f4 in __GI___libc_malloc (bytes=16384) at ./malloc/malloc.c:3336
#9  0x00007d2d94fad389 in nl_recv () from /lib/x86_64-linux-gnu/libnl-3.so.200
#10 0x00007d2d94fadcf5 in nl_recvmsgs_report () from /lib/x86_64-linux-gnu/libnl-3.so.200
#11 0x00007d2d94fae31d in nl_recvmsgs () from /lib/x86_64-linux-gnu/libnl-3.so.200
#12 0x00007d2d6b2f1f98 in ?? () from /lib/x86_64-linux-gnu/libibverbs.so.1
#13 0x00007d2d6b2f515a in ibv_get_device_list () from /lib/x86_64-linux-gnu/libibverbs.so.1
#14 0x00007d2d3e1adb21 in uct_ib_query_md_resources (component=0x7d2c56a9eee0 <uct_gga_component>, resources_p=0x7fffa58d51f0, num_resources_p=0x7fffa58d51ec) at base/ib_md.c:821
#15 0x00007d2d646b1275 in uct_component_query (component=0x7d2c56a9eee0 <uct_gga_component>, component_attr=0x122a9f10) at base/uct_component.c:91
#16 0x00007d2c9943d22f in ucp_fill_resources (context=0x122a21e0, config=0xab9b810) at core/ucp_context.c:1799
#17 0x00007d2c9943ef80 in ucp_init_version (api_major_version=1, api_minor_version=18, params=0x7fffa58d5530, config=0xab9b810, context_p=0x1229eff8) at core/ucp_context.c:2299
#18 0x00007d2c99999dbe in ucp_init (params=0x7fffa58d5530, config=0xab9b810, context_p=0x1229eff8) at /data/ZYH/ucx-1.18.1/install/include/ucp/api/ucp.h:2095
#19 0x00007d2c9999a7c9 in c10d::CommUCX::CommUCX (this=0x1229efe8, comm_size=2, logger=...) at /data/ZYH/torch_ucc/src/torch_ucc_comm.cpp:55
#20 0x00007d2c9992efba in c10d::Comm::Comm (this=0x1229efd0, logger_=..., oob_=std::shared_ptr<c10d::torch_ucc_oob_coll_info_t> (use count 4, weak count 0) = {...}, dev=..., is_health_check=false) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:336
#21 0x00007d2c9998dfd0 in std::_Construct<c10d::Comm, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (__p=0x1229efd0) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/stl_construct.h:119
#22 0x00007d2c9998a36c in std::allocator_traits<std::allocator<void> >::construct<c10d::Comm, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (__p=0x1229efd0) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/alloc_traits.h:635
#23 0x00007d2c9998494a in std::_Sp_counted_ptr_inplace<c10d::Comm, std::allocator<void>, (__gnu_cxx::_Lock_policy)2>::_Sp_counted_ptr_inplace<c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (this=0x1229efc0, __a=...) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr_base.h:604
#24 0x00007d2c9997b2d0 in std::__shared_count<(__gnu_cxx::_Lock_policy)2>::__shared_count<c10d::Comm, std::allocator<void>, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (this=0x7fffa58d5c88, __p=@0x7fffa58d5c80: 0x0, __a=...) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr_base.h:971
#25 0x00007d2c9996e535 in std::__shared_ptr<c10d::Comm, (__gnu_cxx::_Lock_policy)2>::__shared_ptr<std::allocator<void>, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (this=0x7fffa58d5c80, __tag=...) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr_base.h:1715
#26 0x00007d2c9995fb42 in std::shared_ptr<c10d::Comm>::shared_ptr<std::allocator<void>, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (this=0x7fffa58d5c80, __tag=...) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr.h:464
#27 0x00007d2c99949448 in std::make_shared<c10d::Comm, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> () at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr.h:1010
#28 0x00007d2c9992fc97 in c10d::Comm::get_comm (id=@0xa9b14f8: 0, dev=..., oob=std::shared_ptr<c10d::torch_ucc_oob_coll_info_t> (use count 4, weak count 0) = {...}, logger=..., is_health_check=false) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:407
#29 0x00007d2c9993e3b2 in c10d::ProcessGroupUCC::initComm (this=0xa9b13a0, dev=...) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:1873
#30 0x00007d2c9993d8d9 in c10d::ProcessGroupUCC::send (this=0xa9b13a0, tensors=std::vector of length 1, capacity 1 = {...}, dstRank=1, tag=0) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:1710
#31 0x00007d2dca343100 in pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}::operator()(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int) const (__closure=0x96f13f8, c=0xa9b13a0, args#0=std::vector of length 1, capacity 1 = {...}, args#1=1, args#2=0) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:136
#32 0x00007d2dca41dc91 in pybind11::detail::argument_loader<c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int>::call_impl<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&, 0ul, 1ul, 2ul, 3ul, pybind11::gil_scoped_release>(pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&, std::integer_sequence<unsigned long, 0ul, 1ul, 2ul, 3ul>, pybind11::gil_scoped_release&&) && (this=0x7fffa58d6340, f=...) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/cast.h:1631
#33 0x00007d2dca3e930e in pybind11::detail::argument_loader<c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int>::call<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, pybind11::gil_scoped_release, pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&>(pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&) && (this=0x7fffa58d6340, f=...) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/cast.h:1600
#34 0x00007d2dca39a925 in pybind11::cpp_function::initialize<pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&&, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (*)(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(pybind11::detail::function_call&)#1}::operator()(pybind11::detail::function_call&) const (__closure=0x0, call=...) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:278
#35 0x00007d2dca39ab46 in pybind11::cpp_function::initialize<pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&&, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (*)(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(pybind11::detail::function_call&)#1}::_FUN(pybind11::detail::function_call&) () at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:249
#36 0x00007d2dc8fe0da1 in pybind11::cpp_function::dispatcher (self=0x7d2c9bc16820, args_in=0x7d2dcbd4c400, kwargs_in=0x0) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:971
#37 0x0000000000528db7 in cfunction_call (func=0x7d2c9bc1b1a0, args=<optimized out>, kwargs=<optimized out>) at /usr/local/src/conda/python-3.11.13/Objects/methodobject.c:542
#38 0x000000000050454c in _PyObject_MakeTpCall (tstate=0x8a9518 <_PyRuntime+166328>, callable=0x7d2c9bc1b1a0, args=<optimized out>, nargs=<optimized out>, keywords=0x0) at /usr/local/src/conda/python-3.11.13/Objects/call.c:214
#39 0x0000000000511cf6 in _PyEval_EvalFrameDefault (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, frame=<optimized out>, frame@entry=0x7d2dcc5831e0, throwflag=throwflag@entry=0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:4769
#40 0x0000000000539503 in _PyEval_EvalFrame (throwflag=0, frame=0x7d2dcc5831e0, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Include/internal/pycore_ceval.h:73
#41 _PyEval_Vector (kwnames=<optimized out>, argcount=1, args=0x7d2d647caa78, locals=0x0, func=<optimized out>, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:6434
#42 _PyFunction_Vectorcall (func=<optimized out>, stack=0x7d2d647caa78, nargsf=<optimized out>, kwnames=<optimized out>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:393
#43 0x000000000054358c in _PyVectorcall_Call (kwargs=<optimized out>, tuple=<optimized out>, callable=0x7d2c9bcd13a0, func=0x539390 <_PyFunction_Vectorcall>, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:257
#44 _PyObject_Call (kwargs=<optimized out>, args=<optimized out>, callable=0x7d2c9bcd13a0, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:328
#45 PyObject_Call (callable=0x7d2c9bcd13a0, args=<optimized out>, kwargs=<optimized out>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:355
#46 0x0000000000515f58 in do_call_core (use_tracing=<optimized out>, kwdict=0x7d2c99b21b80, callargs=0x7d2dcc1be590, func=0x7d2c9bcd13a0, tstate=<optimized out>) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:7349
#47 _PyEval_EvalFrameDefault (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, frame=<optimized out>, frame@entry=0x7d2dcc583020, throwflag=throwflag@entry=0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:5376
#48 0x00000000005cd0aa in _PyEval_EvalFrame (throwflag=0, frame=0x7d2dcc583020, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Include/internal/pycore_ceval.h:73
#49 _PyEval_Vector (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, func=func@entry=0x7d2dcc1d60c0, locals=locals@entry=0x7d2dcc1f69c0, args=args@entry=0x0, argcount=argcount@entry=0, kwnames=kwnames@entry=0x0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:6434
---
[HIT] ucm_orig_brk
#0  ucm_orig_brk (addr=0x122d3000) at util/replace.c:133
#1  0x00007d2d956330d9 in ucm_orig_sbrk (increment=139264) at util/replace.c:154
#2  0x00007d2d9562a58f in ucm_event_call_orig (event_type=UCM_EVENT_SBRK, event=0x7fffa58d4c50, arg=0x0) at event/event.c:106
#3  0x00007d2d9562a682 in ucm_event_dispatch (event_type=UCM_EVENT_SBRK, event=0x7fffa58d4c50) at event/event.c:145
#4  0x00007d2d9562b76c in ucm_sbrk (increment=139264) at event/event.c:400
#5  0x00007d2d95632064 in ucm_override_sbrk (arg0=139264) at util/replace.c:58
#6  0x00007d2dcc2aaa26 in __glibc_morecore (increment=increment@entry=139264) at ./malloc/morecore.c:29
#7  0x00007d2dcc2acbf7 in sysmalloc (av=0x7d2dcc403ac0 <main_arena>, nb=16400) at ./malloc/malloc.c:2709
#8  _int_malloc (av=av@entry=0x7d2dcc403ac0 <main_arena>, bytes=bytes@entry=16384) at ./malloc/malloc.c:4481
#9  0x00007d2dcc2ad6f4 in __GI___libc_malloc (bytes=16384) at ./malloc/malloc.c:3336
#10 0x00007d2d94fad389 in nl_recv () from /lib/x86_64-linux-gnu/libnl-3.so.200
#11 0x00007d2d94fadcf5 in nl_recvmsgs_report () from /lib/x86_64-linux-gnu/libnl-3.so.200
#12 0x00007d2d94fae31d in nl_recvmsgs () from /lib/x86_64-linux-gnu/libnl-3.so.200
#13 0x00007d2d6b2f1f98 in ?? () from /lib/x86_64-linux-gnu/libibverbs.so.1
#14 0x00007d2d6b2f515a in ibv_get_device_list () from /lib/x86_64-linux-gnu/libibverbs.so.1
#15 0x00007d2d3e1adb21 in uct_ib_query_md_resources (component=0x7d2c56a9eee0 <uct_gga_component>, resources_p=0x7fffa58d51f0, num_resources_p=0x7fffa58d51ec) at base/ib_md.c:821
#16 0x00007d2d646b1275 in uct_component_query (component=0x7d2c56a9eee0 <uct_gga_component>, component_attr=0x122a9f10) at base/uct_component.c:91
#17 0x00007d2c9943d22f in ucp_fill_resources (context=0x122a21e0, config=0xab9b810) at core/ucp_context.c:1799
#18 0x00007d2c9943ef80 in ucp_init_version (api_major_version=1, api_minor_version=18, params=0x7fffa58d5530, config=0xab9b810, context_p=0x1229eff8) at core/ucp_context.c:2299
#19 0x00007d2c99999dbe in ucp_init (params=0x7fffa58d5530, config=0xab9b810, context_p=0x1229eff8) at /data/ZYH/ucx-1.18.1/install/include/ucp/api/ucp.h:2095
#20 0x00007d2c9999a7c9 in c10d::CommUCX::CommUCX (this=0x1229efe8, comm_size=2, logger=...) at /data/ZYH/torch_ucc/src/torch_ucc_comm.cpp:55
#21 0x00007d2c9992efba in c10d::Comm::Comm (this=0x1229efd0, logger_=..., oob_=std::shared_ptr<c10d::torch_ucc_oob_coll_info_t> (use count 4, weak count 0) = {...}, dev=..., is_health_check=false) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:336
#22 0x00007d2c9998dfd0 in std::_Construct<c10d::Comm, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (__p=0x1229efd0) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/stl_construct.h:119
#23 0x00007d2c9998a36c in std::allocator_traits<std::allocator<void> >::construct<c10d::Comm, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (__p=0x1229efd0) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/alloc_traits.h:635
#24 0x00007d2c9998494a in std::_Sp_counted_ptr_inplace<c10d::Comm, std::allocator<void>, (__gnu_cxx::_Lock_policy)2>::_Sp_counted_ptr_inplace<c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (this=0x1229efc0, __a=...) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr_base.h:604
#25 0x00007d2c9997b2d0 in std::__shared_count<(__gnu_cxx::_Lock_policy)2>::__shared_count<c10d::Comm, std::allocator<void>, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (this=0x7fffa58d5c88, __p=@0x7fffa58d5c80: 0x0, __a=...) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr_base.h:971
#26 0x00007d2c9996e535 in std::__shared_ptr<c10d::Comm, (__gnu_cxx::_Lock_policy)2>::__shared_ptr<std::allocator<void>, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (this=0x7fffa58d5c80, __tag=...) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr_base.h:1715
#27 0x00007d2c9995fb42 in std::shared_ptr<c10d::Comm>::shared_ptr<std::allocator<void>, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (this=0x7fffa58d5c80, __tag=...) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr.h:464
#28 0x00007d2c99949448 in std::make_shared<c10d::Comm, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> () at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr.h:1010
#29 0x00007d2c9992fc97 in c10d::Comm::get_comm (id=@0xa9b14f8: 0, dev=..., oob=std::shared_ptr<c10d::torch_ucc_oob_coll_info_t> (use count 4, weak count 0) = {...}, logger=..., is_health_check=false) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:407
#30 0x00007d2c9993e3b2 in c10d::ProcessGroupUCC::initComm (this=0xa9b13a0, dev=...) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:1873
#31 0x00007d2c9993d8d9 in c10d::ProcessGroupUCC::send (this=0xa9b13a0, tensors=std::vector of length 1, capacity 1 = {...}, dstRank=1, tag=0) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:1710
#32 0x00007d2dca343100 in pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}::operator()(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int) const (__closure=0x96f13f8, c=0xa9b13a0, args#0=std::vector of length 1, capacity 1 = {...}, args#1=1, args#2=0) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:136
#33 0x00007d2dca41dc91 in pybind11::detail::argument_loader<c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int>::call_impl<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&, 0ul, 1ul, 2ul, 3ul, pybind11::gil_scoped_release>(pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&, std::integer_sequence<unsigned long, 0ul, 1ul, 2ul, 3ul>, pybind11::gil_scoped_release&&) && (this=0x7fffa58d6340, f=...) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/cast.h:1631
#34 0x00007d2dca3e930e in pybind11::detail::argument_loader<c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int>::call<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, pybind11::gil_scoped_release, pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&>(pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&) && (this=0x7fffa58d6340, f=...) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/cast.h:1600
#35 0x00007d2dca39a925 in pybind11::cpp_function::initialize<pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&&, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (*)(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(pybind11::detail::function_call&)#1}::operator()(pybind11::detail::function_call&) const (__closure=0x0, call=...) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:278
#36 0x00007d2dca39ab46 in pybind11::cpp_function::initialize<pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&&, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (*)(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(pybind11::detail::function_call&)#1}::_FUN(pybind11::detail::function_call&) () at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:249
#37 0x00007d2dc8fe0da1 in pybind11::cpp_function::dispatcher (self=0x7d2c9bc16820, args_in=0x7d2dcbd4c400, kwargs_in=0x0) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:971
#38 0x0000000000528db7 in cfunction_call (func=0x7d2c9bc1b1a0, args=<optimized out>, kwargs=<optimized out>) at /usr/local/src/conda/python-3.11.13/Objects/methodobject.c:542
#39 0x000000000050454c in _PyObject_MakeTpCall (tstate=0x8a9518 <_PyRuntime+166328>, callable=0x7d2c9bc1b1a0, args=<optimized out>, nargs=<optimized out>, keywords=0x0) at /usr/local/src/conda/python-3.11.13/Objects/call.c:214
#40 0x0000000000511cf6 in _PyEval_EvalFrameDefault (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, frame=<optimized out>, frame@entry=0x7d2dcc5831e0, throwflag=throwflag@entry=0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:4769
#41 0x0000000000539503 in _PyEval_EvalFrame (throwflag=0, frame=0x7d2dcc5831e0, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Include/internal/pycore_ceval.h:73
#42 _PyEval_Vector (kwnames=<optimized out>, argcount=1, args=0x7d2d647caa78, locals=0x0, func=<optimized out>, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:6434
#43 _PyFunction_Vectorcall (func=<optimized out>, stack=0x7d2d647caa78, nargsf=<optimized out>, kwnames=<optimized out>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:393
#44 0x000000000054358c in _PyVectorcall_Call (kwargs=<optimized out>, tuple=<optimized out>, callable=0x7d2c9bcd13a0, func=0x539390 <_PyFunction_Vectorcall>, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:257
#45 _PyObject_Call (kwargs=<optimized out>, args=<optimized out>, callable=0x7d2c9bcd13a0, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:328
#46 PyObject_Call (callable=0x7d2c9bcd13a0, args=<optimized out>, kwargs=<optimized out>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:355
#47 0x0000000000515f58 in do_call_core (use_tracing=<optimized out>, kwdict=0x7d2c99b21b80, callargs=0x7d2dcc1be590, func=0x7d2c9bcd13a0, tstate=<optimized out>) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:7349
#48 _PyEval_EvalFrameDefault (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, frame=<optimized out>, frame@entry=0x7d2dcc583020, throwflag=throwflag@entry=0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:5376
#49 0x00000000005cd0aa in _PyEval_EvalFrame (throwflag=0, frame=0x7d2dcc583020, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Include/internal/pycore_ceval.h:73
---
[HIT] ucm_event_callback_dump
#0  ucm_event_leave () at event/event.c:173
#1  0x00007d2d9562b835 in ucm_sbrk (increment=139264) at event/event.c:408
#2  0x00007d2d95632064 in ucm_override_sbrk (arg0=139264) at util/replace.c:58
#3  0x00007d2dcc2aaa26 in __glibc_morecore (increment=increment@entry=139264) at ./malloc/morecore.c:29
#4  0x00007d2dcc2acbf7 in sysmalloc (av=0x7d2dcc403ac0 <main_arena>, nb=16400) at ./malloc/malloc.c:2709
#5  _int_malloc (av=av@entry=0x7d2dcc403ac0 <main_arena>, bytes=bytes@entry=16384) at ./malloc/malloc.c:4481
#6  0x00007d2dcc2ad6f4 in __GI___libc_malloc (bytes=16384) at ./malloc/malloc.c:3336
#7  0x00007d2d94fad389 in nl_recv () from /lib/x86_64-linux-gnu/libnl-3.so.200
#8  0x00007d2d94fadcf5 in nl_recvmsgs_report () from /lib/x86_64-linux-gnu/libnl-3.so.200
#9  0x00007d2d94fae31d in nl_recvmsgs () from /lib/x86_64-linux-gnu/libnl-3.so.200
#10 0x00007d2d6b2f1f98 in ?? () from /lib/x86_64-linux-gnu/libibverbs.so.1
#11 0x00007d2d6b2f515a in ibv_get_device_list () from /lib/x86_64-linux-gnu/libibverbs.so.1
#12 0x00007d2d3e1adb21 in uct_ib_query_md_resources (component=0x7d2c56a9eee0 <uct_gga_component>, resources_p=0x7fffa58d51f0, num_resources_p=0x7fffa58d51ec) at base/ib_md.c:821
#13 0x00007d2d646b1275 in uct_component_query (component=0x7d2c56a9eee0 <uct_gga_component>, component_attr=0x122a9f10) at base/uct_component.c:91
#14 0x00007d2c9943d22f in ucp_fill_resources (context=0x122a21e0, config=0xab9b810) at core/ucp_context.c:1799
#15 0x00007d2c9943ef80 in ucp_init_version (api_major_version=1, api_minor_version=18, params=0x7fffa58d5530, config=0xab9b810, context_p=0x1229eff8) at core/ucp_context.c:2299
#16 0x00007d2c99999dbe in ucp_init (params=0x7fffa58d5530, config=0xab9b810, context_p=0x1229eff8) at /data/ZYH/ucx-1.18.1/install/include/ucp/api/ucp.h:2095
#17 0x00007d2c9999a7c9 in c10d::CommUCX::CommUCX (this=0x1229efe8, comm_size=2, logger=...) at /data/ZYH/torch_ucc/src/torch_ucc_comm.cpp:55
#18 0x00007d2c9992efba in c10d::Comm::Comm (this=0x1229efd0, logger_=..., oob_=std::shared_ptr<c10d::torch_ucc_oob_coll_info_t> (use count 4, weak count 0) = {...}, dev=..., is_health_check=false) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:336
#19 0x00007d2c9998dfd0 in std::_Construct<c10d::Comm, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (__p=0x1229efd0) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/stl_construct.h:119
#20 0x00007d2c9998a36c in std::allocator_traits<std::allocator<void> >::construct<c10d::Comm, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (__p=0x1229efd0) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/alloc_traits.h:635
#21 0x00007d2c9998494a in std::_Sp_counted_ptr_inplace<c10d::Comm, std::allocator<void>, (__gnu_cxx::_Lock_policy)2>::_Sp_counted_ptr_inplace<c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (this=0x1229efc0, __a=...) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr_base.h:604
#22 0x00007d2c9997b2d0 in std::__shared_count<(__gnu_cxx::_Lock_policy)2>::__shared_count<c10d::Comm, std::allocator<void>, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (this=0x7fffa58d5c88, __p=@0x7fffa58d5c80: 0x0, __a=...) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr_base.h:971
#23 0x00007d2c9996e535 in std::__shared_ptr<c10d::Comm, (__gnu_cxx::_Lock_policy)2>::__shared_ptr<std::allocator<void>, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (this=0x7fffa58d5c80, __tag=...) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr_base.h:1715
#24 0x00007d2c9995fb42 in std::shared_ptr<c10d::Comm>::shared_ptr<std::allocator<void>, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (this=0x7fffa58d5c80, __tag=...) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr.h:464
#25 0x00007d2c99949448 in std::make_shared<c10d::Comm, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> () at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr.h:1010
#26 0x00007d2c9992fc97 in c10d::Comm::get_comm (id=@0xa9b14f8: 0, dev=..., oob=std::shared_ptr<c10d::torch_ucc_oob_coll_info_t> (use count 4, weak count 0) = {...}, logger=..., is_health_check=false) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:407
#27 0x00007d2c9993e3b2 in c10d::ProcessGroupUCC::initComm (this=0xa9b13a0, dev=...) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:1873
#28 0x00007d2c9993d8d9 in c10d::ProcessGroupUCC::send (this=0xa9b13a0, tensors=std::vector of length 1, capacity 1 = {...}, dstRank=1, tag=0) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:1710
#29 0x00007d2dca343100 in pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}::operator()(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int) const (__closure=0x96f13f8, c=0xa9b13a0, args#0=std::vector of length 1, capacity 1 = {...}, args#1=1, args#2=0) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:136
#30 0x00007d2dca41dc91 in pybind11::detail::argument_loader<c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int>::call_impl<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&, 0ul, 1ul, 2ul, 3ul, pybind11::gil_scoped_release>(pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&, std::integer_sequence<unsigned long, 0ul, 1ul, 2ul, 3ul>, pybind11::gil_scoped_release&&) && (this=0x7fffa58d6340, f=...) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/cast.h:1631
#31 0x00007d2dca3e930e in pybind11::detail::argument_loader<c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int>::call<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, pybind11::gil_scoped_release, pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&>(pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&) && (this=0x7fffa58d6340, f=...) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/cast.h:1600
#32 0x00007d2dca39a925 in pybind11::cpp_function::initialize<pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&&, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (*)(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(pybind11::detail::function_call&)#1}::operator()(pybind11::detail::function_call&) const (__closure=0x0, call=...) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:278
#33 0x00007d2dca39ab46 in pybind11::cpp_function::initialize<pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&&, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (*)(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(pybind11::detail::function_call&)#1}::_FUN(pybind11::detail::function_call&) () at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:249
#34 0x00007d2dc8fe0da1 in pybind11::cpp_function::dispatcher (self=0x7d2c9bc16820, args_in=0x7d2dcbd4c400, kwargs_in=0x0) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:971
#35 0x0000000000528db7 in cfunction_call (func=0x7d2c9bc1b1a0, args=<optimized out>, kwargs=<optimized out>) at /usr/local/src/conda/python-3.11.13/Objects/methodobject.c:542
#36 0x000000000050454c in _PyObject_MakeTpCall (tstate=0x8a9518 <_PyRuntime+166328>, callable=0x7d2c9bc1b1a0, args=<optimized out>, nargs=<optimized out>, keywords=0x0) at /usr/local/src/conda/python-3.11.13/Objects/call.c:214
#37 0x0000000000511cf6 in _PyEval_EvalFrameDefault (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, frame=<optimized out>, frame@entry=0x7d2dcc5831e0, throwflag=throwflag@entry=0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:4769
#38 0x0000000000539503 in _PyEval_EvalFrame (throwflag=0, frame=0x7d2dcc5831e0, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Include/internal/pycore_ceval.h:73
#39 _PyEval_Vector (kwnames=<optimized out>, argcount=1, args=0x7d2d647caa78, locals=0x0, func=<optimized out>, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:6434
#40 _PyFunction_Vectorcall (func=<optimized out>, stack=0x7d2d647caa78, nargsf=<optimized out>, kwnames=<optimized out>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:393
#41 0x000000000054358c in _PyVectorcall_Call (kwargs=<optimized out>, tuple=<optimized out>, callable=0x7d2c9bcd13a0, func=0x539390 <_PyFunction_Vectorcall>, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:257
#42 _PyObject_Call (kwargs=<optimized out>, args=<optimized out>, callable=0x7d2c9bcd13a0, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:328
#43 PyObject_Call (callable=0x7d2c9bcd13a0, args=<optimized out>, kwargs=<optimized out>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:355
#44 0x0000000000515f58 in do_call_core (use_tracing=<optimized out>, kwdict=0x7d2c99b21b80, callargs=0x7d2dcc1be590, func=0x7d2c9bcd13a0, tstate=<optimized out>) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:7349
#45 _PyEval_EvalFrameDefault (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, frame=<optimized out>, frame@entry=0x7d2dcc583020, throwflag=throwflag@entry=0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:5376
#46 0x00000000005cd0aa in _PyEval_EvalFrame (throwflag=0, frame=0x7d2dcc583020, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Include/internal/pycore_ceval.h:73
#47 _PyEval_Vector (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, func=func@entry=0x7d2dcc1d60c0, locals=locals@entry=0x7d2dcc1f69c0, args=args@entry=0x0, argcount=argcount@entry=0, kwnames=kwnames@entry=0x0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:6434
#48 0x00000000005cc77f in PyEval_EvalCode (co=co@entry=0x7d2dcc1c8030, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:1148
#49 0x00000000005ed557 in run_eval_code_obj (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, co=co@entry=0x7d2dcc1c8030, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:1741
---
[HIT] uct_md_open
#0  uct_md_open (component=0x7d2d646fda80 <uct_self_component>, md_name=0x7fffa58d5100 "self", config=0x122aa240, md_p=0x122aabd0) at base/uct_md.c:57
#1  0x00007d2c9943b7f4 in ucp_fill_tl_md (context=0x122a21e0, cmpt_index=0 '\000', md_rsc=0x7fffa58d5100, tl_md=0x122aabd0) at core/ucp_context.c:1379
#2  0x00007d2c9943c338 in ucp_add_component_resources (context=0x122a21e0, cmpt_index=0 '\000', avail_devices=0x7fffa58d53a0, avail_tls=0x7fffa58d5320, dev_cfg_masks=0x7fffa58d5380, tl_cfg_mask=0x7fffa58d5248, config=0xab9b810, aux_tls=0x7fffa58d5350) at core/ucp_context.c:1574
#3  0x00007d2c9943d467 in ucp_fill_resources (context=0x122a21e0, config=0xab9b810) at core/ucp_context.c:1822
#4  0x00007d2c9943ef80 in ucp_init_version (api_major_version=1, api_minor_version=18, params=0x7fffa58d5530, config=0xab9b810, context_p=0x1229eff8) at core/ucp_context.c:2299
#5  0x00007d2c99999dbe in ucp_init (params=0x7fffa58d5530, config=0xab9b810, context_p=0x1229eff8) at /data/ZYH/ucx-1.18.1/install/include/ucp/api/ucp.h:2095
#6  0x00007d2c9999a7c9 in c10d::CommUCX::CommUCX (this=0x1229efe8, comm_size=2, logger=...) at /data/ZYH/torch_ucc/src/torch_ucc_comm.cpp:55
#7  0x00007d2c9992efba in c10d::Comm::Comm (this=0x1229efd0, logger_=..., oob_=std::shared_ptr<c10d::torch_ucc_oob_coll_info_t> (use count 4, weak count 0) = {...}, dev=..., is_health_check=false) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:336
#8  0x00007d2c9998dfd0 in std::_Construct<c10d::Comm, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (__p=0x1229efd0) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/stl_construct.h:119
#9  0x00007d2c9998a36c in std::allocator_traits<std::allocator<void> >::construct<c10d::Comm, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (__p=0x1229efd0) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/alloc_traits.h:635
#10 0x00007d2c9998494a in std::_Sp_counted_ptr_inplace<c10d::Comm, std::allocator<void>, (__gnu_cxx::_Lock_policy)2>::_Sp_counted_ptr_inplace<c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (this=0x1229efc0, __a=...) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr_base.h:604
#11 0x00007d2c9997b2d0 in std::__shared_count<(__gnu_cxx::_Lock_policy)2>::__shared_count<c10d::Comm, std::allocator<void>, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (this=0x7fffa58d5c88, __p=@0x7fffa58d5c80: 0x0, __a=...) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr_base.h:971
#12 0x00007d2c9996e535 in std::__shared_ptr<c10d::Comm, (__gnu_cxx::_Lock_policy)2>::__shared_ptr<std::allocator<void>, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (this=0x7fffa58d5c80, __tag=...) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr_base.h:1715
#13 0x00007d2c9995fb42 in std::shared_ptr<c10d::Comm>::shared_ptr<std::allocator<void>, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (this=0x7fffa58d5c80, __tag=...) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr.h:464
#14 0x00007d2c99949448 in std::make_shared<c10d::Comm, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> () at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr.h:1010
#15 0x00007d2c9992fc97 in c10d::Comm::get_comm (id=@0xa9b14f8: 0, dev=..., oob=std::shared_ptr<c10d::torch_ucc_oob_coll_info_t> (use count 4, weak count 0) = {...}, logger=..., is_health_check=false) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:407
#16 0x00007d2c9993e3b2 in c10d::ProcessGroupUCC::initComm (this=0xa9b13a0, dev=...) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:1873
#17 0x00007d2c9993d8d9 in c10d::ProcessGroupUCC::send (this=0xa9b13a0, tensors=std::vector of length 1, capacity 1 = {...}, dstRank=1, tag=0) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:1710
#18 0x00007d2dca343100 in pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}::operator()(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int) const (__closure=0x96f13f8, c=0xa9b13a0, args#0=std::vector of length 1, capacity 1 = {...}, args#1=1, args#2=0) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:136
#19 0x00007d2dca41dc91 in pybind11::detail::argument_loader<c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int>::call_impl<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&, 0ul, 1ul, 2ul, 3ul, pybind11::gil_scoped_release>(pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&, std::integer_sequence<unsigned long, 0ul, 1ul, 2ul, 3ul>, pybind11::gil_scoped_release&&) && (this=0x7fffa58d6340, f=...) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/cast.h:1631
#20 0x00007d2dca3e930e in pybind11::detail::argument_loader<c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int>::call<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, pybind11::gil_scoped_release, pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&>(pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&) && (this=0x7fffa58d6340, f=...) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/cast.h:1600
#21 0x00007d2dca39a925 in pybind11::cpp_function::initialize<pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&&, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (*)(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(pybind11::detail::function_call&)#1}::operator()(pybind11::detail::function_call&) const (__closure=0x0, call=...) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:278
#22 0x00007d2dca39ab46 in pybind11::cpp_function::initialize<pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&&, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (*)(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(pybind11::detail::function_call&)#1}::_FUN(pybind11::detail::function_call&) () at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:249
#23 0x00007d2dc8fe0da1 in pybind11::cpp_function::dispatcher (self=0x7d2c9bc16820, args_in=0x7d2dcbd4c400, kwargs_in=0x0) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:971
#24 0x0000000000528db7 in cfunction_call (func=0x7d2c9bc1b1a0, args=<optimized out>, kwargs=<optimized out>) at /usr/local/src/conda/python-3.11.13/Objects/methodobject.c:542
#25 0x000000000050454c in _PyObject_MakeTpCall (tstate=0x8a9518 <_PyRuntime+166328>, callable=0x7d2c9bc1b1a0, args=<optimized out>, nargs=<optimized out>, keywords=0x0) at /usr/local/src/conda/python-3.11.13/Objects/call.c:214
#26 0x0000000000511cf6 in _PyEval_EvalFrameDefault (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, frame=<optimized out>, frame@entry=0x7d2dcc5831e0, throwflag=throwflag@entry=0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:4769
#27 0x0000000000539503 in _PyEval_EvalFrame (throwflag=0, frame=0x7d2dcc5831e0, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Include/internal/pycore_ceval.h:73
#28 _PyEval_Vector (kwnames=<optimized out>, argcount=1, args=0x7d2d647caa78, locals=0x0, func=<optimized out>, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:6434
#29 _PyFunction_Vectorcall (func=<optimized out>, stack=0x7d2d647caa78, nargsf=<optimized out>, kwnames=<optimized out>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:393
#30 0x000000000054358c in _PyVectorcall_Call (kwargs=<optimized out>, tuple=<optimized out>, callable=0x7d2c9bcd13a0, func=0x539390 <_PyFunction_Vectorcall>, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:257
#31 _PyObject_Call (kwargs=<optimized out>, args=<optimized out>, callable=0x7d2c9bcd13a0, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:328
#32 PyObject_Call (callable=0x7d2c9bcd13a0, args=<optimized out>, kwargs=<optimized out>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:355
#33 0x0000000000515f58 in do_call_core (use_tracing=<optimized out>, kwdict=0x7d2c99b21b80, callargs=0x7d2dcc1be590, func=0x7d2c9bcd13a0, tstate=<optimized out>) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:7349
#34 _PyEval_EvalFrameDefault (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, frame=<optimized out>, frame@entry=0x7d2dcc583020, throwflag=throwflag@entry=0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:5376
#35 0x00000000005cd0aa in _PyEval_EvalFrame (throwflag=0, frame=0x7d2dcc583020, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Include/internal/pycore_ceval.h:73
#36 _PyEval_Vector (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, func=func@entry=0x7d2dcc1d60c0, locals=locals@entry=0x7d2dcc1f69c0, args=args@entry=0x0, argcount=argcount@entry=0, kwnames=kwnames@entry=0x0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:6434
#37 0x00000000005cc77f in PyEval_EvalCode (co=co@entry=0x7d2dcc1c8030, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:1148
#38 0x00000000005ed557 in run_eval_code_obj (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, co=co@entry=0x7d2dcc1c8030, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:1741
#39 0x00000000005e9080 in run_mod (mod=mod@entry=0x5431ae0, filename=filename@entry=0x7d2dcc1ff780, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0, flags=flags@entry=0x7fffa58d6dd8, arena=arena@entry=0x7d2dcc11b670) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:1762
#40 0x00000000005fde72 in pyrun_file (fp=fp@entry=0x53c05a0, filename=filename@entry=0x7d2dcc1ff780, start=start@entry=257, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0, closeit=closeit@entry=1, flags=0x7fffa58d6dd8) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:1657
#41 0x00000000005fd28f in _PyRun_SimpleFileObject (fp=0x53c05a0, filename=0x7d2dcc1ff780, closeit=1, flags=0x7fffa58d6dd8) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:440
#42 0x00000000005fcfb3 in _PyRun_AnyFileObject (fp=0x53c05a0, filename=filename@entry=0x7d2dcc1ff780, closeit=closeit@entry=1, flags=flags@entry=0x7fffa58d6dd8) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:79
#43 0x00000000005f7dae in pymain_run_file_obj (skip_source_first_line=0, filename=0x7d2dcc1ff780, program_name=0x7d2dcc1973b0) at /usr/local/src/conda/python-3.11.13/Modules/main.c:360
#44 pymain_run_file (config=0x88f560 <_PyRuntime+59904>) at /usr/local/src/conda/python-3.11.13/Modules/main.c:379
#45 pymain_run_python (exitcode=0x7fffa58d6dd0) at /usr/local/src/conda/python-3.11.13/Modules/main.c:605
#46 Py_RunMain () at /usr/local/src/conda/python-3.11.13/Modules/main.c:684
#47 0x00000000005bcdf9 in Py_BytesMain (argc=<optimized out>, argv=<optimized out>) at /usr/local/src/conda/python-3.11.13/Modules/main.c:738
#48 0x00007d2dcc22a1ca in __libc_start_call_main (main=main@entry=0x5bcd50 <main>, argc=argc@entry=3, argv=argv@entry=0x7fffa58d7038) at ../sysdeps/nptl/libc_start_call_main.h:58
#49 0x00007d2dcc22a28b in __libc_start_main_impl (main=0x5bcd50 <main>, argc=3, argv=0x7fffa58d7038, init=<optimized out>, fini=<optimized out>, rtld_fini=<optimized out>, stack_end=0x7fffa58d7028) at ../csu/libc-start.c:360
---
[HIT] uct_md_close
#0  uct_md_close (md=0xa3d63c0) at base/uct_md.c:75
#1  0x00007d2c9943c8c4 in ucp_add_component_resources (context=0x122a21e0, cmpt_index=1 '\001', avail_devices=0x7fffa58d53a0, avail_tls=0x7fffa58d5320, dev_cfg_masks=0x7fffa58d5380, tl_cfg_mask=0x7fffa58d5248, config=0xab9b810, aux_tls=0x7fffa58d5350) at core/ucp_context.c:1649
#2  0x00007d2c9943d467 in ucp_fill_resources (context=0x122a21e0, config=0xab9b810) at core/ucp_context.c:1822
#3  0x00007d2c9943ef80 in ucp_init_version (api_major_version=1, api_minor_version=18, params=0x7fffa58d5530, config=0xab9b810, context_p=0x1229eff8) at core/ucp_context.c:2299
#4  0x00007d2c99999dbe in ucp_init (params=0x7fffa58d5530, config=0xab9b810, context_p=0x1229eff8) at /data/ZYH/ucx-1.18.1/install/include/ucp/api/ucp.h:2095
#5  0x00007d2c9999a7c9 in c10d::CommUCX::CommUCX (this=0x1229efe8, comm_size=2, logger=...) at /data/ZYH/torch_ucc/src/torch_ucc_comm.cpp:55
#6  0x00007d2c9992efba in c10d::Comm::Comm (this=0x1229efd0, logger_=..., oob_=std::shared_ptr<c10d::torch_ucc_oob_coll_info_t> (use count 4, weak count 0) = {...}, dev=..., is_health_check=false) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:336
#7  0x00007d2c9998dfd0 in std::_Construct<c10d::Comm, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (__p=0x1229efd0) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/stl_construct.h:119
#8  0x00007d2c9998a36c in std::allocator_traits<std::allocator<void> >::construct<c10d::Comm, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (__p=0x1229efd0) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/alloc_traits.h:635
#9  0x00007d2c9998494a in std::_Sp_counted_ptr_inplace<c10d::Comm, std::allocator<void>, (__gnu_cxx::_Lock_policy)2>::_Sp_counted_ptr_inplace<c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (this=0x1229efc0, __a=...) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr_base.h:604
#10 0x00007d2c9997b2d0 in std::__shared_count<(__gnu_cxx::_Lock_policy)2>::__shared_count<c10d::Comm, std::allocator<void>, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (this=0x7fffa58d5c88, __p=@0x7fffa58d5c80: 0x0, __a=...) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr_base.h:971
#11 0x00007d2c9996e535 in std::__shared_ptr<c10d::Comm, (__gnu_cxx::_Lock_policy)2>::__shared_ptr<std::allocator<void>, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (this=0x7fffa58d5c80, __tag=...) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr_base.h:1715
#12 0x00007d2c9995fb42 in std::shared_ptr<c10d::Comm>::shared_ptr<std::allocator<void>, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (this=0x7fffa58d5c80, __tag=...) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr.h:464
#13 0x00007d2c99949448 in std::make_shared<c10d::Comm, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> () at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr.h:1010
#14 0x00007d2c9992fc97 in c10d::Comm::get_comm (id=@0xa9b14f8: 0, dev=..., oob=std::shared_ptr<c10d::torch_ucc_oob_coll_info_t> (use count 4, weak count 0) = {...}, logger=..., is_health_check=false) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:407
#15 0x00007d2c9993e3b2 in c10d::ProcessGroupUCC::initComm (this=0xa9b13a0, dev=...) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:1873
#16 0x00007d2c9993d8d9 in c10d::ProcessGroupUCC::send (this=0xa9b13a0, tensors=std::vector of length 1, capacity 1 = {...}, dstRank=1, tag=0) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:1710
#17 0x00007d2dca343100 in pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}::operator()(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int) const (__closure=0x96f13f8, c=0xa9b13a0, args#0=std::vector of length 1, capacity 1 = {...}, args#1=1, args#2=0) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:136
#18 0x00007d2dca41dc91 in pybind11::detail::argument_loader<c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int>::call_impl<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&, 0ul, 1ul, 2ul, 3ul, pybind11::gil_scoped_release>(pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&, std::integer_sequence<unsigned long, 0ul, 1ul, 2ul, 3ul>, pybind11::gil_scoped_release&&) && (this=0x7fffa58d6340, f=...) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/cast.h:1631
#19 0x00007d2dca3e930e in pybind11::detail::argument_loader<c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int>::call<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, pybind11::gil_scoped_release, pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&>(pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&) && (this=0x7fffa58d6340, f=...) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/cast.h:1600
#20 0x00007d2dca39a925 in pybind11::cpp_function::initialize<pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&&, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (*)(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(pybind11::detail::function_call&)#1}::operator()(pybind11::detail::function_call&) const (__closure=0x0, call=...) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:278
#21 0x00007d2dca39ab46 in pybind11::cpp_function::initialize<pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&&, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (*)(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(pybind11::detail::function_call&)#1}::_FUN(pybind11::detail::function_call&) () at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:249
#22 0x00007d2dc8fe0da1 in pybind11::cpp_function::dispatcher (self=0x7d2c9bc16820, args_in=0x7d2dcbd4c400, kwargs_in=0x0) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:971
#23 0x0000000000528db7 in cfunction_call (func=0x7d2c9bc1b1a0, args=<optimized out>, kwargs=<optimized out>) at /usr/local/src/conda/python-3.11.13/Objects/methodobject.c:542
#24 0x000000000050454c in _PyObject_MakeTpCall (tstate=0x8a9518 <_PyRuntime+166328>, callable=0x7d2c9bc1b1a0, args=<optimized out>, nargs=<optimized out>, keywords=0x0) at /usr/local/src/conda/python-3.11.13/Objects/call.c:214
#25 0x0000000000511cf6 in _PyEval_EvalFrameDefault (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, frame=<optimized out>, frame@entry=0x7d2dcc5831e0, throwflag=throwflag@entry=0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:4769
#26 0x0000000000539503 in _PyEval_EvalFrame (throwflag=0, frame=0x7d2dcc5831e0, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Include/internal/pycore_ceval.h:73
#27 _PyEval_Vector (kwnames=<optimized out>, argcount=1, args=0x7d2d647caa78, locals=0x0, func=<optimized out>, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:6434
#28 _PyFunction_Vectorcall (func=<optimized out>, stack=0x7d2d647caa78, nargsf=<optimized out>, kwnames=<optimized out>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:393
#29 0x000000000054358c in _PyVectorcall_Call (kwargs=<optimized out>, tuple=<optimized out>, callable=0x7d2c9bcd13a0, func=0x539390 <_PyFunction_Vectorcall>, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:257
#30 _PyObject_Call (kwargs=<optimized out>, args=<optimized out>, callable=0x7d2c9bcd13a0, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:328
#31 PyObject_Call (callable=0x7d2c9bcd13a0, args=<optimized out>, kwargs=<optimized out>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:355
#32 0x0000000000515f58 in do_call_core (use_tracing=<optimized out>, kwdict=0x7d2c99b21b80, callargs=0x7d2dcc1be590, func=0x7d2c9bcd13a0, tstate=<optimized out>) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:7349
#33 _PyEval_EvalFrameDefault (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, frame=<optimized out>, frame@entry=0x7d2dcc583020, throwflag=throwflag@entry=0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:5376
#34 0x00000000005cd0aa in _PyEval_EvalFrame (throwflag=0, frame=0x7d2dcc583020, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Include/internal/pycore_ceval.h:73
#35 _PyEval_Vector (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, func=func@entry=0x7d2dcc1d60c0, locals=locals@entry=0x7d2dcc1f69c0, args=args@entry=0x0, argcount=argcount@entry=0, kwnames=kwnames@entry=0x0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:6434
#36 0x00000000005cc77f in PyEval_EvalCode (co=co@entry=0x7d2dcc1c8030, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:1148
#37 0x00000000005ed557 in run_eval_code_obj (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, co=co@entry=0x7d2dcc1c8030, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:1741
#38 0x00000000005e9080 in run_mod (mod=mod@entry=0x5431ae0, filename=filename@entry=0x7d2dcc1ff780, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0, flags=flags@entry=0x7fffa58d6dd8, arena=arena@entry=0x7d2dcc11b670) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:1762
#39 0x00000000005fde72 in pyrun_file (fp=fp@entry=0x53c05a0, filename=filename@entry=0x7d2dcc1ff780, start=start@entry=257, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0, closeit=closeit@entry=1, flags=0x7fffa58d6dd8) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:1657
#40 0x00000000005fd28f in _PyRun_SimpleFileObject (fp=0x53c05a0, filename=0x7d2dcc1ff780, closeit=1, flags=0x7fffa58d6dd8) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:440
#41 0x00000000005fcfb3 in _PyRun_AnyFileObject (fp=0x53c05a0, filename=filename@entry=0x7d2dcc1ff780, closeit=closeit@entry=1, flags=flags@entry=0x7fffa58d6dd8) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:79
#42 0x00000000005f7dae in pymain_run_file_obj (skip_source_first_line=0, filename=0x7d2dcc1ff780, program_name=0x7d2dcc1973b0) at /usr/local/src/conda/python-3.11.13/Modules/main.c:360
#43 pymain_run_file (config=0x88f560 <_PyRuntime+59904>) at /usr/local/src/conda/python-3.11.13/Modules/main.c:379
#44 pymain_run_python (exitcode=0x7fffa58d6dd0) at /usr/local/src/conda/python-3.11.13/Modules/main.c:605
#45 Py_RunMain () at /usr/local/src/conda/python-3.11.13/Modules/main.c:684
#46 0x00000000005bcdf9 in Py_BytesMain (argc=<optimized out>, argv=<optimized out>) at /usr/local/src/conda/python-3.11.13/Modules/main.c:738
#47 0x00007d2dcc22a1ca in __libc_start_call_main (main=main@entry=0x5bcd50 <main>, argc=argc@entry=3, argv=argv@entry=0x7fffa58d7038) at ../sysdeps/nptl/libc_start_call_main.h:58
#48 0x00007d2dcc22a28b in __libc_start_main_impl (main=0x5bcd50 <main>, argc=3, argv=0x7fffa58d7038, init=<optimized out>, fini=<optimized out>, rtld_fini=<optimized out>, stack_end=0x7fffa58d7028) at ../csu/libc-start.c:360
#49 0x00000000005bcc43 in _start ()
---
[HIT] ucm_mmap
#0  ucm_mmap (addr=0x0, length=4096, prot=1, flags=1, fd=62, offset=5242880) at event/event.c:178
#1  0x00007d2d95631d4e in ucm_override_mmap (arg0=0x0, arg1=4096, arg2=1, arg3=1, arg4=62, arg5=5242880) at util/replace.c:50
#2  0x00007d2c9c6940b6 in ?? () from /lib/x86_64-linux-gnu/libmlx5.so.1
#3  0x00007d2c9c6945f1 in ?? () from /lib/x86_64-linux-gnu/libmlx5.so.1
#4  0x00007d2d6b2f7a33 in verbs_open_device () from /lib/x86_64-linux-gnu/libibverbs.so.1
#5  0x00007d2c56901c6a in uct_ib_mlx5_devx_open_device (ibv_device=0x122aa2d0) at dv/ib_mlx5dv_md.c:1783
#6  0x00007d2c569032e6 in uct_ib_mlx5_devx_md_open (ibv_device=0x122aa2d0, md_config=0x122b1c10, p_md=0x7fffa58d4f88) at dv/ib_mlx5dv_md.c:2206
#7  0x00007d2d3e1ae60e in uct_ib_component_md_open (ib_device=0x122aa2d0, md_config=0x122b1c10, md_name=0x7fffa58d5100 "mlx5_0", md_p=0x7fffa58d4fe8) at base/ib_md.c:1031
#8  0x00007d2d3e1aeab3 in uct_ib_md_open (component=0x7d2d3e1fd700 <uct_ib_component>, md_name=0x7fffa58d5100 "mlx5_0", uct_md_config=0x122b1c10, md_p=0x7fffa58d5050) at base/ib_md.c:1126
#9  0x00007d2d646acd7e in uct_md_open (component=0x7d2d3e1fd700 <uct_ib_component>, md_name=0x7fffa58d5100 "mlx5_0", config=0x122b1c10, md_p=0x122ab738) at base/uct_md.c:61
#10 0x00007d2c9943b7f4 in ucp_fill_tl_md (context=0x122a21e0, cmpt_index=6 '\006', md_rsc=0x7fffa58d5100, tl_md=0x122ab738) at core/ucp_context.c:1379
#11 0x00007d2c9943c338 in ucp_add_component_resources (context=0x122a21e0, cmpt_index=6 '\006', avail_devices=0x7fffa58d53a0, avail_tls=0x7fffa58d5320, dev_cfg_masks=0x7fffa58d5380, tl_cfg_mask=0x7fffa58d5248, config=0xab9b810, aux_tls=0x7fffa58d5350) at core/ucp_context.c:1574
#12 0x00007d2c9943d467 in ucp_fill_resources (context=0x122a21e0, config=0xab9b810) at core/ucp_context.c:1822
#13 0x00007d2c9943ef80 in ucp_init_version (api_major_version=1, api_minor_version=18, params=0x7fffa58d5530, config=0xab9b810, context_p=0x1229eff8) at core/ucp_context.c:2299
#14 0x00007d2c99999dbe in ucp_init (params=0x7fffa58d5530, config=0xab9b810, context_p=0x1229eff8) at /data/ZYH/ucx-1.18.1/install/include/ucp/api/ucp.h:2095
#15 0x00007d2c9999a7c9 in c10d::CommUCX::CommUCX (this=0x1229efe8, comm_size=2, logger=...) at /data/ZYH/torch_ucc/src/torch_ucc_comm.cpp:55
#16 0x00007d2c9992efba in c10d::Comm::Comm (this=0x1229efd0, logger_=..., oob_=std::shared_ptr<c10d::torch_ucc_oob_coll_info_t> (use count 4, weak count 0) = {...}, dev=..., is_health_check=false) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:336
#17 0x00007d2c9998dfd0 in std::_Construct<c10d::Comm, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (__p=0x1229efd0) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/stl_construct.h:119
#18 0x00007d2c9998a36c in std::allocator_traits<std::allocator<void> >::construct<c10d::Comm, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (__p=0x1229efd0) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/alloc_traits.h:635
#19 0x00007d2c9998494a in std::_Sp_counted_ptr_inplace<c10d::Comm, std::allocator<void>, (__gnu_cxx::_Lock_policy)2>::_Sp_counted_ptr_inplace<c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (this=0x1229efc0, __a=...) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr_base.h:604
#20 0x00007d2c9997b2d0 in std::__shared_count<(__gnu_cxx::_Lock_policy)2>::__shared_count<c10d::Comm, std::allocator<void>, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (this=0x7fffa58d5c88, __p=@0x7fffa58d5c80: 0x0, __a=...) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr_base.h:971
#21 0x00007d2c9996e535 in std::__shared_ptr<c10d::Comm, (__gnu_cxx::_Lock_policy)2>::__shared_ptr<std::allocator<void>, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (this=0x7fffa58d5c80, __tag=...) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr_base.h:1715
#22 0x00007d2c9995fb42 in std::shared_ptr<c10d::Comm>::shared_ptr<std::allocator<void>, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (this=0x7fffa58d5c80, __tag=...) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr.h:464
#23 0x00007d2c99949448 in std::make_shared<c10d::Comm, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> () at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr.h:1010
#24 0x00007d2c9992fc97 in c10d::Comm::get_comm (id=@0xa9b14f8: 0, dev=..., oob=std::shared_ptr<c10d::torch_ucc_oob_coll_info_t> (use count 4, weak count 0) = {...}, logger=..., is_health_check=false) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:407
#25 0x00007d2c9993e3b2 in c10d::ProcessGroupUCC::initComm (this=0xa9b13a0, dev=...) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:1873
#26 0x00007d2c9993d8d9 in c10d::ProcessGroupUCC::send (this=0xa9b13a0, tensors=std::vector of length 1, capacity 1 = {...}, dstRank=1, tag=0) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:1710
#27 0x00007d2dca343100 in pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}::operator()(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int) const (__closure=0x96f13f8, c=0xa9b13a0, args#0=std::vector of length 1, capacity 1 = {...}, args#1=1, args#2=0) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:136
#28 0x00007d2dca41dc91 in pybind11::detail::argument_loader<c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int>::call_impl<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&, 0ul, 1ul, 2ul, 3ul, pybind11::gil_scoped_release>(pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&, std::integer_sequence<unsigned long, 0ul, 1ul, 2ul, 3ul>, pybind11::gil_scoped_release&&) && (this=0x7fffa58d6340, f=...) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/cast.h:1631
#29 0x00007d2dca3e930e in pybind11::detail::argument_loader<c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int>::call<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, pybind11::gil_scoped_release, pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&>(pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&) && (this=0x7fffa58d6340, f=...) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/cast.h:1600
#30 0x00007d2dca39a925 in pybind11::cpp_function::initialize<pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&&, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (*)(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(pybind11::detail::function_call&)#1}::operator()(pybind11::detail::function_call&) const (__closure=0x0, call=...) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:278
#31 0x00007d2dca39ab46 in pybind11::cpp_function::initialize<pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&&, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (*)(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(pybind11::detail::function_call&)#1}::_FUN(pybind11::detail::function_call&) () at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:249
#32 0x00007d2dc8fe0da1 in pybind11::cpp_function::dispatcher (self=0x7d2c9bc16820, args_in=0x7d2dcbd4c400, kwargs_in=0x0) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:971
#33 0x0000000000528db7 in cfunction_call (func=0x7d2c9bc1b1a0, args=<optimized out>, kwargs=<optimized out>) at /usr/local/src/conda/python-3.11.13/Objects/methodobject.c:542
#34 0x000000000050454c in _PyObject_MakeTpCall (tstate=0x8a9518 <_PyRuntime+166328>, callable=0x7d2c9bc1b1a0, args=<optimized out>, nargs=<optimized out>, keywords=0x0) at /usr/local/src/conda/python-3.11.13/Objects/call.c:214
#35 0x0000000000511cf6 in _PyEval_EvalFrameDefault (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, frame=<optimized out>, frame@entry=0x7d2dcc5831e0, throwflag=throwflag@entry=0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:4769
#36 0x0000000000539503 in _PyEval_EvalFrame (throwflag=0, frame=0x7d2dcc5831e0, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Include/internal/pycore_ceval.h:73
#37 _PyEval_Vector (kwnames=<optimized out>, argcount=1, args=0x7d2d647caa78, locals=0x0, func=<optimized out>, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:6434
#38 _PyFunction_Vectorcall (func=<optimized out>, stack=0x7d2d647caa78, nargsf=<optimized out>, kwnames=<optimized out>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:393
#39 0x000000000054358c in _PyVectorcall_Call (kwargs=<optimized out>, tuple=<optimized out>, callable=0x7d2c9bcd13a0, func=0x539390 <_PyFunction_Vectorcall>, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:257
#40 _PyObject_Call (kwargs=<optimized out>, args=<optimized out>, callable=0x7d2c9bcd13a0, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:328
#41 PyObject_Call (callable=0x7d2c9bcd13a0, args=<optimized out>, kwargs=<optimized out>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:355
#42 0x0000000000515f58 in do_call_core (use_tracing=<optimized out>, kwdict=0x7d2c99b21b80, callargs=0x7d2dcc1be590, func=0x7d2c9bcd13a0, tstate=<optimized out>) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:7349
#43 _PyEval_EvalFrameDefault (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, frame=<optimized out>, frame@entry=0x7d2dcc583020, throwflag=throwflag@entry=0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:5376
#44 0x00000000005cd0aa in _PyEval_EvalFrame (throwflag=0, frame=0x7d2dcc583020, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Include/internal/pycore_ceval.h:73
#45 _PyEval_Vector (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, func=func@entry=0x7d2dcc1d60c0, locals=locals@entry=0x7d2dcc1f69c0, args=args@entry=0x0, argcount=argcount@entry=0, kwnames=kwnames@entry=0x0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:6434
#46 0x00000000005cc77f in PyEval_EvalCode (co=co@entry=0x7d2dcc1c8030, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:1148
#47 0x00000000005ed557 in run_eval_code_obj (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, co=co@entry=0x7d2dcc1c8030, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:1741
#48 0x00000000005e9080 in run_mod (mod=mod@entry=0x5431ae0, filename=filename@entry=0x7d2dcc1ff780, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0, flags=flags@entry=0x7fffa58d6dd8, arena=arena@entry=0x7d2dcc11b670) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:1762
#49 0x00000000005fde72 in pyrun_file (fp=fp@entry=0x53c05a0, filename=filename@entry=0x7d2dcc1ff780, start=start@entry=257, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0, closeit=closeit@entry=1, flags=0x7fffa58d6dd8) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:1657
---
[HIT] ucm_orig_mmap
#0  ucm_orig_mmap (arg0=0x0, arg1=4096, arg2=1, arg3=1, arg4=62, arg5=5242880) at util/replace.c:62
#1  0x00007d2d9562a44d in ucm_event_call_orig (event_type=UCM_EVENT_MMAP, event=0x7fffa58d4870, arg=0x0) at event/event.c:64
#2  0x00007d2d9562a682 in ucm_event_dispatch (event_type=UCM_EVENT_MMAP, event=0x7fffa58d4870) at event/event.c:145
#3  0x00007d2d9562a98f in ucm_mmap (addr=0x0, length=4096, prot=1, flags=1, fd=62, offset=5242880) at event/event.c:197
#4  0x00007d2d95631d4e in ucm_override_mmap (arg0=0x0, arg1=4096, arg2=1, arg3=1, arg4=62, arg5=5242880) at util/replace.c:50
#5  0x00007d2c9c6940b6 in ?? () from /lib/x86_64-linux-gnu/libmlx5.so.1
#6  0x00007d2c9c6945f1 in ?? () from /lib/x86_64-linux-gnu/libmlx5.so.1
#7  0x00007d2d6b2f7a33 in verbs_open_device () from /lib/x86_64-linux-gnu/libibverbs.so.1
#8  0x00007d2c56901c6a in uct_ib_mlx5_devx_open_device (ibv_device=0x122aa2d0) at dv/ib_mlx5dv_md.c:1783
#9  0x00007d2c569032e6 in uct_ib_mlx5_devx_md_open (ibv_device=0x122aa2d0, md_config=0x122b1c10, p_md=0x7fffa58d4f88) at dv/ib_mlx5dv_md.c:2206
#10 0x00007d2d3e1ae60e in uct_ib_component_md_open (ib_device=0x122aa2d0, md_config=0x122b1c10, md_name=0x7fffa58d5100 "mlx5_0", md_p=0x7fffa58d4fe8) at base/ib_md.c:1031
#11 0x00007d2d3e1aeab3 in uct_ib_md_open (component=0x7d2d3e1fd700 <uct_ib_component>, md_name=0x7fffa58d5100 "mlx5_0", uct_md_config=0x122b1c10, md_p=0x7fffa58d5050) at base/ib_md.c:1126
#12 0x00007d2d646acd7e in uct_md_open (component=0x7d2d3e1fd700 <uct_ib_component>, md_name=0x7fffa58d5100 "mlx5_0", config=0x122b1c10, md_p=0x122ab738) at base/uct_md.c:61
#13 0x00007d2c9943b7f4 in ucp_fill_tl_md (context=0x122a21e0, cmpt_index=6 '\006', md_rsc=0x7fffa58d5100, tl_md=0x122ab738) at core/ucp_context.c:1379
#14 0x00007d2c9943c338 in ucp_add_component_resources (context=0x122a21e0, cmpt_index=6 '\006', avail_devices=0x7fffa58d53a0, avail_tls=0x7fffa58d5320, dev_cfg_masks=0x7fffa58d5380, tl_cfg_mask=0x7fffa58d5248, config=0xab9b810, aux_tls=0x7fffa58d5350) at core/ucp_context.c:1574
#15 0x00007d2c9943d467 in ucp_fill_resources (context=0x122a21e0, config=0xab9b810) at core/ucp_context.c:1822
#16 0x00007d2c9943ef80 in ucp_init_version (api_major_version=1, api_minor_version=18, params=0x7fffa58d5530, config=0xab9b810, context_p=0x1229eff8) at core/ucp_context.c:2299
#17 0x00007d2c99999dbe in ucp_init (params=0x7fffa58d5530, config=0xab9b810, context_p=0x1229eff8) at /data/ZYH/ucx-1.18.1/install/include/ucp/api/ucp.h:2095
#18 0x00007d2c9999a7c9 in c10d::CommUCX::CommUCX (this=0x1229efe8, comm_size=2, logger=...) at /data/ZYH/torch_ucc/src/torch_ucc_comm.cpp:55
#19 0x00007d2c9992efba in c10d::Comm::Comm (this=0x1229efd0, logger_=..., oob_=std::shared_ptr<c10d::torch_ucc_oob_coll_info_t> (use count 4, weak count 0) = {...}, dev=..., is_health_check=false) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:336
#20 0x00007d2c9998dfd0 in std::_Construct<c10d::Comm, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (__p=0x1229efd0) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/stl_construct.h:119
#21 0x00007d2c9998a36c in std::allocator_traits<std::allocator<void> >::construct<c10d::Comm, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (__p=0x1229efd0) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/alloc_traits.h:635
#22 0x00007d2c9998494a in std::_Sp_counted_ptr_inplace<c10d::Comm, std::allocator<void>, (__gnu_cxx::_Lock_policy)2>::_Sp_counted_ptr_inplace<c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (this=0x1229efc0, __a=...) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr_base.h:604
#23 0x00007d2c9997b2d0 in std::__shared_count<(__gnu_cxx::_Lock_policy)2>::__shared_count<c10d::Comm, std::allocator<void>, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (this=0x7fffa58d5c88, __p=@0x7fffa58d5c80: 0x0, __a=...) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr_base.h:971
#24 0x00007d2c9996e535 in std::__shared_ptr<c10d::Comm, (__gnu_cxx::_Lock_policy)2>::__shared_ptr<std::allocator<void>, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (this=0x7fffa58d5c80, __tag=...) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr_base.h:1715
#25 0x00007d2c9995fb42 in std::shared_ptr<c10d::Comm>::shared_ptr<std::allocator<void>, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (this=0x7fffa58d5c80, __tag=...) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr.h:464
#26 0x00007d2c99949448 in std::make_shared<c10d::Comm, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> () at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr.h:1010
#27 0x00007d2c9992fc97 in c10d::Comm::get_comm (id=@0xa9b14f8: 0, dev=..., oob=std::shared_ptr<c10d::torch_ucc_oob_coll_info_t> (use count 4, weak count 0) = {...}, logger=..., is_health_check=false) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:407
#28 0x00007d2c9993e3b2 in c10d::ProcessGroupUCC::initComm (this=0xa9b13a0, dev=...) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:1873
#29 0x00007d2c9993d8d9 in c10d::ProcessGroupUCC::send (this=0xa9b13a0, tensors=std::vector of length 1, capacity 1 = {...}, dstRank=1, tag=0) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:1710
#30 0x00007d2dca343100 in pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}::operator()(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int) const (__closure=0x96f13f8, c=0xa9b13a0, args#0=std::vector of length 1, capacity 1 = {...}, args#1=1, args#2=0) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:136
#31 0x00007d2dca41dc91 in pybind11::detail::argument_loader<c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int>::call_impl<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&, 0ul, 1ul, 2ul, 3ul, pybind11::gil_scoped_release>(pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&, std::integer_sequence<unsigned long, 0ul, 1ul, 2ul, 3ul>, pybind11::gil_scoped_release&&) && (this=0x7fffa58d6340, f=...) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/cast.h:1631
#32 0x00007d2dca3e930e in pybind11::detail::argument_loader<c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int>::call<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, pybind11::gil_scoped_release, pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&>(pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&) && (this=0x7fffa58d6340, f=...) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/cast.h:1600
#33 0x00007d2dca39a925 in pybind11::cpp_function::initialize<pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&&, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (*)(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(pybind11::detail::function_call&)#1}::operator()(pybind11::detail::function_call&) const (__closure=0x0, call=...) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:278
#34 0x00007d2dca39ab46 in pybind11::cpp_function::initialize<pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&&, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (*)(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(pybind11::detail::function_call&)#1}::_FUN(pybind11::detail::function_call&) () at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:249
#35 0x00007d2dc8fe0da1 in pybind11::cpp_function::dispatcher (self=0x7d2c9bc16820, args_in=0x7d2dcbd4c400, kwargs_in=0x0) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:971
#36 0x0000000000528db7 in cfunction_call (func=0x7d2c9bc1b1a0, args=<optimized out>, kwargs=<optimized out>) at /usr/local/src/conda/python-3.11.13/Objects/methodobject.c:542
#37 0x000000000050454c in _PyObject_MakeTpCall (tstate=0x8a9518 <_PyRuntime+166328>, callable=0x7d2c9bc1b1a0, args=<optimized out>, nargs=<optimized out>, keywords=0x0) at /usr/local/src/conda/python-3.11.13/Objects/call.c:214
#38 0x0000000000511cf6 in _PyEval_EvalFrameDefault (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, frame=<optimized out>, frame@entry=0x7d2dcc5831e0, throwflag=throwflag@entry=0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:4769
#39 0x0000000000539503 in _PyEval_EvalFrame (throwflag=0, frame=0x7d2dcc5831e0, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Include/internal/pycore_ceval.h:73
#40 _PyEval_Vector (kwnames=<optimized out>, argcount=1, args=0x7d2d647caa78, locals=0x0, func=<optimized out>, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:6434
#41 _PyFunction_Vectorcall (func=<optimized out>, stack=0x7d2d647caa78, nargsf=<optimized out>, kwnames=<optimized out>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:393
#42 0x000000000054358c in _PyVectorcall_Call (kwargs=<optimized out>, tuple=<optimized out>, callable=0x7d2c9bcd13a0, func=0x539390 <_PyFunction_Vectorcall>, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:257
#43 _PyObject_Call (kwargs=<optimized out>, args=<optimized out>, callable=0x7d2c9bcd13a0, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:328
#44 PyObject_Call (callable=0x7d2c9bcd13a0, args=<optimized out>, kwargs=<optimized out>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:355
#45 0x0000000000515f58 in do_call_core (use_tracing=<optimized out>, kwdict=0x7d2c99b21b80, callargs=0x7d2dcc1be590, func=0x7d2c9bcd13a0, tstate=<optimized out>) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:7349
#46 _PyEval_EvalFrameDefault (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, frame=<optimized out>, frame@entry=0x7d2dcc583020, throwflag=throwflag@entry=0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:5376
#47 0x00000000005cd0aa in _PyEval_EvalFrame (throwflag=0, frame=0x7d2dcc583020, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Include/internal/pycore_ceval.h:73
#48 _PyEval_Vector (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, func=func@entry=0x7d2dcc1d60c0, locals=locals@entry=0x7d2dcc1f69c0, args=args@entry=0x0, argcount=argcount@entry=0, kwnames=kwnames@entry=0x0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:6434
#49 0x00000000005cc77f in PyEval_EvalCode (co=co@entry=0x7d2dcc1c8030, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:1148
---
[HIT] ucm_munmap
#0  ucm_munmap (addr=0x7d2c54000000, length=33554432) at event/event.c:211
#1  0x00007d2d95631dea in ucm_override_munmap (arg0=0x7d2c54000000, arg1=33554432) at util/replace.c:51
#2  0x00007d2dcc2aa11f in alloc_new_heap (size=135168, size@entry=2904, top_pad=top_pad@entry=131072, pagesize=pagesize@entry=4096, mmap_flags=mmap_flags@entry=0) at ./malloc/arena.c:424
#3  0x00007d2dcc2aa599 in new_heap (top_pad=131072, size=2904) at ./malloc/arena.c:470
#4  _int_new_arena (size=640) at ./malloc/arena.c:638
#5  arena_get2 (size=size@entry=640, avoid_arena=avoid_arena@entry=0x0) at ./malloc/arena.c:857
#6  0x00007d2dcc2aceb9 in arena_get2 (avoid_arena=0x0, size=640) at ./malloc/arena.c:825
#7  tcache_init () at ./malloc/malloc.c:3251
#8  0x00007d2dcc2ad776 in tcache_init () at ./malloc/malloc.c:3248
#9  __GI___libc_malloc (bytes=36) at ./malloc/malloc.c:3313
#10 0x00007d2dcc5a3bde in malloc (size=<optimized out>) at ../include/rtld-malloc.h:56
#11 allocate_dtv_entry (size=<optimized out>, alignment=4) at ../elf/dl-tls.c:679
#12 allocate_and_init (map=0xa3d2fb0) at ../elf/dl-tls.c:704
#13 tls_get_addr_tail (ti=0x7d2d718f6e80, dtv=0x122b61c0, the_map=0xa3d2fb0) at ../elf/dl-tls.c:904
#14 0x00007d2dcc5a785c in __tls_get_addr () at ../sysdeps/x86_64/tls_get_addr.S:55
#15 0x00007d2d718aa824 in ucs_log_set_thread_name (format=0x7d2d718d7a06 "a") at debug/log.c:611
#16 0x00007d2d71883c27 in ucs_async_thread_func (arg=0x122b1b70) at async/thread.c:109
#17 0x00007d2dcc29caa4 in start_thread (arg=<optimized out>) at ./nptl/pthread_create.c:447
#18 0x00007d2dcc329c3c in clone3 () at ../sysdeps/unix/sysv/linux/x86_64/clone3.S:78
---
[HIT] ucm_orig_munmap
#0  ucm_orig_munmap (arg0=0x7d2dcb767000, arg1=4096) at util/replace.c:63
#1  0x00007d2d9562a483 in ucm_event_call_orig (event_type=UCM_EVENT_MUNMAP, event=0x7fffa58d4c70, arg=0x0) at event/event.c:74
#2  0x00007d2d9562a682 in ucm_event_dispatch (event_type=UCM_EVENT_MUNMAP, event=0x7fffa58d4c70) at event/event.c:145
#3  0x00007d2d9562ab6a in ucm_munmap (addr=0x7d2dcb767000, length=4096) at event/event.c:223
#4  0x00007d2d95631dea in ucm_override_munmap (arg0=0x7d2dcb767000, arg1=4096) at util/replace.c:51
#5  0x00007d2c9c6ac32b in ?? () from /lib/x86_64-linux-gnu/libmlx5.so.1
#6  0x00007d2c568f9bfd in ibv_free_dm (dm=0x122b2a50) at /usr/include/infiniband/verbs.h:2777
#7  0x00007d2c56902eca in uct_ib_mlx5_devx_device_mem_free (uct_md=0x122b5610, tl_memh=0x122b6460) at dv/ib_mlx5dv_md.c:2109
#8  0x00007d2c569030d8 in uct_ib_mlx5dv_check_dm_ksm_reg (md=0x122b5610) at dv/ib_mlx5dv_md.c:2153
#9  0x00007d2c56904280 in uct_ib_mlx5_devx_md_open (ibv_device=0x122aa2d0, md_config=0x122b1c10, p_md=0x7fffa58d4f88) at dv/ib_mlx5dv_md.c:2470
#10 0x00007d2d3e1ae60e in uct_ib_component_md_open (ib_device=0x122aa2d0, md_config=0x122b1c10, md_name=0x7fffa58d5100 "mlx5_0", md_p=0x7fffa58d4fe8) at base/ib_md.c:1031
#11 0x00007d2d3e1aeab3 in uct_ib_md_open (component=0x7d2d3e1fd700 <uct_ib_component>, md_name=0x7fffa58d5100 "mlx5_0", uct_md_config=0x122b1c10, md_p=0x7fffa58d5050) at base/ib_md.c:1126
#12 0x00007d2d646acd7e in uct_md_open (component=0x7d2d3e1fd700 <uct_ib_component>, md_name=0x7fffa58d5100 "mlx5_0", config=0x122b1c10, md_p=0x122ab738) at base/uct_md.c:61
#13 0x00007d2c9943b7f4 in ucp_fill_tl_md (context=0x122a21e0, cmpt_index=6 '\006', md_rsc=0x7fffa58d5100, tl_md=0x122ab738) at core/ucp_context.c:1379
#14 0x00007d2c9943c338 in ucp_add_component_resources (context=0x122a21e0, cmpt_index=6 '\006', avail_devices=0x7fffa58d53a0, avail_tls=0x7fffa58d5320, dev_cfg_masks=0x7fffa58d5380, tl_cfg_mask=0x7fffa58d5248, config=0xab9b810, aux_tls=0x7fffa58d5350) at core/ucp_context.c:1574
#15 0x00007d2c9943d467 in ucp_fill_resources (context=0x122a21e0, config=0xab9b810) at core/ucp_context.c:1822
#16 0x00007d2c9943ef80 in ucp_init_version (api_major_version=1, api_minor_version=18, params=0x7fffa58d5530, config=0xab9b810, context_p=0x1229eff8) at core/ucp_context.c:2299
#17 0x00007d2c99999dbe in ucp_init (params=0x7fffa58d5530, config=0xab9b810, context_p=0x1229eff8) at /data/ZYH/ucx-1.18.1/install/include/ucp/api/ucp.h:2095
#18 0x00007d2c9999a7c9 in c10d::CommUCX::CommUCX (this=0x1229efe8, comm_size=2, logger=...) at /data/ZYH/torch_ucc/src/torch_ucc_comm.cpp:55
#19 0x00007d2c9992efba in c10d::Comm::Comm (this=0x1229efd0, logger_=..., oob_=std::shared_ptr<c10d::torch_ucc_oob_coll_info_t> (use count 4, weak count 0) = {...}, dev=..., is_health_check=false) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:336
#20 0x00007d2c9998dfd0 in std::_Construct<c10d::Comm, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (__p=0x1229efd0) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/stl_construct.h:119
#21 0x00007d2c9998a36c in std::allocator_traits<std::allocator<void> >::construct<c10d::Comm, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (__p=0x1229efd0) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/alloc_traits.h:635
#22 0x00007d2c9998494a in std::_Sp_counted_ptr_inplace<c10d::Comm, std::allocator<void>, (__gnu_cxx::_Lock_policy)2>::_Sp_counted_ptr_inplace<c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (this=0x1229efc0, __a=...) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr_base.h:604
#23 0x00007d2c9997b2d0 in std::__shared_count<(__gnu_cxx::_Lock_policy)2>::__shared_count<c10d::Comm, std::allocator<void>, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (this=0x7fffa58d5c88, __p=@0x7fffa58d5c80: 0x0, __a=...) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr_base.h:971
#24 0x00007d2c9996e535 in std::__shared_ptr<c10d::Comm, (__gnu_cxx::_Lock_policy)2>::__shared_ptr<std::allocator<void>, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (this=0x7fffa58d5c80, __tag=...) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr_base.h:1715
#25 0x00007d2c9995fb42 in std::shared_ptr<c10d::Comm>::shared_ptr<std::allocator<void>, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (this=0x7fffa58d5c80, __tag=...) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr.h:464
#26 0x00007d2c99949448 in std::make_shared<c10d::Comm, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> () at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr.h:1010
#27 0x00007d2c9992fc97 in c10d::Comm::get_comm (id=@0xa9b14f8: 0, dev=..., oob=std::shared_ptr<c10d::torch_ucc_oob_coll_info_t> (use count 4, weak count 0) = {...}, logger=..., is_health_check=false) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:407
#28 0x00007d2c9993e3b2 in c10d::ProcessGroupUCC::initComm (this=0xa9b13a0, dev=...) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:1873
#29 0x00007d2c9993d8d9 in c10d::ProcessGroupUCC::send (this=0xa9b13a0, tensors=std::vector of length 1, capacity 1 = {...}, dstRank=1, tag=0) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:1710
#30 0x00007d2dca343100 in pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}::operator()(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int) const (__closure=0x96f13f8, c=0xa9b13a0, args#0=std::vector of length 1, capacity 1 = {...}, args#1=1, args#2=0) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:136
#31 0x00007d2dca41dc91 in pybind11::detail::argument_loader<c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int>::call_impl<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&, 0ul, 1ul, 2ul, 3ul, pybind11::gil_scoped_release>(pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&, std::integer_sequence<unsigned long, 0ul, 1ul, 2ul, 3ul>, pybind11::gil_scoped_release&&) && (this=0x7fffa58d6340, f=...) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/cast.h:1631
#32 0x00007d2dca3e930e in pybind11::detail::argument_loader<c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int>::call<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, pybind11::gil_scoped_release, pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&>(pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&) && (this=0x7fffa58d6340, f=...) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/cast.h:1600
#33 0x00007d2dca39a925 in pybind11::cpp_function::initialize<pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&&, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (*)(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(pybind11::detail::function_call&)#1}::operator()(pybind11::detail::function_call&) const (__closure=0x0, call=...) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:278
#34 0x00007d2dca39ab46 in pybind11::cpp_function::initialize<pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&&, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (*)(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(pybind11::detail::function_call&)#1}::_FUN(pybind11::detail::function_call&) () at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:249
#35 0x00007d2dc8fe0da1 in pybind11::cpp_function::dispatcher (self=0x7d2c9bc16820, args_in=0x7d2dcbd4c400, kwargs_in=0x0) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:971
#36 0x0000000000528db7 in cfunction_call (func=0x7d2c9bc1b1a0, args=<optimized out>, kwargs=<optimized out>) at /usr/local/src/conda/python-3.11.13/Objects/methodobject.c:542
#37 0x000000000050454c in _PyObject_MakeTpCall (tstate=0x8a9518 <_PyRuntime+166328>, callable=0x7d2c9bc1b1a0, args=<optimized out>, nargs=<optimized out>, keywords=0x0) at /usr/local/src/conda/python-3.11.13/Objects/call.c:214
#38 0x0000000000511cf6 in _PyEval_EvalFrameDefault (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, frame=<optimized out>, frame@entry=0x7d2dcc5831e0, throwflag=throwflag@entry=0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:4769
#39 0x0000000000539503 in _PyEval_EvalFrame (throwflag=0, frame=0x7d2dcc5831e0, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Include/internal/pycore_ceval.h:73
#40 _PyEval_Vector (kwnames=<optimized out>, argcount=1, args=0x7d2d647caa78, locals=0x0, func=<optimized out>, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:6434
#41 _PyFunction_Vectorcall (func=<optimized out>, stack=0x7d2d647caa78, nargsf=<optimized out>, kwnames=<optimized out>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:393
#42 0x000000000054358c in _PyVectorcall_Call (kwargs=<optimized out>, tuple=<optimized out>, callable=0x7d2c9bcd13a0, func=0x539390 <_PyFunction_Vectorcall>, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:257
#43 _PyObject_Call (kwargs=<optimized out>, args=<optimized out>, callable=0x7d2c9bcd13a0, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:328
#44 PyObject_Call (callable=0x7d2c9bcd13a0, args=<optimized out>, kwargs=<optimized out>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:355
#45 0x0000000000515f58 in do_call_core (use_tracing=<optimized out>, kwdict=0x7d2c99b21b80, callargs=0x7d2dcc1be590, func=0x7d2c9bcd13a0, tstate=<optimized out>) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:7349
#46 _PyEval_EvalFrameDefault (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, frame=<optimized out>, frame@entry=0x7d2dcc583020, throwflag=throwflag@entry=0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:5376
#47 0x00000000005cd0aa in _PyEval_EvalFrame (throwflag=0, frame=0x7d2dcc583020, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Include/internal/pycore_ceval.h:73
#48 _PyEval_Vector (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, func=func@entry=0x7d2dcc1d60c0, locals=locals@entry=0x7d2dcc1f69c0, args=args@entry=0x0, argcount=argcount@entry=0, kwnames=kwnames@entry=0x0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:6434
#49 0x00000000005cc77f in PyEval_EvalCode (co=co@entry=0x7d2dcc1c8030, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:1148
---
[HIT] ucm_madvise
#0  ucm_madvise (addr=0x12341000, length=4096, advice=11) at event/event.c:450
#1  0x00007d2d95632195 in ucm_override_madvise (arg0=0x12341000, arg1=4096, arg2=11) at util/replace.c:60
#2  0x00007d2c568fbd85 in uct_ib_mlx5_md_buf_free (md=0x122bd310, buf=0x12341000, mem=0x122bd758) at /data/ZYH/ucx-1.18.1/src/uct/ib/mlx5/ib_mlx5.h:1081
#3  0x00007d2c56904638 in uct_ib_mlx5_devx_md_close (tl_md=0x122bd310) at dv/ib_mlx5dv_md.c:2535
#4  0x00007d2d646ace44 in uct_md_close (md=0x122bd310) at base/uct_md.c:76
#5  0x00007d2c9943c8c4 in ucp_add_component_resources (context=0x122a21e0, cmpt_index=7 '\a', avail_devices=0x7fffa58d53a0, avail_tls=0x7fffa58d5320, dev_cfg_masks=0x7fffa58d5380, tl_cfg_mask=0x7fffa58d5248, config=0xab9b810, aux_tls=0x7fffa58d5350) at core/ucp_context.c:1649
#6  0x00007d2c9943d467 in ucp_fill_resources (context=0x122a21e0, config=0xab9b810) at core/ucp_context.c:1822
#7  0x00007d2c9943ef80 in ucp_init_version (api_major_version=1, api_minor_version=18, params=0x7fffa58d5530, config=0xab9b810, context_p=0x1229eff8) at core/ucp_context.c:2299
#8  0x00007d2c99999dbe in ucp_init (params=0x7fffa58d5530, config=0xab9b810, context_p=0x1229eff8) at /data/ZYH/ucx-1.18.1/install/include/ucp/api/ucp.h:2095
#9  0x00007d2c9999a7c9 in c10d::CommUCX::CommUCX (this=0x1229efe8, comm_size=2, logger=...) at /data/ZYH/torch_ucc/src/torch_ucc_comm.cpp:55
#10 0x00007d2c9992efba in c10d::Comm::Comm (this=0x1229efd0, logger_=..., oob_=std::shared_ptr<c10d::torch_ucc_oob_coll_info_t> (use count 4, weak count 0) = {...}, dev=..., is_health_check=false) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:336
#11 0x00007d2c9998dfd0 in std::_Construct<c10d::Comm, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (__p=0x1229efd0) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/stl_construct.h:119
#12 0x00007d2c9998a36c in std::allocator_traits<std::allocator<void> >::construct<c10d::Comm, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (__p=0x1229efd0) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/alloc_traits.h:635
#13 0x00007d2c9998494a in std::_Sp_counted_ptr_inplace<c10d::Comm, std::allocator<void>, (__gnu_cxx::_Lock_policy)2>::_Sp_counted_ptr_inplace<c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (this=0x1229efc0, __a=...) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr_base.h:604
#14 0x00007d2c9997b2d0 in std::__shared_count<(__gnu_cxx::_Lock_policy)2>::__shared_count<c10d::Comm, std::allocator<void>, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (this=0x7fffa58d5c88, __p=@0x7fffa58d5c80: 0x0, __a=...) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr_base.h:971
#15 0x00007d2c9996e535 in std::__shared_ptr<c10d::Comm, (__gnu_cxx::_Lock_policy)2>::__shared_ptr<std::allocator<void>, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (this=0x7fffa58d5c80, __tag=...) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr_base.h:1715
#16 0x00007d2c9995fb42 in std::shared_ptr<c10d::Comm>::shared_ptr<std::allocator<void>, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (this=0x7fffa58d5c80, __tag=...) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr.h:464
#17 0x00007d2c99949448 in std::make_shared<c10d::Comm, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> () at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr.h:1010
#18 0x00007d2c9992fc97 in c10d::Comm::get_comm (id=@0xa9b14f8: 0, dev=..., oob=std::shared_ptr<c10d::torch_ucc_oob_coll_info_t> (use count 4, weak count 0) = {...}, logger=..., is_health_check=false) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:407
#19 0x00007d2c9993e3b2 in c10d::ProcessGroupUCC::initComm (this=0xa9b13a0, dev=...) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:1873
#20 0x00007d2c9993d8d9 in c10d::ProcessGroupUCC::send (this=0xa9b13a0, tensors=std::vector of length 1, capacity 1 = {...}, dstRank=1, tag=0) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:1710
#21 0x00007d2dca343100 in pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}::operator()(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int) const (__closure=0x96f13f8, c=0xa9b13a0, args#0=std::vector of length 1, capacity 1 = {...}, args#1=1, args#2=0) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:136
#22 0x00007d2dca41dc91 in pybind11::detail::argument_loader<c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int>::call_impl<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&, 0ul, 1ul, 2ul, 3ul, pybind11::gil_scoped_release>(pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&, std::integer_sequence<unsigned long, 0ul, 1ul, 2ul, 3ul>, pybind11::gil_scoped_release&&) && (this=0x7fffa58d6340, f=...) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/cast.h:1631
#23 0x00007d2dca3e930e in pybind11::detail::argument_loader<c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int>::call<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, pybind11::gil_scoped_release, pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&>(pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&) && (this=0x7fffa58d6340, f=...) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/cast.h:1600
#24 0x00007d2dca39a925 in pybind11::cpp_function::initialize<pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&&, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (*)(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(pybind11::detail::function_call&)#1}::operator()(pybind11::detail::function_call&) const (__closure=0x0, call=...) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:278
#25 0x00007d2dca39ab46 in pybind11::cpp_function::initialize<pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&&, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (*)(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(pybind11::detail::function_call&)#1}::_FUN(pybind11::detail::function_call&) () at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:249
#26 0x00007d2dc8fe0da1 in pybind11::cpp_function::dispatcher (self=0x7d2c9bc16820, args_in=0x7d2dcbd4c400, kwargs_in=0x0) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:971
#27 0x0000000000528db7 in cfunction_call (func=0x7d2c9bc1b1a0, args=<optimized out>, kwargs=<optimized out>) at /usr/local/src/conda/python-3.11.13/Objects/methodobject.c:542
#28 0x000000000050454c in _PyObject_MakeTpCall (tstate=0x8a9518 <_PyRuntime+166328>, callable=0x7d2c9bc1b1a0, args=<optimized out>, nargs=<optimized out>, keywords=0x0) at /usr/local/src/conda/python-3.11.13/Objects/call.c:214
#29 0x0000000000511cf6 in _PyEval_EvalFrameDefault (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, frame=<optimized out>, frame@entry=0x7d2dcc5831e0, throwflag=throwflag@entry=0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:4769
#30 0x0000000000539503 in _PyEval_EvalFrame (throwflag=0, frame=0x7d2dcc5831e0, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Include/internal/pycore_ceval.h:73
#31 _PyEval_Vector (kwnames=<optimized out>, argcount=1, args=0x7d2d647caa78, locals=0x0, func=<optimized out>, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:6434
#32 _PyFunction_Vectorcall (func=<optimized out>, stack=0x7d2d647caa78, nargsf=<optimized out>, kwnames=<optimized out>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:393
#33 0x000000000054358c in _PyVectorcall_Call (kwargs=<optimized out>, tuple=<optimized out>, callable=0x7d2c9bcd13a0, func=0x539390 <_PyFunction_Vectorcall>, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:257
#34 _PyObject_Call (kwargs=<optimized out>, args=<optimized out>, callable=0x7d2c9bcd13a0, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:328
#35 PyObject_Call (callable=0x7d2c9bcd13a0, args=<optimized out>, kwargs=<optimized out>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:355
#36 0x0000000000515f58 in do_call_core (use_tracing=<optimized out>, kwdict=0x7d2c99b21b80, callargs=0x7d2dcc1be590, func=0x7d2c9bcd13a0, tstate=<optimized out>) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:7349
#37 _PyEval_EvalFrameDefault (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, frame=<optimized out>, frame@entry=0x7d2dcc583020, throwflag=throwflag@entry=0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:5376
#38 0x00000000005cd0aa in _PyEval_EvalFrame (throwflag=0, frame=0x7d2dcc583020, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Include/internal/pycore_ceval.h:73
#39 _PyEval_Vector (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, func=func@entry=0x7d2dcc1d60c0, locals=locals@entry=0x7d2dcc1f69c0, args=args@entry=0x0, argcount=argcount@entry=0, kwnames=kwnames@entry=0x0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:6434
#40 0x00000000005cc77f in PyEval_EvalCode (co=co@entry=0x7d2dcc1c8030, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:1148
#41 0x00000000005ed557 in run_eval_code_obj (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, co=co@entry=0x7d2dcc1c8030, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:1741
#42 0x00000000005e9080 in run_mod (mod=mod@entry=0x5431ae0, filename=filename@entry=0x7d2dcc1ff780, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0, flags=flags@entry=0x7fffa58d6dd8, arena=arena@entry=0x7d2dcc11b670) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:1762
#43 0x00000000005fde72 in pyrun_file (fp=fp@entry=0x53c05a0, filename=filename@entry=0x7d2dcc1ff780, start=start@entry=257, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0, closeit=closeit@entry=1, flags=0x7fffa58d6dd8) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:1657
#44 0x00000000005fd28f in _PyRun_SimpleFileObject (fp=0x53c05a0, filename=0x7d2dcc1ff780, closeit=1, flags=0x7fffa58d6dd8) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:440
#45 0x00000000005fcfb3 in _PyRun_AnyFileObject (fp=0x53c05a0, filename=filename@entry=0x7d2dcc1ff780, closeit=closeit@entry=1, flags=flags@entry=0x7fffa58d6dd8) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:79
#46 0x00000000005f7dae in pymain_run_file_obj (skip_source_first_line=0, filename=0x7d2dcc1ff780, program_name=0x7d2dcc1973b0) at /usr/local/src/conda/python-3.11.13/Modules/main.c:360
#47 pymain_run_file (config=0x88f560 <_PyRuntime+59904>) at /usr/local/src/conda/python-3.11.13/Modules/main.c:379
#48 pymain_run_python (exitcode=0x7fffa58d6dd0) at /usr/local/src/conda/python-3.11.13/Modules/main.c:605
#49 Py_RunMain () at /usr/local/src/conda/python-3.11.13/Modules/main.c:684
---
[HIT] ucm_orig_madvise
#0  ucm_orig_madvise (arg0=0x12341000, arg1=4096, arg2=11) at util/replace.c:68
#1  0x00007d2d9562a5cc in ucm_event_call_orig (event_type=UCM_EVENT_MADVISE, event=0x7fffa58d4fe0, arg=0x0) at event/event.c:111
#2  0x00007d2d9562a682 in ucm_event_dispatch (event_type=UCM_EVENT_MADVISE, event=0x7fffa58d4fe0) at event/event.c:145
#3  0x00007d2d9562bbe7 in ucm_madvise (addr=0x12341000, length=4096, advice=11) at event/event.c:476
#4  0x00007d2d95632195 in ucm_override_madvise (arg0=0x12341000, arg1=4096, arg2=11) at util/replace.c:60
#5  0x00007d2c568fbd85 in uct_ib_mlx5_md_buf_free (md=0x122bd310, buf=0x12341000, mem=0x122bd758) at /data/ZYH/ucx-1.18.1/src/uct/ib/mlx5/ib_mlx5.h:1081
#6  0x00007d2c56904638 in uct_ib_mlx5_devx_md_close (tl_md=0x122bd310) at dv/ib_mlx5dv_md.c:2535
#7  0x00007d2d646ace44 in uct_md_close (md=0x122bd310) at base/uct_md.c:76
#8  0x00007d2c9943c8c4 in ucp_add_component_resources (context=0x122a21e0, cmpt_index=7 '\a', avail_devices=0x7fffa58d53a0, avail_tls=0x7fffa58d5320, dev_cfg_masks=0x7fffa58d5380, tl_cfg_mask=0x7fffa58d5248, config=0xab9b810, aux_tls=0x7fffa58d5350) at core/ucp_context.c:1649
#9  0x00007d2c9943d467 in ucp_fill_resources (context=0x122a21e0, config=0xab9b810) at core/ucp_context.c:1822
#10 0x00007d2c9943ef80 in ucp_init_version (api_major_version=1, api_minor_version=18, params=0x7fffa58d5530, config=0xab9b810, context_p=0x1229eff8) at core/ucp_context.c:2299
#11 0x00007d2c99999dbe in ucp_init (params=0x7fffa58d5530, config=0xab9b810, context_p=0x1229eff8) at /data/ZYH/ucx-1.18.1/install/include/ucp/api/ucp.h:2095
#12 0x00007d2c9999a7c9 in c10d::CommUCX::CommUCX (this=0x1229efe8, comm_size=2, logger=...) at /data/ZYH/torch_ucc/src/torch_ucc_comm.cpp:55
#13 0x00007d2c9992efba in c10d::Comm::Comm (this=0x1229efd0, logger_=..., oob_=std::shared_ptr<c10d::torch_ucc_oob_coll_info_t> (use count 4, weak count 0) = {...}, dev=..., is_health_check=false) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:336
#14 0x00007d2c9998dfd0 in std::_Construct<c10d::Comm, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (__p=0x1229efd0) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/stl_construct.h:119
#15 0x00007d2c9998a36c in std::allocator_traits<std::allocator<void> >::construct<c10d::Comm, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (__p=0x1229efd0) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/alloc_traits.h:635
#16 0x00007d2c9998494a in std::_Sp_counted_ptr_inplace<c10d::Comm, std::allocator<void>, (__gnu_cxx::_Lock_policy)2>::_Sp_counted_ptr_inplace<c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (this=0x1229efc0, __a=...) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr_base.h:604
#17 0x00007d2c9997b2d0 in std::__shared_count<(__gnu_cxx::_Lock_policy)2>::__shared_count<c10d::Comm, std::allocator<void>, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (this=0x7fffa58d5c88, __p=@0x7fffa58d5c80: 0x0, __a=...) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr_base.h:971
#18 0x00007d2c9996e535 in std::__shared_ptr<c10d::Comm, (__gnu_cxx::_Lock_policy)2>::__shared_ptr<std::allocator<void>, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (this=0x7fffa58d5c80, __tag=...) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr_base.h:1715
#19 0x00007d2c9995fb42 in std::shared_ptr<c10d::Comm>::shared_ptr<std::allocator<void>, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (this=0x7fffa58d5c80, __tag=...) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr.h:464
#20 0x00007d2c99949448 in std::make_shared<c10d::Comm, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> () at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr.h:1010
#21 0x00007d2c9992fc97 in c10d::Comm::get_comm (id=@0xa9b14f8: 0, dev=..., oob=std::shared_ptr<c10d::torch_ucc_oob_coll_info_t> (use count 4, weak count 0) = {...}, logger=..., is_health_check=false) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:407
#22 0x00007d2c9993e3b2 in c10d::ProcessGroupUCC::initComm (this=0xa9b13a0, dev=...) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:1873
#23 0x00007d2c9993d8d9 in c10d::ProcessGroupUCC::send (this=0xa9b13a0, tensors=std::vector of length 1, capacity 1 = {...}, dstRank=1, tag=0) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:1710
#24 0x00007d2dca343100 in pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}::operator()(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int) const (__closure=0x96f13f8, c=0xa9b13a0, args#0=std::vector of length 1, capacity 1 = {...}, args#1=1, args#2=0) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:136
#25 0x00007d2dca41dc91 in pybind11::detail::argument_loader<c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int>::call_impl<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&, 0ul, 1ul, 2ul, 3ul, pybind11::gil_scoped_release>(pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&, std::integer_sequence<unsigned long, 0ul, 1ul, 2ul, 3ul>, pybind11::gil_scoped_release&&) && (this=0x7fffa58d6340, f=...) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/cast.h:1631
#26 0x00007d2dca3e930e in pybind11::detail::argument_loader<c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int>::call<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, pybind11::gil_scoped_release, pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&>(pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&) && (this=0x7fffa58d6340, f=...) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/cast.h:1600
#27 0x00007d2dca39a925 in pybind11::cpp_function::initialize<pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&&, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (*)(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(pybind11::detail::function_call&)#1}::operator()(pybind11::detail::function_call&) const (__closure=0x0, call=...) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:278
#28 0x00007d2dca39ab46 in pybind11::cpp_function::initialize<pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&&, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (*)(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(pybind11::detail::function_call&)#1}::_FUN(pybind11::detail::function_call&) () at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:249
#29 0x00007d2dc8fe0da1 in pybind11::cpp_function::dispatcher (self=0x7d2c9bc16820, args_in=0x7d2dcbd4c400, kwargs_in=0x0) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:971
#30 0x0000000000528db7 in cfunction_call (func=0x7d2c9bc1b1a0, args=<optimized out>, kwargs=<optimized out>) at /usr/local/src/conda/python-3.11.13/Objects/methodobject.c:542
#31 0x000000000050454c in _PyObject_MakeTpCall (tstate=0x8a9518 <_PyRuntime+166328>, callable=0x7d2c9bc1b1a0, args=<optimized out>, nargs=<optimized out>, keywords=0x0) at /usr/local/src/conda/python-3.11.13/Objects/call.c:214
#32 0x0000000000511cf6 in _PyEval_EvalFrameDefault (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, frame=<optimized out>, frame@entry=0x7d2dcc5831e0, throwflag=throwflag@entry=0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:4769
#33 0x0000000000539503 in _PyEval_EvalFrame (throwflag=0, frame=0x7d2dcc5831e0, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Include/internal/pycore_ceval.h:73
#34 _PyEval_Vector (kwnames=<optimized out>, argcount=1, args=0x7d2d647caa78, locals=0x0, func=<optimized out>, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:6434
#35 _PyFunction_Vectorcall (func=<optimized out>, stack=0x7d2d647caa78, nargsf=<optimized out>, kwnames=<optimized out>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:393
#36 0x000000000054358c in _PyVectorcall_Call (kwargs=<optimized out>, tuple=<optimized out>, callable=0x7d2c9bcd13a0, func=0x539390 <_PyFunction_Vectorcall>, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:257
#37 _PyObject_Call (kwargs=<optimized out>, args=<optimized out>, callable=0x7d2c9bcd13a0, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:328
#38 PyObject_Call (callable=0x7d2c9bcd13a0, args=<optimized out>, kwargs=<optimized out>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:355
#39 0x0000000000515f58 in do_call_core (use_tracing=<optimized out>, kwdict=0x7d2c99b21b80, callargs=0x7d2dcc1be590, func=0x7d2c9bcd13a0, tstate=<optimized out>) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:7349
#40 _PyEval_EvalFrameDefault (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, frame=<optimized out>, frame@entry=0x7d2dcc583020, throwflag=throwflag@entry=0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:5376
#41 0x00000000005cd0aa in _PyEval_EvalFrame (throwflag=0, frame=0x7d2dcc583020, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Include/internal/pycore_ceval.h:73
#42 _PyEval_Vector (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, func=func@entry=0x7d2dcc1d60c0, locals=locals@entry=0x7d2dcc1f69c0, args=args@entry=0x0, argcount=argcount@entry=0, kwnames=kwnames@entry=0x0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:6434
#43 0x00000000005cc77f in PyEval_EvalCode (co=co@entry=0x7d2dcc1c8030, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:1148
#44 0x00000000005ed557 in run_eval_code_obj (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, co=co@entry=0x7d2dcc1c8030, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:1741
#45 0x00000000005e9080 in run_mod (mod=mod@entry=0x5431ae0, filename=filename@entry=0x7d2dcc1ff780, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0, flags=flags@entry=0x7fffa58d6dd8, arena=arena@entry=0x7d2dcc11b670) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:1762
#46 0x00000000005fde72 in pyrun_file (fp=fp@entry=0x53c05a0, filename=filename@entry=0x7d2dcc1ff780, start=start@entry=257, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0, closeit=closeit@entry=1, flags=0x7fffa58d6dd8) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:1657
#47 0x00000000005fd28f in _PyRun_SimpleFileObject (fp=0x53c05a0, filename=0x7d2dcc1ff780, closeit=1, flags=0x7fffa58d6dd8) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:440
#48 0x00000000005fcfb3 in _PyRun_AnyFileObject (fp=0x53c05a0, filename=filename@entry=0x7d2dcc1ff780, closeit=closeit@entry=1, flags=flags@entry=0x7fffa58d6dd8) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:79
#49 0x00000000005f7dae in pymain_run_file_obj (skip_source_first_line=0, filename=0x7d2dcc1ff780, program_name=0x7d2dcc1973b0) at /usr/local/src/conda/python-3.11.13/Modules/main.c:360
---
[HIT] ucm_get_event_handler
#0  ucm_set_event_handler (events=2228224, priority=500, cb=0x7d2d718b2100 <ucs_rcache_unmapped_callback>, arg=0x122b18f0) at event/event.c:573
#1  0x00007d2d718b4c06 in ucs_rcache_t_init (self=0x122b18f0, _myclass=0x7d2d718fa420 <ucs_rcache_t_class>, _init_count=0x7fffa58d535c, params=0x7fffa58d5400, name=0x7d2c99684075 "ucp_rcache", stats_parent=0x7d2d718fa4d8 <ucs_stats_context+88>) at memory/rcache.c:1358
#2  0x00007d2d718b4fb1 in ucs_rcache_create (arg0=0x7fffa58d5400, arg1=0x7d2c99684075 "ucp_rcache", arg2=0x7d2d718fa4d8 <ucs_stats_context+88>, obj_p=0x122a23c0) at memory/rcache.c:1418
#3  0x00007d2c99488309 in ucp_mem_rcache_create (context=0x122a21e0, name=0x7d2c99684075 "ucp_rcache", rcache_p=0x122a23c0, events=1, rcache_params=0x7fffa58d5400) at core/ucp_mm.c:1671
#4  0x00007d2c9948836b in ucp_mem_rcache_init (context=0x122a21e0, rcache_config=0xab9b8e0) at core/ucp_mm.c:1683
#5  0x00007d2c9943efdf in ucp_init_version (api_major_version=1, api_minor_version=18, params=0x7fffa58d5530, config=0xab9b810, context_p=0x1229eff8) at core/ucp_context.c:2308
#6  0x00007d2c99999dbe in ucp_init (params=0x7fffa58d5530, config=0xab9b810, context_p=0x1229eff8) at /data/ZYH/ucx-1.18.1/install/include/ucp/api/ucp.h:2095
#7  0x00007d2c9999a7c9 in c10d::CommUCX::CommUCX (this=0x1229efe8, comm_size=2, logger=...) at /data/ZYH/torch_ucc/src/torch_ucc_comm.cpp:55
#8  0x00007d2c9992efba in c10d::Comm::Comm (this=0x1229efd0, logger_=..., oob_=std::shared_ptr<c10d::torch_ucc_oob_coll_info_t> (use count 4, weak count 0) = {...}, dev=..., is_health_check=false) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:336
#9  0x00007d2c9998dfd0 in std::_Construct<c10d::Comm, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (__p=0x1229efd0) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/stl_construct.h:119
#10 0x00007d2c9998a36c in std::allocator_traits<std::allocator<void> >::construct<c10d::Comm, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (__p=0x1229efd0) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/alloc_traits.h:635
#11 0x00007d2c9998494a in std::_Sp_counted_ptr_inplace<c10d::Comm, std::allocator<void>, (__gnu_cxx::_Lock_policy)2>::_Sp_counted_ptr_inplace<c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (this=0x1229efc0, __a=...) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr_base.h:604
#12 0x00007d2c9997b2d0 in std::__shared_count<(__gnu_cxx::_Lock_policy)2>::__shared_count<c10d::Comm, std::allocator<void>, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (this=0x7fffa58d5c88, __p=@0x7fffa58d5c80: 0x0, __a=...) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr_base.h:971
#13 0x00007d2c9996e535 in std::__shared_ptr<c10d::Comm, (__gnu_cxx::_Lock_policy)2>::__shared_ptr<std::allocator<void>, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (this=0x7fffa58d5c80, __tag=...) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr_base.h:1715
#14 0x00007d2c9995fb42 in std::shared_ptr<c10d::Comm>::shared_ptr<std::allocator<void>, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (this=0x7fffa58d5c80, __tag=...) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr.h:464
#15 0x00007d2c99949448 in std::make_shared<c10d::Comm, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> () at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr.h:1010
#16 0x00007d2c9992fc97 in c10d::Comm::get_comm (id=@0xa9b14f8: 0, dev=..., oob=std::shared_ptr<c10d::torch_ucc_oob_coll_info_t> (use count 4, weak count 0) = {...}, logger=..., is_health_check=false) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:407
#17 0x00007d2c9993e3b2 in c10d::ProcessGroupUCC::initComm (this=0xa9b13a0, dev=...) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:1873
#18 0x00007d2c9993d8d9 in c10d::ProcessGroupUCC::send (this=0xa9b13a0, tensors=std::vector of length 1, capacity 1 = {...}, dstRank=1, tag=0) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:1710
#19 0x00007d2dca343100 in pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}::operator()(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int) const (__closure=0x96f13f8, c=0xa9b13a0, args#0=std::vector of length 1, capacity 1 = {...}, args#1=1, args#2=0) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:136
#20 0x00007d2dca41dc91 in pybind11::detail::argument_loader<c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int>::call_impl<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&, 0ul, 1ul, 2ul, 3ul, pybind11::gil_scoped_release>(pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&, std::integer_sequence<unsigned long, 0ul, 1ul, 2ul, 3ul>, pybind11::gil_scoped_release&&) && (this=0x7fffa58d6340, f=...) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/cast.h:1631
#21 0x00007d2dca3e930e in pybind11::detail::argument_loader<c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int>::call<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, pybind11::gil_scoped_release, pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&>(pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&) && (this=0x7fffa58d6340, f=...) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/cast.h:1600
#22 0x00007d2dca39a925 in pybind11::cpp_function::initialize<pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&&, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (*)(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(pybind11::detail::function_call&)#1}::operator()(pybind11::detail::function_call&) const (__closure=0x0, call=...) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:278
#23 0x00007d2dca39ab46 in pybind11::cpp_function::initialize<pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&&, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (*)(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(pybind11::detail::function_call&)#1}::_FUN(pybind11::detail::function_call&) () at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:249
#24 0x00007d2dc8fe0da1 in pybind11::cpp_function::dispatcher (self=0x7d2c9bc16820, args_in=0x7d2dcbd4c400, kwargs_in=0x0) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:971
#25 0x0000000000528db7 in cfunction_call (func=0x7d2c9bc1b1a0, args=<optimized out>, kwargs=<optimized out>) at /usr/local/src/conda/python-3.11.13/Objects/methodobject.c:542
#26 0x000000000050454c in _PyObject_MakeTpCall (tstate=0x8a9518 <_PyRuntime+166328>, callable=0x7d2c9bc1b1a0, args=<optimized out>, nargs=<optimized out>, keywords=0x0) at /usr/local/src/conda/python-3.11.13/Objects/call.c:214
#27 0x0000000000511cf6 in _PyEval_EvalFrameDefault (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, frame=<optimized out>, frame@entry=0x7d2dcc5831e0, throwflag=throwflag@entry=0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:4769
#28 0x0000000000539503 in _PyEval_EvalFrame (throwflag=0, frame=0x7d2dcc5831e0, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Include/internal/pycore_ceval.h:73
#29 _PyEval_Vector (kwnames=<optimized out>, argcount=1, args=0x7d2d647caa78, locals=0x0, func=<optimized out>, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:6434
#30 _PyFunction_Vectorcall (func=<optimized out>, stack=0x7d2d647caa78, nargsf=<optimized out>, kwnames=<optimized out>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:393
#31 0x000000000054358c in _PyVectorcall_Call (kwargs=<optimized out>, tuple=<optimized out>, callable=0x7d2c9bcd13a0, func=0x539390 <_PyFunction_Vectorcall>, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:257
#32 _PyObject_Call (kwargs=<optimized out>, args=<optimized out>, callable=0x7d2c9bcd13a0, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:328
#33 PyObject_Call (callable=0x7d2c9bcd13a0, args=<optimized out>, kwargs=<optimized out>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:355
#34 0x0000000000515f58 in do_call_core (use_tracing=<optimized out>, kwdict=0x7d2c99b21b80, callargs=0x7d2dcc1be590, func=0x7d2c9bcd13a0, tstate=<optimized out>) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:7349
#35 _PyEval_EvalFrameDefault (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, frame=<optimized out>, frame@entry=0x7d2dcc583020, throwflag=throwflag@entry=0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:5376
#36 0x00000000005cd0aa in _PyEval_EvalFrame (throwflag=0, frame=0x7d2dcc583020, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Include/internal/pycore_ceval.h:73
#37 _PyEval_Vector (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, func=func@entry=0x7d2dcc1d60c0, locals=locals@entry=0x7d2dcc1f69c0, args=args@entry=0x0, argcount=argcount@entry=0, kwnames=kwnames@entry=0x0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:6434
#38 0x00000000005cc77f in PyEval_EvalCode (co=co@entry=0x7d2dcc1c8030, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:1148
#39 0x00000000005ed557 in run_eval_code_obj (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, co=co@entry=0x7d2dcc1c8030, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:1741
#40 0x00000000005e9080 in run_mod (mod=mod@entry=0x5431ae0, filename=filename@entry=0x7d2dcc1ff780, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0, flags=flags@entry=0x7fffa58d6dd8, arena=arena@entry=0x7d2dcc11b670) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:1762
#41 0x00000000005fde72 in pyrun_file (fp=fp@entry=0x53c05a0, filename=filename@entry=0x7d2dcc1ff780, start=start@entry=257, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0, closeit=closeit@entry=1, flags=0x7fffa58d6dd8) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:1657
#42 0x00000000005fd28f in _PyRun_SimpleFileObject (fp=0x53c05a0, filename=0x7d2dcc1ff780, closeit=1, flags=0x7fffa58d6dd8) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:440
#43 0x00000000005fcfb3 in _PyRun_AnyFileObject (fp=0x53c05a0, filename=filename@entry=0x7d2dcc1ff780, closeit=closeit@entry=1, flags=flags@entry=0x7fffa58d6dd8) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:79
#44 0x00000000005f7dae in pymain_run_file_obj (skip_source_first_line=0, filename=0x7d2dcc1ff780, program_name=0x7d2dcc1973b0) at /usr/local/src/conda/python-3.11.13/Modules/main.c:360
#45 pymain_run_file (config=0x88f560 <_PyRuntime+59904>) at /usr/local/src/conda/python-3.11.13/Modules/main.c:379
#46 pymain_run_python (exitcode=0x7fffa58d6dd0) at /usr/local/src/conda/python-3.11.13/Modules/main.c:605
#47 Py_RunMain () at /usr/local/src/conda/python-3.11.13/Modules/main.c:684
#48 0x00000000005bcdf9 in Py_BytesMain (argc=<optimized out>, argv=<optimized out>) at /usr/local/src/conda/python-3.11.13/Modules/main.c:738
#49 0x00007d2dcc22a1ca in __libc_start_call_main (main=main@entry=0x5bcd50 <main>, argc=argc@entry=3, argv=argv@entry=0x7fffa58d7038) at ../sysdeps/nptl/libc_start_call_main.h:58
---
[HIT] ucm_mremap
#0  ucm_mremap (old_address=0x7d2dcb6e1000, old_size=4096, new_size=8192, flags=1) at event/event.c:253
#1  0x00007d2d95631ea1 in ucm_override_mremap (arg0=0x7d2dcb6e1000, arg1=4096, arg2=8192, arg3=1, arg4=0x7d2d9564bf00 <ucm_event_lock>) at util/replace.c:53
#2  0x00007d2d9562fd61 in ucm_fire_mmap_events_internal (events=131327, data=0x7fffa58d5134, exclusive=0) at mmap/install.c:168
#3  0x00007d2d95630d76 in ucm_mmap_test_events_nolock (events=131327, exclusive=0, event_type=0x7d2d9564531b "existing") at mmap/install.c:295
#4  0x00007d2d95631529 in ucm_mmap_install (events=2228224, exclusive=0) at mmap/install.c:426
#5  0x00007d2d9562bdd7 in ucm_event_install (events=2228224) at event/event.c:532
#6  0x00007d2d9562c027 in ucm_set_event_handler (events=2228224, priority=500, cb=0x7d2d718b2100 <ucs_rcache_unmapped_callback>, arg=0x122b18f0) at event/event.c:596
#7  0x00007d2d718b4c06 in ucs_rcache_t_init (self=0x122b18f0, _myclass=0x7d2d718fa420 <ucs_rcache_t_class>, _init_count=0x7fffa58d535c, params=0x7fffa58d5400, name=0x7d2c99684075 "ucp_rcache", stats_parent=0x7d2d718fa4d8 <ucs_stats_context+88>) at memory/rcache.c:1358
#8  0x00007d2d718b4fb1 in ucs_rcache_create (arg0=0x7fffa58d5400, arg1=0x7d2c99684075 "ucp_rcache", arg2=0x7d2d718fa4d8 <ucs_stats_context+88>, obj_p=0x122a23c0) at memory/rcache.c:1418
#9  0x00007d2c99488309 in ucp_mem_rcache_create (context=0x122a21e0, name=0x7d2c99684075 "ucp_rcache", rcache_p=0x122a23c0, events=1, rcache_params=0x7fffa58d5400) at core/ucp_mm.c:1671
#10 0x00007d2c9948836b in ucp_mem_rcache_init (context=0x122a21e0, rcache_config=0xab9b8e0) at core/ucp_mm.c:1683
#11 0x00007d2c9943efdf in ucp_init_version (api_major_version=1, api_minor_version=18, params=0x7fffa58d5530, config=0xab9b810, context_p=0x1229eff8) at core/ucp_context.c:2308
#12 0x00007d2c99999dbe in ucp_init (params=0x7fffa58d5530, config=0xab9b810, context_p=0x1229eff8) at /data/ZYH/ucx-1.18.1/install/include/ucp/api/ucp.h:2095
#13 0x00007d2c9999a7c9 in c10d::CommUCX::CommUCX (this=0x1229efe8, comm_size=2, logger=...) at /data/ZYH/torch_ucc/src/torch_ucc_comm.cpp:55
#14 0x00007d2c9992efba in c10d::Comm::Comm (this=0x1229efd0, logger_=..., oob_=std::shared_ptr<c10d::torch_ucc_oob_coll_info_t> (use count 4, weak count 0) = {...}, dev=..., is_health_check=false) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:336
#15 0x00007d2c9998dfd0 in std::_Construct<c10d::Comm, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (__p=0x1229efd0) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/stl_construct.h:119
#16 0x00007d2c9998a36c in std::allocator_traits<std::allocator<void> >::construct<c10d::Comm, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (__p=0x1229efd0) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/alloc_traits.h:635
#17 0x00007d2c9998494a in std::_Sp_counted_ptr_inplace<c10d::Comm, std::allocator<void>, (__gnu_cxx::_Lock_policy)2>::_Sp_counted_ptr_inplace<c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (this=0x1229efc0, __a=...) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr_base.h:604
#18 0x00007d2c9997b2d0 in std::__shared_count<(__gnu_cxx::_Lock_policy)2>::__shared_count<c10d::Comm, std::allocator<void>, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (this=0x7fffa58d5c88, __p=@0x7fffa58d5c80: 0x0, __a=...) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr_base.h:971
#19 0x00007d2c9996e535 in std::__shared_ptr<c10d::Comm, (__gnu_cxx::_Lock_policy)2>::__shared_ptr<std::allocator<void>, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (this=0x7fffa58d5c80, __tag=...) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr_base.h:1715
#20 0x00007d2c9995fb42 in std::shared_ptr<c10d::Comm>::shared_ptr<std::allocator<void>, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (this=0x7fffa58d5c80, __tag=...) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr.h:464
#21 0x00007d2c99949448 in std::make_shared<c10d::Comm, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> () at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr.h:1010
#22 0x00007d2c9992fc97 in c10d::Comm::get_comm (id=@0xa9b14f8: 0, dev=..., oob=std::shared_ptr<c10d::torch_ucc_oob_coll_info_t> (use count 4, weak count 0) = {...}, logger=..., is_health_check=false) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:407
#23 0x00007d2c9993e3b2 in c10d::ProcessGroupUCC::initComm (this=0xa9b13a0, dev=...) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:1873
#24 0x00007d2c9993d8d9 in c10d::ProcessGroupUCC::send (this=0xa9b13a0, tensors=std::vector of length 1, capacity 1 = {...}, dstRank=1, tag=0) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:1710
#25 0x00007d2dca343100 in pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}::operator()(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int) const (__closure=0x96f13f8, c=0xa9b13a0, args#0=std::vector of length 1, capacity 1 = {...}, args#1=1, args#2=0) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:136
#26 0x00007d2dca41dc91 in pybind11::detail::argument_loader<c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int>::call_impl<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&, 0ul, 1ul, 2ul, 3ul, pybind11::gil_scoped_release>(pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&, std::integer_sequence<unsigned long, 0ul, 1ul, 2ul, 3ul>, pybind11::gil_scoped_release&&) && (this=0x7fffa58d6340, f=...) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/cast.h:1631
#27 0x00007d2dca3e930e in pybind11::detail::argument_loader<c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int>::call<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, pybind11::gil_scoped_release, pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&>(pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&) && (this=0x7fffa58d6340, f=...) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/cast.h:1600
#28 0x00007d2dca39a925 in pybind11::cpp_function::initialize<pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&&, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (*)(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(pybind11::detail::function_call&)#1}::operator()(pybind11::detail::function_call&) const (__closure=0x0, call=...) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:278
#29 0x00007d2dca39ab46 in pybind11::cpp_function::initialize<pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&&, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (*)(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(pybind11::detail::function_call&)#1}::_FUN(pybind11::detail::function_call&) () at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:249
#30 0x00007d2dc8fe0da1 in pybind11::cpp_function::dispatcher (self=0x7d2c9bc16820, args_in=0x7d2dcbd4c400, kwargs_in=0x0) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:971
#31 0x0000000000528db7 in cfunction_call (func=0x7d2c9bc1b1a0, args=<optimized out>, kwargs=<optimized out>) at /usr/local/src/conda/python-3.11.13/Objects/methodobject.c:542
#32 0x000000000050454c in _PyObject_MakeTpCall (tstate=0x8a9518 <_PyRuntime+166328>, callable=0x7d2c9bc1b1a0, args=<optimized out>, nargs=<optimized out>, keywords=0x0) at /usr/local/src/conda/python-3.11.13/Objects/call.c:214
#33 0x0000000000511cf6 in _PyEval_EvalFrameDefault (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, frame=<optimized out>, frame@entry=0x7d2dcc5831e0, throwflag=throwflag@entry=0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:4769
#34 0x0000000000539503 in _PyEval_EvalFrame (throwflag=0, frame=0x7d2dcc5831e0, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Include/internal/pycore_ceval.h:73
#35 _PyEval_Vector (kwnames=<optimized out>, argcount=1, args=0x7d2d647caa78, locals=0x0, func=<optimized out>, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:6434
#36 _PyFunction_Vectorcall (func=<optimized out>, stack=0x7d2d647caa78, nargsf=<optimized out>, kwnames=<optimized out>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:393
#37 0x000000000054358c in _PyVectorcall_Call (kwargs=<optimized out>, tuple=<optimized out>, callable=0x7d2c9bcd13a0, func=0x539390 <_PyFunction_Vectorcall>, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:257
#38 _PyObject_Call (kwargs=<optimized out>, args=<optimized out>, callable=0x7d2c9bcd13a0, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:328
#39 PyObject_Call (callable=0x7d2c9bcd13a0, args=<optimized out>, kwargs=<optimized out>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:355
#40 0x0000000000515f58 in do_call_core (use_tracing=<optimized out>, kwdict=0x7d2c99b21b80, callargs=0x7d2dcc1be590, func=0x7d2c9bcd13a0, tstate=<optimized out>) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:7349
#41 _PyEval_EvalFrameDefault (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, frame=<optimized out>, frame@entry=0x7d2dcc583020, throwflag=throwflag@entry=0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:5376
#42 0x00000000005cd0aa in _PyEval_EvalFrame (throwflag=0, frame=0x7d2dcc583020, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Include/internal/pycore_ceval.h:73
#43 _PyEval_Vector (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, func=func@entry=0x7d2dcc1d60c0, locals=locals@entry=0x7d2dcc1f69c0, args=args@entry=0x0, argcount=argcount@entry=0, kwnames=kwnames@entry=0x0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:6434
#44 0x00000000005cc77f in PyEval_EvalCode (co=co@entry=0x7d2dcc1c8030, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:1148
#45 0x00000000005ed557 in run_eval_code_obj (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, co=co@entry=0x7d2dcc1c8030, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:1741
#46 0x00000000005e9080 in run_mod (mod=mod@entry=0x5431ae0, filename=filename@entry=0x7d2dcc1ff780, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0, flags=flags@entry=0x7fffa58d6dd8, arena=arena@entry=0x7d2dcc11b670) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:1762
#47 0x00000000005fde72 in pyrun_file (fp=fp@entry=0x53c05a0, filename=filename@entry=0x7d2dcc1ff780, start=start@entry=257, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0, closeit=closeit@entry=1, flags=0x7fffa58d6dd8) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:1657
#48 0x00000000005fd28f in _PyRun_SimpleFileObject (fp=0x53c05a0, filename=0x7d2dcc1ff780, closeit=1, flags=0x7fffa58d6dd8) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:440
#49 0x00000000005fcfb3 in _PyRun_AnyFileObject (fp=0x53c05a0, filename=filename@entry=0x7d2dcc1ff780, closeit=closeit@entry=1, flags=flags@entry=0x7fffa58d6dd8) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:79
---
[HIT] ucm_orig_mremap
#0  ucm_orig_mremap (arg0=0x7d2dcb6e1000, arg1=4096, arg2=8192, arg3=1, arg4=0x0) at util/replace.c:65
#1  0x00007d2d9562a4d1 in ucm_event_call_orig (event_type=UCM_EVENT_MREMAP, event=0x7fffa58d4ec0, arg=0x0) at event/event.c:80
#2  0x00007d2d9562a682 in ucm_event_dispatch (event_type=UCM_EVENT_MREMAP, event=0x7fffa58d4ec0) at event/event.c:145
#3  0x00007d2d9562b02b in ucm_mremap (old_address=0x7d2dcb6e1000, old_size=4096, new_size=8192, flags=1) at event/event.c:277
#4  0x00007d2d95631ea1 in ucm_override_mremap (arg0=0x7d2dcb6e1000, arg1=4096, arg2=8192, arg3=1, arg4=0x7d2d9564bf00 <ucm_event_lock>) at util/replace.c:53
#5  0x00007d2d9562fd61 in ucm_fire_mmap_events_internal (events=131327, data=0x7fffa58d5134, exclusive=0) at mmap/install.c:168
#6  0x00007d2d95630d76 in ucm_mmap_test_events_nolock (events=131327, exclusive=0, event_type=0x7d2d9564531b "existing") at mmap/install.c:295
#7  0x00007d2d95631529 in ucm_mmap_install (events=2228224, exclusive=0) at mmap/install.c:426
#8  0x00007d2d9562bdd7 in ucm_event_install (events=2228224) at event/event.c:532
#9  0x00007d2d9562c027 in ucm_set_event_handler (events=2228224, priority=500, cb=0x7d2d718b2100 <ucs_rcache_unmapped_callback>, arg=0x122b18f0) at event/event.c:596
#10 0x00007d2d718b4c06 in ucs_rcache_t_init (self=0x122b18f0, _myclass=0x7d2d718fa420 <ucs_rcache_t_class>, _init_count=0x7fffa58d535c, params=0x7fffa58d5400, name=0x7d2c99684075 "ucp_rcache", stats_parent=0x7d2d718fa4d8 <ucs_stats_context+88>) at memory/rcache.c:1358
#11 0x00007d2d718b4fb1 in ucs_rcache_create (arg0=0x7fffa58d5400, arg1=0x7d2c99684075 "ucp_rcache", arg2=0x7d2d718fa4d8 <ucs_stats_context+88>, obj_p=0x122a23c0) at memory/rcache.c:1418
#12 0x00007d2c99488309 in ucp_mem_rcache_create (context=0x122a21e0, name=0x7d2c99684075 "ucp_rcache", rcache_p=0x122a23c0, events=1, rcache_params=0x7fffa58d5400) at core/ucp_mm.c:1671
#13 0x00007d2c9948836b in ucp_mem_rcache_init (context=0x122a21e0, rcache_config=0xab9b8e0) at core/ucp_mm.c:1683
#14 0x00007d2c9943efdf in ucp_init_version (api_major_version=1, api_minor_version=18, params=0x7fffa58d5530, config=0xab9b810, context_p=0x1229eff8) at core/ucp_context.c:2308
#15 0x00007d2c99999dbe in ucp_init (params=0x7fffa58d5530, config=0xab9b810, context_p=0x1229eff8) at /data/ZYH/ucx-1.18.1/install/include/ucp/api/ucp.h:2095
#16 0x00007d2c9999a7c9 in c10d::CommUCX::CommUCX (this=0x1229efe8, comm_size=2, logger=...) at /data/ZYH/torch_ucc/src/torch_ucc_comm.cpp:55
#17 0x00007d2c9992efba in c10d::Comm::Comm (this=0x1229efd0, logger_=..., oob_=std::shared_ptr<c10d::torch_ucc_oob_coll_info_t> (use count 4, weak count 0) = {...}, dev=..., is_health_check=false) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:336
#18 0x00007d2c9998dfd0 in std::_Construct<c10d::Comm, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (__p=0x1229efd0) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/stl_construct.h:119
#19 0x00007d2c9998a36c in std::allocator_traits<std::allocator<void> >::construct<c10d::Comm, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (__p=0x1229efd0) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/alloc_traits.h:635
#20 0x00007d2c9998494a in std::_Sp_counted_ptr_inplace<c10d::Comm, std::allocator<void>, (__gnu_cxx::_Lock_policy)2>::_Sp_counted_ptr_inplace<c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (this=0x1229efc0, __a=...) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr_base.h:604
#21 0x00007d2c9997b2d0 in std::__shared_count<(__gnu_cxx::_Lock_policy)2>::__shared_count<c10d::Comm, std::allocator<void>, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (this=0x7fffa58d5c88, __p=@0x7fffa58d5c80: 0x0, __a=...) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr_base.h:971
#22 0x00007d2c9996e535 in std::__shared_ptr<c10d::Comm, (__gnu_cxx::_Lock_policy)2>::__shared_ptr<std::allocator<void>, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (this=0x7fffa58d5c80, __tag=...) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr_base.h:1715
#23 0x00007d2c9995fb42 in std::shared_ptr<c10d::Comm>::shared_ptr<std::allocator<void>, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (this=0x7fffa58d5c80, __tag=...) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr.h:464
#24 0x00007d2c99949448 in std::make_shared<c10d::Comm, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> () at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr.h:1010
#25 0x00007d2c9992fc97 in c10d::Comm::get_comm (id=@0xa9b14f8: 0, dev=..., oob=std::shared_ptr<c10d::torch_ucc_oob_coll_info_t> (use count 4, weak count 0) = {...}, logger=..., is_health_check=false) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:407
#26 0x00007d2c9993e3b2 in c10d::ProcessGroupUCC::initComm (this=0xa9b13a0, dev=...) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:1873
#27 0x00007d2c9993d8d9 in c10d::ProcessGroupUCC::send (this=0xa9b13a0, tensors=std::vector of length 1, capacity 1 = {...}, dstRank=1, tag=0) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:1710
#28 0x00007d2dca343100 in pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}::operator()(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int) const (__closure=0x96f13f8, c=0xa9b13a0, args#0=std::vector of length 1, capacity 1 = {...}, args#1=1, args#2=0) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:136
#29 0x00007d2dca41dc91 in pybind11::detail::argument_loader<c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int>::call_impl<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&, 0ul, 1ul, 2ul, 3ul, pybind11::gil_scoped_release>(pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&, std::integer_sequence<unsigned long, 0ul, 1ul, 2ul, 3ul>, pybind11::gil_scoped_release&&) && (this=0x7fffa58d6340, f=...) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/cast.h:1631
#30 0x00007d2dca3e930e in pybind11::detail::argument_loader<c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int>::call<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, pybind11::gil_scoped_release, pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&>(pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&) && (this=0x7fffa58d6340, f=...) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/cast.h:1600
#31 0x00007d2dca39a925 in pybind11::cpp_function::initialize<pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&&, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (*)(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(pybind11::detail::function_call&)#1}::operator()(pybind11::detail::function_call&) const (__closure=0x0, call=...) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:278
#32 0x00007d2dca39ab46 in pybind11::cpp_function::initialize<pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&&, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (*)(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(pybind11::detail::function_call&)#1}::_FUN(pybind11::detail::function_call&) () at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:249
#33 0x00007d2dc8fe0da1 in pybind11::cpp_function::dispatcher (self=0x7d2c9bc16820, args_in=0x7d2dcbd4c400, kwargs_in=0x0) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:971
#34 0x0000000000528db7 in cfunction_call (func=0x7d2c9bc1b1a0, args=<optimized out>, kwargs=<optimized out>) at /usr/local/src/conda/python-3.11.13/Objects/methodobject.c:542
#35 0x000000000050454c in _PyObject_MakeTpCall (tstate=0x8a9518 <_PyRuntime+166328>, callable=0x7d2c9bc1b1a0, args=<optimized out>, nargs=<optimized out>, keywords=0x0) at /usr/local/src/conda/python-3.11.13/Objects/call.c:214
#36 0x0000000000511cf6 in _PyEval_EvalFrameDefault (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, frame=<optimized out>, frame@entry=0x7d2dcc5831e0, throwflag=throwflag@entry=0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:4769
#37 0x0000000000539503 in _PyEval_EvalFrame (throwflag=0, frame=0x7d2dcc5831e0, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Include/internal/pycore_ceval.h:73
#38 _PyEval_Vector (kwnames=<optimized out>, argcount=1, args=0x7d2d647caa78, locals=0x0, func=<optimized out>, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:6434
#39 _PyFunction_Vectorcall (func=<optimized out>, stack=0x7d2d647caa78, nargsf=<optimized out>, kwnames=<optimized out>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:393
#40 0x000000000054358c in _PyVectorcall_Call (kwargs=<optimized out>, tuple=<optimized out>, callable=0x7d2c9bcd13a0, func=0x539390 <_PyFunction_Vectorcall>, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:257
#41 _PyObject_Call (kwargs=<optimized out>, args=<optimized out>, callable=0x7d2c9bcd13a0, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:328
#42 PyObject_Call (callable=0x7d2c9bcd13a0, args=<optimized out>, kwargs=<optimized out>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:355
#43 0x0000000000515f58 in do_call_core (use_tracing=<optimized out>, kwdict=0x7d2c99b21b80, callargs=0x7d2dcc1be590, func=0x7d2c9bcd13a0, tstate=<optimized out>) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:7349
#44 _PyEval_EvalFrameDefault (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, frame=<optimized out>, frame@entry=0x7d2dcc583020, throwflag=throwflag@entry=0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:5376
#45 0x00000000005cd0aa in _PyEval_EvalFrame (throwflag=0, frame=0x7d2dcc583020, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Include/internal/pycore_ceval.h:73
#46 _PyEval_Vector (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, func=func@entry=0x7d2dcc1d60c0, locals=locals@entry=0x7d2dcc1f69c0, args=args@entry=0x0, argcount=argcount@entry=0, kwnames=kwnames@entry=0x0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:6434
#47 0x00000000005cc77f in PyEval_EvalCode (co=co@entry=0x7d2dcc1c8030, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:1148
#48 0x00000000005ed557 in run_eval_code_obj (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, co=co@entry=0x7d2dcc1c8030, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:1741
#49 0x00000000005e9080 in run_mod (mod=mod@entry=0x5431ae0, filename=filename@entry=0x7d2dcc1ff780, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0, flags=flags@entry=0x7fffa58d6dd8, arena=arena@entry=0x7d2dcc11b670) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:1762
---
[HIT] ucm_shmat
#0  ucm_shmat (shmid=32799, shmaddr=0x0, shmflg=0) at event/event.c:310
#1  0x00007d2d95631f42 in ucm_override_shmat (arg0=32799, arg1=0x0, arg2=0) at util/replace.c:56
#2  0x00007d2d9563011f in ucm_fire_mmap_events_internal (events=131327, data=0x7fffa58d5134, exclusive=0) at mmap/install.c:190
#3  0x00007d2d95630d76 in ucm_mmap_test_events_nolock (events=131327, exclusive=0, event_type=0x7d2d9564531b "existing") at mmap/install.c:295
#4  0x00007d2d95631529 in ucm_mmap_install (events=2228224, exclusive=0) at mmap/install.c:426
#5  0x00007d2d9562bdd7 in ucm_event_install (events=2228224) at event/event.c:532
#6  0x00007d2d9562c027 in ucm_set_event_handler (events=2228224, priority=500, cb=0x7d2d718b2100 <ucs_rcache_unmapped_callback>, arg=0x122b18f0) at event/event.c:596
#7  0x00007d2d718b4c06 in ucs_rcache_t_init (self=0x122b18f0, _myclass=0x7d2d718fa420 <ucs_rcache_t_class>, _init_count=0x7fffa58d535c, params=0x7fffa58d5400, name=0x7d2c99684075 "ucp_rcache", stats_parent=0x7d2d718fa4d8 <ucs_stats_context+88>) at memory/rcache.c:1358
#8  0x00007d2d718b4fb1 in ucs_rcache_create (arg0=0x7fffa58d5400, arg1=0x7d2c99684075 "ucp_rcache", arg2=0x7d2d718fa4d8 <ucs_stats_context+88>, obj_p=0x122a23c0) at memory/rcache.c:1418
#9  0x00007d2c99488309 in ucp_mem_rcache_create (context=0x122a21e0, name=0x7d2c99684075 "ucp_rcache", rcache_p=0x122a23c0, events=1, rcache_params=0x7fffa58d5400) at core/ucp_mm.c:1671
#10 0x00007d2c9948836b in ucp_mem_rcache_init (context=0x122a21e0, rcache_config=0xab9b8e0) at core/ucp_mm.c:1683
#11 0x00007d2c9943efdf in ucp_init_version (api_major_version=1, api_minor_version=18, params=0x7fffa58d5530, config=0xab9b810, context_p=0x1229eff8) at core/ucp_context.c:2308
#12 0x00007d2c99999dbe in ucp_init (params=0x7fffa58d5530, config=0xab9b810, context_p=0x1229eff8) at /data/ZYH/ucx-1.18.1/install/include/ucp/api/ucp.h:2095
#13 0x00007d2c9999a7c9 in c10d::CommUCX::CommUCX (this=0x1229efe8, comm_size=2, logger=...) at /data/ZYH/torch_ucc/src/torch_ucc_comm.cpp:55
#14 0x00007d2c9992efba in c10d::Comm::Comm (this=0x1229efd0, logger_=..., oob_=std::shared_ptr<c10d::torch_ucc_oob_coll_info_t> (use count 4, weak count 0) = {...}, dev=..., is_health_check=false) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:336
#15 0x00007d2c9998dfd0 in std::_Construct<c10d::Comm, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (__p=0x1229efd0) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/stl_construct.h:119
#16 0x00007d2c9998a36c in std::allocator_traits<std::allocator<void> >::construct<c10d::Comm, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (__p=0x1229efd0) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/alloc_traits.h:635
#17 0x00007d2c9998494a in std::_Sp_counted_ptr_inplace<c10d::Comm, std::allocator<void>, (__gnu_cxx::_Lock_policy)2>::_Sp_counted_ptr_inplace<c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (this=0x1229efc0, __a=...) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr_base.h:604
#18 0x00007d2c9997b2d0 in std::__shared_count<(__gnu_cxx::_Lock_policy)2>::__shared_count<c10d::Comm, std::allocator<void>, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (this=0x7fffa58d5c88, __p=@0x7fffa58d5c80: 0x0, __a=...) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr_base.h:971
#19 0x00007d2c9996e535 in std::__shared_ptr<c10d::Comm, (__gnu_cxx::_Lock_policy)2>::__shared_ptr<std::allocator<void>, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (this=0x7fffa58d5c80, __tag=...) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr_base.h:1715
#20 0x00007d2c9995fb42 in std::shared_ptr<c10d::Comm>::shared_ptr<std::allocator<void>, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (this=0x7fffa58d5c80, __tag=...) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr.h:464
#21 0x00007d2c99949448 in std::make_shared<c10d::Comm, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> () at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr.h:1010
#22 0x00007d2c9992fc97 in c10d::Comm::get_comm (id=@0xa9b14f8: 0, dev=..., oob=std::shared_ptr<c10d::torch_ucc_oob_coll_info_t> (use count 4, weak count 0) = {...}, logger=..., is_health_check=false) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:407
#23 0x00007d2c9993e3b2 in c10d::ProcessGroupUCC::initComm (this=0xa9b13a0, dev=...) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:1873
#24 0x00007d2c9993d8d9 in c10d::ProcessGroupUCC::send (this=0xa9b13a0, tensors=std::vector of length 1, capacity 1 = {...}, dstRank=1, tag=0) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:1710
#25 0x00007d2dca343100 in pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}::operator()(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int) const (__closure=0x96f13f8, c=0xa9b13a0, args#0=std::vector of length 1, capacity 1 = {...}, args#1=1, args#2=0) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:136
#26 0x00007d2dca41dc91 in pybind11::detail::argument_loader<c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int>::call_impl<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&, 0ul, 1ul, 2ul, 3ul, pybind11::gil_scoped_release>(pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&, std::integer_sequence<unsigned long, 0ul, 1ul, 2ul, 3ul>, pybind11::gil_scoped_release&&) && (this=0x7fffa58d6340, f=...) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/cast.h:1631
#27 0x00007d2dca3e930e in pybind11::detail::argument_loader<c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int>::call<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, pybind11::gil_scoped_release, pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&>(pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&) && (this=0x7fffa58d6340, f=...) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/cast.h:1600
#28 0x00007d2dca39a925 in pybind11::cpp_function::initialize<pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&&, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (*)(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(pybind11::detail::function_call&)#1}::operator()(pybind11::detail::function_call&) const (__closure=0x0, call=...) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:278
#29 0x00007d2dca39ab46 in pybind11::cpp_function::initialize<pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&&, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (*)(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(pybind11::detail::function_call&)#1}::_FUN(pybind11::detail::function_call&) () at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:249
#30 0x00007d2dc8fe0da1 in pybind11::cpp_function::dispatcher (self=0x7d2c9bc16820, args_in=0x7d2dcbd4c400, kwargs_in=0x0) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:971
#31 0x0000000000528db7 in cfunction_call (func=0x7d2c9bc1b1a0, args=<optimized out>, kwargs=<optimized out>) at /usr/local/src/conda/python-3.11.13/Objects/methodobject.c:542
#32 0x000000000050454c in _PyObject_MakeTpCall (tstate=0x8a9518 <_PyRuntime+166328>, callable=0x7d2c9bc1b1a0, args=<optimized out>, nargs=<optimized out>, keywords=0x0) at /usr/local/src/conda/python-3.11.13/Objects/call.c:214
#33 0x0000000000511cf6 in _PyEval_EvalFrameDefault (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, frame=<optimized out>, frame@entry=0x7d2dcc5831e0, throwflag=throwflag@entry=0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:4769
#34 0x0000000000539503 in _PyEval_EvalFrame (throwflag=0, frame=0x7d2dcc5831e0, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Include/internal/pycore_ceval.h:73
#35 _PyEval_Vector (kwnames=<optimized out>, argcount=1, args=0x7d2d647caa78, locals=0x0, func=<optimized out>, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:6434
#36 _PyFunction_Vectorcall (func=<optimized out>, stack=0x7d2d647caa78, nargsf=<optimized out>, kwnames=<optimized out>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:393
#37 0x000000000054358c in _PyVectorcall_Call (kwargs=<optimized out>, tuple=<optimized out>, callable=0x7d2c9bcd13a0, func=0x539390 <_PyFunction_Vectorcall>, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:257
#38 _PyObject_Call (kwargs=<optimized out>, args=<optimized out>, callable=0x7d2c9bcd13a0, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:328
#39 PyObject_Call (callable=0x7d2c9bcd13a0, args=<optimized out>, kwargs=<optimized out>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:355
#40 0x0000000000515f58 in do_call_core (use_tracing=<optimized out>, kwdict=0x7d2c99b21b80, callargs=0x7d2dcc1be590, func=0x7d2c9bcd13a0, tstate=<optimized out>) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:7349
#41 _PyEval_EvalFrameDefault (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, frame=<optimized out>, frame@entry=0x7d2dcc583020, throwflag=throwflag@entry=0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:5376
#42 0x00000000005cd0aa in _PyEval_EvalFrame (throwflag=0, frame=0x7d2dcc583020, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Include/internal/pycore_ceval.h:73
#43 _PyEval_Vector (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, func=func@entry=0x7d2dcc1d60c0, locals=locals@entry=0x7d2dcc1f69c0, args=args@entry=0x0, argcount=argcount@entry=0, kwnames=kwnames@entry=0x0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:6434
#44 0x00000000005cc77f in PyEval_EvalCode (co=co@entry=0x7d2dcc1c8030, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:1148
#45 0x00000000005ed557 in run_eval_code_obj (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, co=co@entry=0x7d2dcc1c8030, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:1741
#46 0x00000000005e9080 in run_mod (mod=mod@entry=0x5431ae0, filename=filename@entry=0x7d2dcc1ff780, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0, flags=flags@entry=0x7fffa58d6dd8, arena=arena@entry=0x7d2dcc11b670) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:1762
#47 0x00000000005fde72 in pyrun_file (fp=fp@entry=0x53c05a0, filename=filename@entry=0x7d2dcc1ff780, start=start@entry=257, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0, closeit=closeit@entry=1, flags=0x7fffa58d6dd8) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:1657
#48 0x00000000005fd28f in _PyRun_SimpleFileObject (fp=0x53c05a0, filename=0x7d2dcc1ff780, closeit=1, flags=0x7fffa58d6dd8) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:440
#49 0x00000000005fcfb3 in _PyRun_AnyFileObject (fp=0x53c05a0, filename=filename@entry=0x7d2dcc1ff780, closeit=closeit@entry=1, flags=flags@entry=0x7fffa58d6dd8) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:79
---
[HIT] ucm_orig_shmat
#0  ucm_orig_shmat (arg0=32799, arg1=0x0, arg2=0) at util/replace.c:73
#1  0x00007d2d9562a50e in ucm_event_call_orig (event_type=UCM_EVENT_SHMAT, event=0x7fffa58d4fa0, arg=0x0) at event/event.c:89
#2  0x00007d2d9562a682 in ucm_event_dispatch (event_type=UCM_EVENT_SHMAT, event=0x7fffa58d4fa0) at event/event.c:145
#3  0x00007d2d9562b39c in ucm_shmat (shmid=32799, shmaddr=0x0, shmflg=0) at event/event.c:341
#4  0x00007d2d95631f42 in ucm_override_shmat (arg0=32799, arg1=0x0, arg2=0) at util/replace.c:56
#5  0x00007d2d9563011f in ucm_fire_mmap_events_internal (events=131327, data=0x7fffa58d5134, exclusive=0) at mmap/install.c:190
#6  0x00007d2d95630d76 in ucm_mmap_test_events_nolock (events=131327, exclusive=0, event_type=0x7d2d9564531b "existing") at mmap/install.c:295
#7  0x00007d2d95631529 in ucm_mmap_install (events=2228224, exclusive=0) at mmap/install.c:426
#8  0x00007d2d9562bdd7 in ucm_event_install (events=2228224) at event/event.c:532
#9  0x00007d2d9562c027 in ucm_set_event_handler (events=2228224, priority=500, cb=0x7d2d718b2100 <ucs_rcache_unmapped_callback>, arg=0x122b18f0) at event/event.c:596
#10 0x00007d2d718b4c06 in ucs_rcache_t_init (self=0x122b18f0, _myclass=0x7d2d718fa420 <ucs_rcache_t_class>, _init_count=0x7fffa58d535c, params=0x7fffa58d5400, name=0x7d2c99684075 "ucp_rcache", stats_parent=0x7d2d718fa4d8 <ucs_stats_context+88>) at memory/rcache.c:1358
#11 0x00007d2d718b4fb1 in ucs_rcache_create (arg0=0x7fffa58d5400, arg1=0x7d2c99684075 "ucp_rcache", arg2=0x7d2d718fa4d8 <ucs_stats_context+88>, obj_p=0x122a23c0) at memory/rcache.c:1418
#12 0x00007d2c99488309 in ucp_mem_rcache_create (context=0x122a21e0, name=0x7d2c99684075 "ucp_rcache", rcache_p=0x122a23c0, events=1, rcache_params=0x7fffa58d5400) at core/ucp_mm.c:1671
#13 0x00007d2c9948836b in ucp_mem_rcache_init (context=0x122a21e0, rcache_config=0xab9b8e0) at core/ucp_mm.c:1683
#14 0x00007d2c9943efdf in ucp_init_version (api_major_version=1, api_minor_version=18, params=0x7fffa58d5530, config=0xab9b810, context_p=0x1229eff8) at core/ucp_context.c:2308
#15 0x00007d2c99999dbe in ucp_init (params=0x7fffa58d5530, config=0xab9b810, context_p=0x1229eff8) at /data/ZYH/ucx-1.18.1/install/include/ucp/api/ucp.h:2095
#16 0x00007d2c9999a7c9 in c10d::CommUCX::CommUCX (this=0x1229efe8, comm_size=2, logger=...) at /data/ZYH/torch_ucc/src/torch_ucc_comm.cpp:55
#17 0x00007d2c9992efba in c10d::Comm::Comm (this=0x1229efd0, logger_=..., oob_=std::shared_ptr<c10d::torch_ucc_oob_coll_info_t> (use count 4, weak count 0) = {...}, dev=..., is_health_check=false) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:336
#18 0x00007d2c9998dfd0 in std::_Construct<c10d::Comm, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (__p=0x1229efd0) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/stl_construct.h:119
#19 0x00007d2c9998a36c in std::allocator_traits<std::allocator<void> >::construct<c10d::Comm, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (__p=0x1229efd0) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/alloc_traits.h:635
#20 0x00007d2c9998494a in std::_Sp_counted_ptr_inplace<c10d::Comm, std::allocator<void>, (__gnu_cxx::_Lock_policy)2>::_Sp_counted_ptr_inplace<c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (this=0x1229efc0, __a=...) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr_base.h:604
#21 0x00007d2c9997b2d0 in std::__shared_count<(__gnu_cxx::_Lock_policy)2>::__shared_count<c10d::Comm, std::allocator<void>, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (this=0x7fffa58d5c88, __p=@0x7fffa58d5c80: 0x0, __a=...) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr_base.h:971
#22 0x00007d2c9996e535 in std::__shared_ptr<c10d::Comm, (__gnu_cxx::_Lock_policy)2>::__shared_ptr<std::allocator<void>, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (this=0x7fffa58d5c80, __tag=...) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr_base.h:1715
#23 0x00007d2c9995fb42 in std::shared_ptr<c10d::Comm>::shared_ptr<std::allocator<void>, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (this=0x7fffa58d5c80, __tag=...) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr.h:464
#24 0x00007d2c99949448 in std::make_shared<c10d::Comm, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> () at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr.h:1010
#25 0x00007d2c9992fc97 in c10d::Comm::get_comm (id=@0xa9b14f8: 0, dev=..., oob=std::shared_ptr<c10d::torch_ucc_oob_coll_info_t> (use count 4, weak count 0) = {...}, logger=..., is_health_check=false) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:407
#26 0x00007d2c9993e3b2 in c10d::ProcessGroupUCC::initComm (this=0xa9b13a0, dev=...) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:1873
#27 0x00007d2c9993d8d9 in c10d::ProcessGroupUCC::send (this=0xa9b13a0, tensors=std::vector of length 1, capacity 1 = {...}, dstRank=1, tag=0) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:1710
#28 0x00007d2dca343100 in pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}::operator()(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int) const (__closure=0x96f13f8, c=0xa9b13a0, args#0=std::vector of length 1, capacity 1 = {...}, args#1=1, args#2=0) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:136
#29 0x00007d2dca41dc91 in pybind11::detail::argument_loader<c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int>::call_impl<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&, 0ul, 1ul, 2ul, 3ul, pybind11::gil_scoped_release>(pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&, std::integer_sequence<unsigned long, 0ul, 1ul, 2ul, 3ul>, pybind11::gil_scoped_release&&) && (this=0x7fffa58d6340, f=...) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/cast.h:1631
#30 0x00007d2dca3e930e in pybind11::detail::argument_loader<c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int>::call<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, pybind11::gil_scoped_release, pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&>(pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&) && (this=0x7fffa58d6340, f=...) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/cast.h:1600
#31 0x00007d2dca39a925 in pybind11::cpp_function::initialize<pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&&, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (*)(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(pybind11::detail::function_call&)#1}::operator()(pybind11::detail::function_call&) const (__closure=0x0, call=...) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:278
#32 0x00007d2dca39ab46 in pybind11::cpp_function::initialize<pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&&, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (*)(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(pybind11::detail::function_call&)#1}::_FUN(pybind11::detail::function_call&) () at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:249
#33 0x00007d2dc8fe0da1 in pybind11::cpp_function::dispatcher (self=0x7d2c9bc16820, args_in=0x7d2dcbd4c400, kwargs_in=0x0) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:971
#34 0x0000000000528db7 in cfunction_call (func=0x7d2c9bc1b1a0, args=<optimized out>, kwargs=<optimized out>) at /usr/local/src/conda/python-3.11.13/Objects/methodobject.c:542
#35 0x000000000050454c in _PyObject_MakeTpCall (tstate=0x8a9518 <_PyRuntime+166328>, callable=0x7d2c9bc1b1a0, args=<optimized out>, nargs=<optimized out>, keywords=0x0) at /usr/local/src/conda/python-3.11.13/Objects/call.c:214
#36 0x0000000000511cf6 in _PyEval_EvalFrameDefault (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, frame=<optimized out>, frame@entry=0x7d2dcc5831e0, throwflag=throwflag@entry=0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:4769
#37 0x0000000000539503 in _PyEval_EvalFrame (throwflag=0, frame=0x7d2dcc5831e0, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Include/internal/pycore_ceval.h:73
#38 _PyEval_Vector (kwnames=<optimized out>, argcount=1, args=0x7d2d647caa78, locals=0x0, func=<optimized out>, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:6434
#39 _PyFunction_Vectorcall (func=<optimized out>, stack=0x7d2d647caa78, nargsf=<optimized out>, kwnames=<optimized out>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:393
#40 0x000000000054358c in _PyVectorcall_Call (kwargs=<optimized out>, tuple=<optimized out>, callable=0x7d2c9bcd13a0, func=0x539390 <_PyFunction_Vectorcall>, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:257
#41 _PyObject_Call (kwargs=<optimized out>, args=<optimized out>, callable=0x7d2c9bcd13a0, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:328
#42 PyObject_Call (callable=0x7d2c9bcd13a0, args=<optimized out>, kwargs=<optimized out>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:355
#43 0x0000000000515f58 in do_call_core (use_tracing=<optimized out>, kwdict=0x7d2c99b21b80, callargs=0x7d2dcc1be590, func=0x7d2c9bcd13a0, tstate=<optimized out>) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:7349
#44 _PyEval_EvalFrameDefault (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, frame=<optimized out>, frame@entry=0x7d2dcc583020, throwflag=throwflag@entry=0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:5376
#45 0x00000000005cd0aa in _PyEval_EvalFrame (throwflag=0, frame=0x7d2dcc583020, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Include/internal/pycore_ceval.h:73
#46 _PyEval_Vector (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, func=func@entry=0x7d2dcc1d60c0, locals=locals@entry=0x7d2dcc1f69c0, args=args@entry=0x0, argcount=argcount@entry=0, kwnames=kwnames@entry=0x0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:6434
#47 0x00000000005cc77f in PyEval_EvalCode (co=co@entry=0x7d2dcc1c8030, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:1148
#48 0x00000000005ed557 in run_eval_code_obj (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, co=co@entry=0x7d2dcc1c8030, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:1741
#49 0x00000000005e9080 in run_mod (mod=mod@entry=0x5431ae0, filename=filename@entry=0x7d2dcc1ff780, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0, flags=flags@entry=0x7fffa58d6dd8, arena=arena@entry=0x7d2dcc11b670) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:1762
---
[HIT] ucm_shmdt
#0  ucm_shmdt (shmaddr=0x7d2dcb6e1000) at event/event.c:360
#1  0x00007d2d95631fd3 in ucm_override_shmdt (arg0=0x7d2dcb6e1000) at util/replace.c:57
#2  0x00007d2d956302af in ucm_fire_mmap_events_internal (events=131327, data=0x7fffa58d5134, exclusive=0) at mmap/install.c:197
#3  0x00007d2d95630d76 in ucm_mmap_test_events_nolock (events=131327, exclusive=0, event_type=0x7d2d9564531b "existing") at mmap/install.c:295
#4  0x00007d2d95631529 in ucm_mmap_install (events=2228224, exclusive=0) at mmap/install.c:426
#5  0x00007d2d9562bdd7 in ucm_event_install (events=2228224) at event/event.c:532
#6  0x00007d2d9562c027 in ucm_set_event_handler (events=2228224, priority=500, cb=0x7d2d718b2100 <ucs_rcache_unmapped_callback>, arg=0x122b18f0) at event/event.c:596
#7  0x00007d2d718b4c06 in ucs_rcache_t_init (self=0x122b18f0, _myclass=0x7d2d718fa420 <ucs_rcache_t_class>, _init_count=0x7fffa58d535c, params=0x7fffa58d5400, name=0x7d2c99684075 "ucp_rcache", stats_parent=0x7d2d718fa4d8 <ucs_stats_context+88>) at memory/rcache.c:1358
#8  0x00007d2d718b4fb1 in ucs_rcache_create (arg0=0x7fffa58d5400, arg1=0x7d2c99684075 "ucp_rcache", arg2=0x7d2d718fa4d8 <ucs_stats_context+88>, obj_p=0x122a23c0) at memory/rcache.c:1418
#9  0x00007d2c99488309 in ucp_mem_rcache_create (context=0x122a21e0, name=0x7d2c99684075 "ucp_rcache", rcache_p=0x122a23c0, events=1, rcache_params=0x7fffa58d5400) at core/ucp_mm.c:1671
#10 0x00007d2c9948836b in ucp_mem_rcache_init (context=0x122a21e0, rcache_config=0xab9b8e0) at core/ucp_mm.c:1683
#11 0x00007d2c9943efdf in ucp_init_version (api_major_version=1, api_minor_version=18, params=0x7fffa58d5530, config=0xab9b810, context_p=0x1229eff8) at core/ucp_context.c:2308
#12 0x00007d2c99999dbe in ucp_init (params=0x7fffa58d5530, config=0xab9b810, context_p=0x1229eff8) at /data/ZYH/ucx-1.18.1/install/include/ucp/api/ucp.h:2095
#13 0x00007d2c9999a7c9 in c10d::CommUCX::CommUCX (this=0x1229efe8, comm_size=2, logger=...) at /data/ZYH/torch_ucc/src/torch_ucc_comm.cpp:55
#14 0x00007d2c9992efba in c10d::Comm::Comm (this=0x1229efd0, logger_=..., oob_=std::shared_ptr<c10d::torch_ucc_oob_coll_info_t> (use count 4, weak count 0) = {...}, dev=..., is_health_check=false) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:336
#15 0x00007d2c9998dfd0 in std::_Construct<c10d::Comm, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (__p=0x1229efd0) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/stl_construct.h:119
#16 0x00007d2c9998a36c in std::allocator_traits<std::allocator<void> >::construct<c10d::Comm, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (__p=0x1229efd0) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/alloc_traits.h:635
#17 0x00007d2c9998494a in std::_Sp_counted_ptr_inplace<c10d::Comm, std::allocator<void>, (__gnu_cxx::_Lock_policy)2>::_Sp_counted_ptr_inplace<c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (this=0x1229efc0, __a=...) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr_base.h:604
#18 0x00007d2c9997b2d0 in std::__shared_count<(__gnu_cxx::_Lock_policy)2>::__shared_count<c10d::Comm, std::allocator<void>, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (this=0x7fffa58d5c88, __p=@0x7fffa58d5c80: 0x0, __a=...) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr_base.h:971
#19 0x00007d2c9996e535 in std::__shared_ptr<c10d::Comm, (__gnu_cxx::_Lock_policy)2>::__shared_ptr<std::allocator<void>, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (this=0x7fffa58d5c80, __tag=...) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr_base.h:1715
#20 0x00007d2c9995fb42 in std::shared_ptr<c10d::Comm>::shared_ptr<std::allocator<void>, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (this=0x7fffa58d5c80, __tag=...) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr.h:464
#21 0x00007d2c99949448 in std::make_shared<c10d::Comm, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> () at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr.h:1010
#22 0x00007d2c9992fc97 in c10d::Comm::get_comm (id=@0xa9b14f8: 0, dev=..., oob=std::shared_ptr<c10d::torch_ucc_oob_coll_info_t> (use count 4, weak count 0) = {...}, logger=..., is_health_check=false) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:407
#23 0x00007d2c9993e3b2 in c10d::ProcessGroupUCC::initComm (this=0xa9b13a0, dev=...) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:1873
#24 0x00007d2c9993d8d9 in c10d::ProcessGroupUCC::send (this=0xa9b13a0, tensors=std::vector of length 1, capacity 1 = {...}, dstRank=1, tag=0) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:1710
#25 0x00007d2dca343100 in pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}::operator()(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int) const (__closure=0x96f13f8, c=0xa9b13a0, args#0=std::vector of length 1, capacity 1 = {...}, args#1=1, args#2=0) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:136
#26 0x00007d2dca41dc91 in pybind11::detail::argument_loader<c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int>::call_impl<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&, 0ul, 1ul, 2ul, 3ul, pybind11::gil_scoped_release>(pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&, std::integer_sequence<unsigned long, 0ul, 1ul, 2ul, 3ul>, pybind11::gil_scoped_release&&) && (this=0x7fffa58d6340, f=...) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/cast.h:1631
#27 0x00007d2dca3e930e in pybind11::detail::argument_loader<c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int>::call<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, pybind11::gil_scoped_release, pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&>(pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&) && (this=0x7fffa58d6340, f=...) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/cast.h:1600
#28 0x00007d2dca39a925 in pybind11::cpp_function::initialize<pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&&, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (*)(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(pybind11::detail::function_call&)#1}::operator()(pybind11::detail::function_call&) const (__closure=0x0, call=...) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:278
#29 0x00007d2dca39ab46 in pybind11::cpp_function::initialize<pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&&, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (*)(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(pybind11::detail::function_call&)#1}::_FUN(pybind11::detail::function_call&) () at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:249
#30 0x00007d2dc8fe0da1 in pybind11::cpp_function::dispatcher (self=0x7d2c9bc16820, args_in=0x7d2dcbd4c400, kwargs_in=0x0) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:971
#31 0x0000000000528db7 in cfunction_call (func=0x7d2c9bc1b1a0, args=<optimized out>, kwargs=<optimized out>) at /usr/local/src/conda/python-3.11.13/Objects/methodobject.c:542
#32 0x000000000050454c in _PyObject_MakeTpCall (tstate=0x8a9518 <_PyRuntime+166328>, callable=0x7d2c9bc1b1a0, args=<optimized out>, nargs=<optimized out>, keywords=0x0) at /usr/local/src/conda/python-3.11.13/Objects/call.c:214
#33 0x0000000000511cf6 in _PyEval_EvalFrameDefault (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, frame=<optimized out>, frame@entry=0x7d2dcc5831e0, throwflag=throwflag@entry=0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:4769
#34 0x0000000000539503 in _PyEval_EvalFrame (throwflag=0, frame=0x7d2dcc5831e0, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Include/internal/pycore_ceval.h:73
#35 _PyEval_Vector (kwnames=<optimized out>, argcount=1, args=0x7d2d647caa78, locals=0x0, func=<optimized out>, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:6434
#36 _PyFunction_Vectorcall (func=<optimized out>, stack=0x7d2d647caa78, nargsf=<optimized out>, kwnames=<optimized out>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:393
#37 0x000000000054358c in _PyVectorcall_Call (kwargs=<optimized out>, tuple=<optimized out>, callable=0x7d2c9bcd13a0, func=0x539390 <_PyFunction_Vectorcall>, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:257
#38 _PyObject_Call (kwargs=<optimized out>, args=<optimized out>, callable=0x7d2c9bcd13a0, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:328
#39 PyObject_Call (callable=0x7d2c9bcd13a0, args=<optimized out>, kwargs=<optimized out>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:355
#40 0x0000000000515f58 in do_call_core (use_tracing=<optimized out>, kwdict=0x7d2c99b21b80, callargs=0x7d2dcc1be590, func=0x7d2c9bcd13a0, tstate=<optimized out>) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:7349
#41 _PyEval_EvalFrameDefault (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, frame=<optimized out>, frame@entry=0x7d2dcc583020, throwflag=throwflag@entry=0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:5376
#42 0x00000000005cd0aa in _PyEval_EvalFrame (throwflag=0, frame=0x7d2dcc583020, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Include/internal/pycore_ceval.h:73
#43 _PyEval_Vector (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, func=func@entry=0x7d2dcc1d60c0, locals=locals@entry=0x7d2dcc1f69c0, args=args@entry=0x0, argcount=argcount@entry=0, kwnames=kwnames@entry=0x0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:6434
#44 0x00000000005cc77f in PyEval_EvalCode (co=co@entry=0x7d2dcc1c8030, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:1148
#45 0x00000000005ed557 in run_eval_code_obj (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, co=co@entry=0x7d2dcc1c8030, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:1741
#46 0x00000000005e9080 in run_mod (mod=mod@entry=0x5431ae0, filename=filename@entry=0x7d2dcc1ff780, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0, flags=flags@entry=0x7fffa58d6dd8, arena=arena@entry=0x7d2dcc11b670) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:1762
#47 0x00000000005fde72 in pyrun_file (fp=fp@entry=0x53c05a0, filename=filename@entry=0x7d2dcc1ff780, start=start@entry=257, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0, closeit=closeit@entry=1, flags=0x7fffa58d6dd8) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:1657
#48 0x00000000005fd28f in _PyRun_SimpleFileObject (fp=0x53c05a0, filename=0x7d2dcc1ff780, closeit=1, flags=0x7fffa58d6dd8) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:440
#49 0x00000000005fcfb3 in _PyRun_AnyFileObject (fp=0x53c05a0, filename=filename@entry=0x7d2dcc1ff780, closeit=closeit@entry=1, flags=flags@entry=0x7fffa58d6dd8) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:79
---
[HIT] ucm_orig_shmdt
#0  ucm_orig_shmdt (arg0=0x7d2dcb6e1000) at util/replace.c:102
#1  0x00007d2d9562a539 in ucm_event_call_orig (event_type=UCM_EVENT_SHMDT, event=0x7fffa58d4fd0, arg=0x0) at event/event.c:96
#2  0x00007d2d9562a682 in ucm_event_dispatch (event_type=UCM_EVENT_SHMDT, event=0x7fffa58d4fd0) at event/event.c:145
#3  0x00007d2d9562b5f1 in ucm_shmdt (shmaddr=0x7d2dcb6e1000) at event/event.c:376
#4  0x00007d2d95631fd3 in ucm_override_shmdt (arg0=0x7d2dcb6e1000) at util/replace.c:57
#5  0x00007d2d956302af in ucm_fire_mmap_events_internal (events=131327, data=0x7fffa58d5134, exclusive=0) at mmap/install.c:197
#6  0x00007d2d95630d76 in ucm_mmap_test_events_nolock (events=131327, exclusive=0, event_type=0x7d2d9564531b "existing") at mmap/install.c:295
#7  0x00007d2d95631529 in ucm_mmap_install (events=2228224, exclusive=0) at mmap/install.c:426
#8  0x00007d2d9562bdd7 in ucm_event_install (events=2228224) at event/event.c:532
#9  0x00007d2d9562c027 in ucm_set_event_handler (events=2228224, priority=500, cb=0x7d2d718b2100 <ucs_rcache_unmapped_callback>, arg=0x122b18f0) at event/event.c:596
#10 0x00007d2d718b4c06 in ucs_rcache_t_init (self=0x122b18f0, _myclass=0x7d2d718fa420 <ucs_rcache_t_class>, _init_count=0x7fffa58d535c, params=0x7fffa58d5400, name=0x7d2c99684075 "ucp_rcache", stats_parent=0x7d2d718fa4d8 <ucs_stats_context+88>) at memory/rcache.c:1358
#11 0x00007d2d718b4fb1 in ucs_rcache_create (arg0=0x7fffa58d5400, arg1=0x7d2c99684075 "ucp_rcache", arg2=0x7d2d718fa4d8 <ucs_stats_context+88>, obj_p=0x122a23c0) at memory/rcache.c:1418
#12 0x00007d2c99488309 in ucp_mem_rcache_create (context=0x122a21e0, name=0x7d2c99684075 "ucp_rcache", rcache_p=0x122a23c0, events=1, rcache_params=0x7fffa58d5400) at core/ucp_mm.c:1671
#13 0x00007d2c9948836b in ucp_mem_rcache_init (context=0x122a21e0, rcache_config=0xab9b8e0) at core/ucp_mm.c:1683
#14 0x00007d2c9943efdf in ucp_init_version (api_major_version=1, api_minor_version=18, params=0x7fffa58d5530, config=0xab9b810, context_p=0x1229eff8) at core/ucp_context.c:2308
#15 0x00007d2c99999dbe in ucp_init (params=0x7fffa58d5530, config=0xab9b810, context_p=0x1229eff8) at /data/ZYH/ucx-1.18.1/install/include/ucp/api/ucp.h:2095
#16 0x00007d2c9999a7c9 in c10d::CommUCX::CommUCX (this=0x1229efe8, comm_size=2, logger=...) at /data/ZYH/torch_ucc/src/torch_ucc_comm.cpp:55
#17 0x00007d2c9992efba in c10d::Comm::Comm (this=0x1229efd0, logger_=..., oob_=std::shared_ptr<c10d::torch_ucc_oob_coll_info_t> (use count 4, weak count 0) = {...}, dev=..., is_health_check=false) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:336
#18 0x00007d2c9998dfd0 in std::_Construct<c10d::Comm, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (__p=0x1229efd0) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/stl_construct.h:119
#19 0x00007d2c9998a36c in std::allocator_traits<std::allocator<void> >::construct<c10d::Comm, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (__p=0x1229efd0) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/alloc_traits.h:635
#20 0x00007d2c9998494a in std::_Sp_counted_ptr_inplace<c10d::Comm, std::allocator<void>, (__gnu_cxx::_Lock_policy)2>::_Sp_counted_ptr_inplace<c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (this=0x1229efc0, __a=...) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr_base.h:604
#21 0x00007d2c9997b2d0 in std::__shared_count<(__gnu_cxx::_Lock_policy)2>::__shared_count<c10d::Comm, std::allocator<void>, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (this=0x7fffa58d5c88, __p=@0x7fffa58d5c80: 0x0, __a=...) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr_base.h:971
#22 0x00007d2c9996e535 in std::__shared_ptr<c10d::Comm, (__gnu_cxx::_Lock_policy)2>::__shared_ptr<std::allocator<void>, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (this=0x7fffa58d5c80, __tag=...) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr_base.h:1715
#23 0x00007d2c9995fb42 in std::shared_ptr<c10d::Comm>::shared_ptr<std::allocator<void>, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (this=0x7fffa58d5c80, __tag=...) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr.h:464
#24 0x00007d2c99949448 in std::make_shared<c10d::Comm, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> () at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr.h:1010
#25 0x00007d2c9992fc97 in c10d::Comm::get_comm (id=@0xa9b14f8: 0, dev=..., oob=std::shared_ptr<c10d::torch_ucc_oob_coll_info_t> (use count 4, weak count 0) = {...}, logger=..., is_health_check=false) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:407
#26 0x00007d2c9993e3b2 in c10d::ProcessGroupUCC::initComm (this=0xa9b13a0, dev=...) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:1873
#27 0x00007d2c9993d8d9 in c10d::ProcessGroupUCC::send (this=0xa9b13a0, tensors=std::vector of length 1, capacity 1 = {...}, dstRank=1, tag=0) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:1710
#28 0x00007d2dca343100 in pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}::operator()(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int) const (__closure=0x96f13f8, c=0xa9b13a0, args#0=std::vector of length 1, capacity 1 = {...}, args#1=1, args#2=0) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:136
#29 0x00007d2dca41dc91 in pybind11::detail::argument_loader<c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int>::call_impl<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&, 0ul, 1ul, 2ul, 3ul, pybind11::gil_scoped_release>(pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&, std::integer_sequence<unsigned long, 0ul, 1ul, 2ul, 3ul>, pybind11::gil_scoped_release&&) && (this=0x7fffa58d6340, f=...) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/cast.h:1631
#30 0x00007d2dca3e930e in pybind11::detail::argument_loader<c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int>::call<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, pybind11::gil_scoped_release, pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&>(pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&) && (this=0x7fffa58d6340, f=...) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/cast.h:1600
#31 0x00007d2dca39a925 in pybind11::cpp_function::initialize<pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&&, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (*)(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(pybind11::detail::function_call&)#1}::operator()(pybind11::detail::function_call&) const (__closure=0x0, call=...) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:278
#32 0x00007d2dca39ab46 in pybind11::cpp_function::initialize<pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&&, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (*)(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(pybind11::detail::function_call&)#1}::_FUN(pybind11::detail::function_call&) () at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:249
#33 0x00007d2dc8fe0da1 in pybind11::cpp_function::dispatcher (self=0x7d2c9bc16820, args_in=0x7d2dcbd4c400, kwargs_in=0x0) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:971
#34 0x0000000000528db7 in cfunction_call (func=0x7d2c9bc1b1a0, args=<optimized out>, kwargs=<optimized out>) at /usr/local/src/conda/python-3.11.13/Objects/methodobject.c:542
#35 0x000000000050454c in _PyObject_MakeTpCall (tstate=0x8a9518 <_PyRuntime+166328>, callable=0x7d2c9bc1b1a0, args=<optimized out>, nargs=<optimized out>, keywords=0x0) at /usr/local/src/conda/python-3.11.13/Objects/call.c:214
#36 0x0000000000511cf6 in _PyEval_EvalFrameDefault (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, frame=<optimized out>, frame@entry=0x7d2dcc5831e0, throwflag=throwflag@entry=0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:4769
#37 0x0000000000539503 in _PyEval_EvalFrame (throwflag=0, frame=0x7d2dcc5831e0, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Include/internal/pycore_ceval.h:73
#38 _PyEval_Vector (kwnames=<optimized out>, argcount=1, args=0x7d2d647caa78, locals=0x0, func=<optimized out>, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:6434
#39 _PyFunction_Vectorcall (func=<optimized out>, stack=0x7d2d647caa78, nargsf=<optimized out>, kwnames=<optimized out>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:393
#40 0x000000000054358c in _PyVectorcall_Call (kwargs=<optimized out>, tuple=<optimized out>, callable=0x7d2c9bcd13a0, func=0x539390 <_PyFunction_Vectorcall>, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:257
#41 _PyObject_Call (kwargs=<optimized out>, args=<optimized out>, callable=0x7d2c9bcd13a0, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:328
#42 PyObject_Call (callable=0x7d2c9bcd13a0, args=<optimized out>, kwargs=<optimized out>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:355
#43 0x0000000000515f58 in do_call_core (use_tracing=<optimized out>, kwdict=0x7d2c99b21b80, callargs=0x7d2dcc1be590, func=0x7d2c9bcd13a0, tstate=<optimized out>) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:7349
#44 _PyEval_EvalFrameDefault (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, frame=<optimized out>, frame@entry=0x7d2dcc583020, throwflag=throwflag@entry=0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:5376
#45 0x00000000005cd0aa in _PyEval_EvalFrame (throwflag=0, frame=0x7d2dcc583020, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Include/internal/pycore_ceval.h:73
#46 _PyEval_Vector (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, func=func@entry=0x7d2dcc1d60c0, locals=locals@entry=0x7d2dcc1f69c0, args=args@entry=0x0, argcount=argcount@entry=0, kwnames=kwnames@entry=0x0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:6434
#47 0x00000000005cc77f in PyEval_EvalCode (co=co@entry=0x7d2dcc1c8030, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:1148
#48 0x00000000005ed557 in run_eval_code_obj (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, co=co@entry=0x7d2dcc1c8030, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:1741
#49 0x00000000005e9080 in run_mod (mod=mod@entry=0x5431ae0, filename=filename@entry=0x7d2dcc1ff780, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0, flags=flags@entry=0x7fffa58d6dd8, arena=arena@entry=0x7d2dcc11b670) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:1762
---
[HIT] ucm_brk
#0  ucm_brk (addr=0x0) at event/event.c:415
#1  0x00007d2d956320f5 in ucm_override_brk (arg0=0x0) at util/replace.c:59
#2  0x00007d2d9562fb9c in ucm_brk_checked (addr=0x0) at mmap/install.c:141
#3  0x00007d2d956306e4 in ucm_fire_mmap_events_internal (events=131327, data=0x7fffa58d5134, exclusive=0) at mmap/install.c:222
#4  0x00007d2d95630d76 in ucm_mmap_test_events_nolock (events=131327, exclusive=0, event_type=0x7d2d9564531b "existing") at mmap/install.c:295
#5  0x00007d2d95631529 in ucm_mmap_install (events=2228224, exclusive=0) at mmap/install.c:426
#6  0x00007d2d9562bdd7 in ucm_event_install (events=2228224) at event/event.c:532
#7  0x00007d2d9562c027 in ucm_set_event_handler (events=2228224, priority=500, cb=0x7d2d718b2100 <ucs_rcache_unmapped_callback>, arg=0x122b18f0) at event/event.c:596
#8  0x00007d2d718b4c06 in ucs_rcache_t_init (self=0x122b18f0, _myclass=0x7d2d718fa420 <ucs_rcache_t_class>, _init_count=0x7fffa58d535c, params=0x7fffa58d5400, name=0x7d2c99684075 "ucp_rcache", stats_parent=0x7d2d718fa4d8 <ucs_stats_context+88>) at memory/rcache.c:1358
#9  0x00007d2d718b4fb1 in ucs_rcache_create (arg0=0x7fffa58d5400, arg1=0x7d2c99684075 "ucp_rcache", arg2=0x7d2d718fa4d8 <ucs_stats_context+88>, obj_p=0x122a23c0) at memory/rcache.c:1418
#10 0x00007d2c99488309 in ucp_mem_rcache_create (context=0x122a21e0, name=0x7d2c99684075 "ucp_rcache", rcache_p=0x122a23c0, events=1, rcache_params=0x7fffa58d5400) at core/ucp_mm.c:1671
#11 0x00007d2c9948836b in ucp_mem_rcache_init (context=0x122a21e0, rcache_config=0xab9b8e0) at core/ucp_mm.c:1683
#12 0x00007d2c9943efdf in ucp_init_version (api_major_version=1, api_minor_version=18, params=0x7fffa58d5530, config=0xab9b810, context_p=0x1229eff8) at core/ucp_context.c:2308
#13 0x00007d2c99999dbe in ucp_init (params=0x7fffa58d5530, config=0xab9b810, context_p=0x1229eff8) at /data/ZYH/ucx-1.18.1/install/include/ucp/api/ucp.h:2095
#14 0x00007d2c9999a7c9 in c10d::CommUCX::CommUCX (this=0x1229efe8, comm_size=2, logger=...) at /data/ZYH/torch_ucc/src/torch_ucc_comm.cpp:55
#15 0x00007d2c9992efba in c10d::Comm::Comm (this=0x1229efd0, logger_=..., oob_=std::shared_ptr<c10d::torch_ucc_oob_coll_info_t> (use count 4, weak count 0) = {...}, dev=..., is_health_check=false) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:336
#16 0x00007d2c9998dfd0 in std::_Construct<c10d::Comm, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (__p=0x1229efd0) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/stl_construct.h:119
#17 0x00007d2c9998a36c in std::allocator_traits<std::allocator<void> >::construct<c10d::Comm, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (__p=0x1229efd0) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/alloc_traits.h:635
#18 0x00007d2c9998494a in std::_Sp_counted_ptr_inplace<c10d::Comm, std::allocator<void>, (__gnu_cxx::_Lock_policy)2>::_Sp_counted_ptr_inplace<c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (this=0x1229efc0, __a=...) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr_base.h:604
#19 0x00007d2c9997b2d0 in std::__shared_count<(__gnu_cxx::_Lock_policy)2>::__shared_count<c10d::Comm, std::allocator<void>, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (this=0x7fffa58d5c88, __p=@0x7fffa58d5c80: 0x0, __a=...) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr_base.h:971
#20 0x00007d2c9996e535 in std::__shared_ptr<c10d::Comm, (__gnu_cxx::_Lock_policy)2>::__shared_ptr<std::allocator<void>, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (this=0x7fffa58d5c80, __tag=...) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr_base.h:1715
#21 0x00007d2c9995fb42 in std::shared_ptr<c10d::Comm>::shared_ptr<std::allocator<void>, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (this=0x7fffa58d5c80, __tag=...) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr.h:464
#22 0x00007d2c99949448 in std::make_shared<c10d::Comm, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> () at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr.h:1010
#23 0x00007d2c9992fc97 in c10d::Comm::get_comm (id=@0xa9b14f8: 0, dev=..., oob=std::shared_ptr<c10d::torch_ucc_oob_coll_info_t> (use count 4, weak count 0) = {...}, logger=..., is_health_check=false) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:407
#24 0x00007d2c9993e3b2 in c10d::ProcessGroupUCC::initComm (this=0xa9b13a0, dev=...) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:1873
#25 0x00007d2c9993d8d9 in c10d::ProcessGroupUCC::send (this=0xa9b13a0, tensors=std::vector of length 1, capacity 1 = {...}, dstRank=1, tag=0) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:1710
#26 0x00007d2dca343100 in pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}::operator()(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int) const (__closure=0x96f13f8, c=0xa9b13a0, args#0=std::vector of length 1, capacity 1 = {...}, args#1=1, args#2=0) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:136
#27 0x00007d2dca41dc91 in pybind11::detail::argument_loader<c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int>::call_impl<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&, 0ul, 1ul, 2ul, 3ul, pybind11::gil_scoped_release>(pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&, std::integer_sequence<unsigned long, 0ul, 1ul, 2ul, 3ul>, pybind11::gil_scoped_release&&) && (this=0x7fffa58d6340, f=...) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/cast.h:1631
#28 0x00007d2dca3e930e in pybind11::detail::argument_loader<c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int>::call<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, pybind11::gil_scoped_release, pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&>(pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&) && (this=0x7fffa58d6340, f=...) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/cast.h:1600
#29 0x00007d2dca39a925 in pybind11::cpp_function::initialize<pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&&, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (*)(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(pybind11::detail::function_call&)#1}::operator()(pybind11::detail::function_call&) const (__closure=0x0, call=...) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:278
#30 0x00007d2dca39ab46 in pybind11::cpp_function::initialize<pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&&, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (*)(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(pybind11::detail::function_call&)#1}::_FUN(pybind11::detail::function_call&) () at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:249
#31 0x00007d2dc8fe0da1 in pybind11::cpp_function::dispatcher (self=0x7d2c9bc16820, args_in=0x7d2dcbd4c400, kwargs_in=0x0) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:971
#32 0x0000000000528db7 in cfunction_call (func=0x7d2c9bc1b1a0, args=<optimized out>, kwargs=<optimized out>) at /usr/local/src/conda/python-3.11.13/Objects/methodobject.c:542
#33 0x000000000050454c in _PyObject_MakeTpCall (tstate=0x8a9518 <_PyRuntime+166328>, callable=0x7d2c9bc1b1a0, args=<optimized out>, nargs=<optimized out>, keywords=0x0) at /usr/local/src/conda/python-3.11.13/Objects/call.c:214
#34 0x0000000000511cf6 in _PyEval_EvalFrameDefault (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, frame=<optimized out>, frame@entry=0x7d2dcc5831e0, throwflag=throwflag@entry=0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:4769
#35 0x0000000000539503 in _PyEval_EvalFrame (throwflag=0, frame=0x7d2dcc5831e0, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Include/internal/pycore_ceval.h:73
#36 _PyEval_Vector (kwnames=<optimized out>, argcount=1, args=0x7d2d647caa78, locals=0x0, func=<optimized out>, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:6434
#37 _PyFunction_Vectorcall (func=<optimized out>, stack=0x7d2d647caa78, nargsf=<optimized out>, kwnames=<optimized out>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:393
#38 0x000000000054358c in _PyVectorcall_Call (kwargs=<optimized out>, tuple=<optimized out>, callable=0x7d2c9bcd13a0, func=0x539390 <_PyFunction_Vectorcall>, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:257
#39 _PyObject_Call (kwargs=<optimized out>, args=<optimized out>, callable=0x7d2c9bcd13a0, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:328
#40 PyObject_Call (callable=0x7d2c9bcd13a0, args=<optimized out>, kwargs=<optimized out>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:355
#41 0x0000000000515f58 in do_call_core (use_tracing=<optimized out>, kwdict=0x7d2c99b21b80, callargs=0x7d2dcc1be590, func=0x7d2c9bcd13a0, tstate=<optimized out>) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:7349
#42 _PyEval_EvalFrameDefault (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, frame=<optimized out>, frame@entry=0x7d2dcc583020, throwflag=throwflag@entry=0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:5376
#43 0x00000000005cd0aa in _PyEval_EvalFrame (throwflag=0, frame=0x7d2dcc583020, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Include/internal/pycore_ceval.h:73
#44 _PyEval_Vector (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, func=func@entry=0x7d2dcc1d60c0, locals=locals@entry=0x7d2dcc1f69c0, args=args@entry=0x0, argcount=argcount@entry=0, kwnames=kwnames@entry=0x0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:6434
#45 0x00000000005cc77f in PyEval_EvalCode (co=co@entry=0x7d2dcc1c8030, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:1148
#46 0x00000000005ed557 in run_eval_code_obj (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, co=co@entry=0x7d2dcc1c8030, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:1741
#47 0x00000000005e9080 in run_mod (mod=mod@entry=0x5431ae0, filename=filename@entry=0x7d2dcc1ff780, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0, flags=flags@entry=0x7fffa58d6dd8, arena=arena@entry=0x7d2dcc11b670) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:1762
#48 0x00000000005fde72 in pyrun_file (fp=fp@entry=0x53c05a0, filename=filename@entry=0x7d2dcc1ff780, start=start@entry=257, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0, closeit=closeit@entry=1, flags=0x7fffa58d6dd8) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:1657
#49 0x00000000005fd28f in _PyRun_SimpleFileObject (fp=0x53c05a0, filename=0x7d2dcc1ff780, closeit=1, flags=0x7fffa58d6dd8) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:440
---
[HIT] ucp_config_release
#0  ucp_config_release (config=0xab9b810) at core/ucp_context.c:784
#1  0x00007d2c9999a97e in c10d::CommUCX::CommUCX (this=0x1229efe8, comm_size=2, logger=...) at /data/ZYH/torch_ucc/src/torch_ucc_comm.cpp:57
#2  0x00007d2c9992efba in c10d::Comm::Comm (this=0x1229efd0, logger_=..., oob_=std::shared_ptr<c10d::torch_ucc_oob_coll_info_t> (use count 4, weak count 0) = {...}, dev=..., is_health_check=false) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:336
#3  0x00007d2c9998dfd0 in std::_Construct<c10d::Comm, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (__p=0x1229efd0) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/stl_construct.h:119
#4  0x00007d2c9998a36c in std::allocator_traits<std::allocator<void> >::construct<c10d::Comm, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (__p=0x1229efd0) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/alloc_traits.h:635
#5  0x00007d2c9998494a in std::_Sp_counted_ptr_inplace<c10d::Comm, std::allocator<void>, (__gnu_cxx::_Lock_policy)2>::_Sp_counted_ptr_inplace<c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (this=0x1229efc0, __a=...) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr_base.h:604
#6  0x00007d2c9997b2d0 in std::__shared_count<(__gnu_cxx::_Lock_policy)2>::__shared_count<c10d::Comm, std::allocator<void>, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (this=0x7fffa58d5c88, __p=@0x7fffa58d5c80: 0x0, __a=...) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr_base.h:971
#7  0x00007d2c9996e535 in std::__shared_ptr<c10d::Comm, (__gnu_cxx::_Lock_policy)2>::__shared_ptr<std::allocator<void>, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (this=0x7fffa58d5c80, __tag=...) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr_base.h:1715
#8  0x00007d2c9995fb42 in std::shared_ptr<c10d::Comm>::shared_ptr<std::allocator<void>, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (this=0x7fffa58d5c80, __tag=...) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr.h:464
#9  0x00007d2c99949448 in std::make_shared<c10d::Comm, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> () at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr.h:1010
#10 0x00007d2c9992fc97 in c10d::Comm::get_comm (id=@0xa9b14f8: 0, dev=..., oob=std::shared_ptr<c10d::torch_ucc_oob_coll_info_t> (use count 4, weak count 0) = {...}, logger=..., is_health_check=false) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:407
#11 0x00007d2c9993e3b2 in c10d::ProcessGroupUCC::initComm (this=0xa9b13a0, dev=...) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:1873
#12 0x00007d2c9993d8d9 in c10d::ProcessGroupUCC::send (this=0xa9b13a0, tensors=std::vector of length 1, capacity 1 = {...}, dstRank=1, tag=0) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:1710
#13 0x00007d2dca343100 in pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}::operator()(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int) const (__closure=0x96f13f8, c=0xa9b13a0, args#0=std::vector of length 1, capacity 1 = {...}, args#1=1, args#2=0) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:136
#14 0x00007d2dca41dc91 in pybind11::detail::argument_loader<c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int>::call_impl<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&, 0ul, 1ul, 2ul, 3ul, pybind11::gil_scoped_release>(pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&, std::integer_sequence<unsigned long, 0ul, 1ul, 2ul, 3ul>, pybind11::gil_scoped_release&&) && (this=0x7fffa58d6340, f=...) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/cast.h:1631
#15 0x00007d2dca3e930e in pybind11::detail::argument_loader<c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int>::call<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, pybind11::gil_scoped_release, pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&>(pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&) && (this=0x7fffa58d6340, f=...) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/cast.h:1600
#16 0x00007d2dca39a925 in pybind11::cpp_function::initialize<pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&&, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (*)(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(pybind11::detail::function_call&)#1}::operator()(pybind11::detail::function_call&) const (__closure=0x0, call=...) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:278
#17 0x00007d2dca39ab46 in pybind11::cpp_function::initialize<pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&&, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (*)(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(pybind11::detail::function_call&)#1}::_FUN(pybind11::detail::function_call&) () at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:249
#18 0x00007d2dc8fe0da1 in pybind11::cpp_function::dispatcher (self=0x7d2c9bc16820, args_in=0x7d2dcbd4c400, kwargs_in=0x0) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:971
#19 0x0000000000528db7 in cfunction_call (func=0x7d2c9bc1b1a0, args=<optimized out>, kwargs=<optimized out>) at /usr/local/src/conda/python-3.11.13/Objects/methodobject.c:542
#20 0x000000000050454c in _PyObject_MakeTpCall (tstate=0x8a9518 <_PyRuntime+166328>, callable=0x7d2c9bc1b1a0, args=<optimized out>, nargs=<optimized out>, keywords=0x0) at /usr/local/src/conda/python-3.11.13/Objects/call.c:214
#21 0x0000000000511cf6 in _PyEval_EvalFrameDefault (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, frame=<optimized out>, frame@entry=0x7d2dcc5831e0, throwflag=throwflag@entry=0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:4769
#22 0x0000000000539503 in _PyEval_EvalFrame (throwflag=0, frame=0x7d2dcc5831e0, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Include/internal/pycore_ceval.h:73
#23 _PyEval_Vector (kwnames=<optimized out>, argcount=1, args=0x7d2d647caa78, locals=0x0, func=<optimized out>, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:6434
#24 _PyFunction_Vectorcall (func=<optimized out>, stack=0x7d2d647caa78, nargsf=<optimized out>, kwnames=<optimized out>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:393
#25 0x000000000054358c in _PyVectorcall_Call (kwargs=<optimized out>, tuple=<optimized out>, callable=0x7d2c9bcd13a0, func=0x539390 <_PyFunction_Vectorcall>, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:257
#26 _PyObject_Call (kwargs=<optimized out>, args=<optimized out>, callable=0x7d2c9bcd13a0, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:328
#27 PyObject_Call (callable=0x7d2c9bcd13a0, args=<optimized out>, kwargs=<optimized out>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:355
#28 0x0000000000515f58 in do_call_core (use_tracing=<optimized out>, kwdict=0x7d2c99b21b80, callargs=0x7d2dcc1be590, func=0x7d2c9bcd13a0, tstate=<optimized out>) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:7349
#29 _PyEval_EvalFrameDefault (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, frame=<optimized out>, frame@entry=0x7d2dcc583020, throwflag=throwflag@entry=0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:5376
#30 0x00000000005cd0aa in _PyEval_EvalFrame (throwflag=0, frame=0x7d2dcc583020, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Include/internal/pycore_ceval.h:73
#31 _PyEval_Vector (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, func=func@entry=0x7d2dcc1d60c0, locals=locals@entry=0x7d2dcc1f69c0, args=args@entry=0x0, argcount=argcount@entry=0, kwnames=kwnames@entry=0x0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:6434
#32 0x00000000005cc77f in PyEval_EvalCode (co=co@entry=0x7d2dcc1c8030, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:1148
#33 0x00000000005ed557 in run_eval_code_obj (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, co=co@entry=0x7d2dcc1c8030, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:1741
#34 0x00000000005e9080 in run_mod (mod=mod@entry=0x5431ae0, filename=filename@entry=0x7d2dcc1ff780, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0, flags=flags@entry=0x7fffa58d6dd8, arena=arena@entry=0x7d2dcc11b670) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:1762
#35 0x00000000005fde72 in pyrun_file (fp=fp@entry=0x53c05a0, filename=filename@entry=0x7d2dcc1ff780, start=start@entry=257, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0, closeit=closeit@entry=1, flags=0x7fffa58d6dd8) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:1657
#36 0x00000000005fd28f in _PyRun_SimpleFileObject (fp=0x53c05a0, filename=0x7d2dcc1ff780, closeit=1, flags=0x7fffa58d6dd8) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:440
#37 0x00000000005fcfb3 in _PyRun_AnyFileObject (fp=0x53c05a0, filename=filename@entry=0x7d2dcc1ff780, closeit=closeit@entry=1, flags=flags@entry=0x7fffa58d6dd8) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:79
#38 0x00000000005f7dae in pymain_run_file_obj (skip_source_first_line=0, filename=0x7d2dcc1ff780, program_name=0x7d2dcc1973b0) at /usr/local/src/conda/python-3.11.13/Modules/main.c:360
#39 pymain_run_file (config=0x88f560 <_PyRuntime+59904>) at /usr/local/src/conda/python-3.11.13/Modules/main.c:379
#40 pymain_run_python (exitcode=0x7fffa58d6dd0) at /usr/local/src/conda/python-3.11.13/Modules/main.c:605
#41 Py_RunMain () at /usr/local/src/conda/python-3.11.13/Modules/main.c:684
#42 0x00000000005bcdf9 in Py_BytesMain (argc=<optimized out>, argv=<optimized out>) at /usr/local/src/conda/python-3.11.13/Modules/main.c:738
#43 0x00007d2dcc22a1ca in __libc_start_call_main (main=main@entry=0x5bcd50 <main>, argc=argc@entry=3, argv=argv@entry=0x7fffa58d7038) at ../sysdeps/nptl/libc_start_call_main.h:58
#44 0x00007d2dcc22a28b in __libc_start_main_impl (main=0x5bcd50 <main>, argc=3, argv=0x7fffa58d7038, init=<optimized out>, fini=<optimized out>, rtld_fini=<optimized out>, stack_end=0x7fffa58d7028) at ../csu/libc-start.c:360
#45 0x00000000005bcc43 in _start ()
---
[HIT] ucp_worker_create
#0  ucp_worker_create (context=0x122a21e0, params=0x7fffa58d55c0, worker_p=0x1229f000) at core/ucp_worker.c:2446
#1  0x00007d2c9999a9d6 in c10d::CommUCX::CommUCX (this=0x1229efe8, comm_size=2, logger=...) at /data/ZYH/torch_ucc/src/torch_ucc_comm.cpp:62
#2  0x00007d2c9992efba in c10d::Comm::Comm (this=0x1229efd0, logger_=..., oob_=std::shared_ptr<c10d::torch_ucc_oob_coll_info_t> (use count 4, weak count 0) = {...}, dev=..., is_health_check=false) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:336
#3  0x00007d2c9998dfd0 in std::_Construct<c10d::Comm, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (__p=0x1229efd0) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/stl_construct.h:119
#4  0x00007d2c9998a36c in std::allocator_traits<std::allocator<void> >::construct<c10d::Comm, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (__p=0x1229efd0) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/alloc_traits.h:635
#5  0x00007d2c9998494a in std::_Sp_counted_ptr_inplace<c10d::Comm, std::allocator<void>, (__gnu_cxx::_Lock_policy)2>::_Sp_counted_ptr_inplace<c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (this=0x1229efc0, __a=...) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr_base.h:604
#6  0x00007d2c9997b2d0 in std::__shared_count<(__gnu_cxx::_Lock_policy)2>::__shared_count<c10d::Comm, std::allocator<void>, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (this=0x7fffa58d5c88, __p=@0x7fffa58d5c80: 0x0, __a=...) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr_base.h:971
#7  0x00007d2c9996e535 in std::__shared_ptr<c10d::Comm, (__gnu_cxx::_Lock_policy)2>::__shared_ptr<std::allocator<void>, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (this=0x7fffa58d5c80, __tag=...) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr_base.h:1715
#8  0x00007d2c9995fb42 in std::shared_ptr<c10d::Comm>::shared_ptr<std::allocator<void>, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (this=0x7fffa58d5c80, __tag=...) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr.h:464
#9  0x00007d2c99949448 in std::make_shared<c10d::Comm, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> () at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr.h:1010
#10 0x00007d2c9992fc97 in c10d::Comm::get_comm (id=@0xa9b14f8: 0, dev=..., oob=std::shared_ptr<c10d::torch_ucc_oob_coll_info_t> (use count 4, weak count 0) = {...}, logger=..., is_health_check=false) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:407
#11 0x00007d2c9993e3b2 in c10d::ProcessGroupUCC::initComm (this=0xa9b13a0, dev=...) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:1873
#12 0x00007d2c9993d8d9 in c10d::ProcessGroupUCC::send (this=0xa9b13a0, tensors=std::vector of length 1, capacity 1 = {...}, dstRank=1, tag=0) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:1710
#13 0x00007d2dca343100 in pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}::operator()(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int) const (__closure=0x96f13f8, c=0xa9b13a0, args#0=std::vector of length 1, capacity 1 = {...}, args#1=1, args#2=0) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:136
#14 0x00007d2dca41dc91 in pybind11::detail::argument_loader<c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int>::call_impl<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&, 0ul, 1ul, 2ul, 3ul, pybind11::gil_scoped_release>(pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&, std::integer_sequence<unsigned long, 0ul, 1ul, 2ul, 3ul>, pybind11::gil_scoped_release&&) && (this=0x7fffa58d6340, f=...) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/cast.h:1631
#15 0x00007d2dca3e930e in pybind11::detail::argument_loader<c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int>::call<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, pybind11::gil_scoped_release, pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&>(pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&) && (this=0x7fffa58d6340, f=...) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/cast.h:1600
#16 0x00007d2dca39a925 in pybind11::cpp_function::initialize<pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&&, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (*)(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(pybind11::detail::function_call&)#1}::operator()(pybind11::detail::function_call&) const (__closure=0x0, call=...) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:278
#17 0x00007d2dca39ab46 in pybind11::cpp_function::initialize<pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&&, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (*)(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(pybind11::detail::function_call&)#1}::_FUN(pybind11::detail::function_call&) () at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:249
#18 0x00007d2dc8fe0da1 in pybind11::cpp_function::dispatcher (self=0x7d2c9bc16820, args_in=0x7d2dcbd4c400, kwargs_in=0x0) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:971
#19 0x0000000000528db7 in cfunction_call (func=0x7d2c9bc1b1a0, args=<optimized out>, kwargs=<optimized out>) at /usr/local/src/conda/python-3.11.13/Objects/methodobject.c:542
#20 0x000000000050454c in _PyObject_MakeTpCall (tstate=0x8a9518 <_PyRuntime+166328>, callable=0x7d2c9bc1b1a0, args=<optimized out>, nargs=<optimized out>, keywords=0x0) at /usr/local/src/conda/python-3.11.13/Objects/call.c:214
#21 0x0000000000511cf6 in _PyEval_EvalFrameDefault (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, frame=<optimized out>, frame@entry=0x7d2dcc5831e0, throwflag=throwflag@entry=0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:4769
#22 0x0000000000539503 in _PyEval_EvalFrame (throwflag=0, frame=0x7d2dcc5831e0, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Include/internal/pycore_ceval.h:73
#23 _PyEval_Vector (kwnames=<optimized out>, argcount=1, args=0x7d2d647caa78, locals=0x0, func=<optimized out>, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:6434
#24 _PyFunction_Vectorcall (func=<optimized out>, stack=0x7d2d647caa78, nargsf=<optimized out>, kwnames=<optimized out>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:393
#25 0x000000000054358c in _PyVectorcall_Call (kwargs=<optimized out>, tuple=<optimized out>, callable=0x7d2c9bcd13a0, func=0x539390 <_PyFunction_Vectorcall>, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:257
#26 _PyObject_Call (kwargs=<optimized out>, args=<optimized out>, callable=0x7d2c9bcd13a0, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:328
#27 PyObject_Call (callable=0x7d2c9bcd13a0, args=<optimized out>, kwargs=<optimized out>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:355
#28 0x0000000000515f58 in do_call_core (use_tracing=<optimized out>, kwdict=0x7d2c99b21b80, callargs=0x7d2dcc1be590, func=0x7d2c9bcd13a0, tstate=<optimized out>) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:7349
#29 _PyEval_EvalFrameDefault (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, frame=<optimized out>, frame@entry=0x7d2dcc583020, throwflag=throwflag@entry=0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:5376
#30 0x00000000005cd0aa in _PyEval_EvalFrame (throwflag=0, frame=0x7d2dcc583020, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Include/internal/pycore_ceval.h:73
#31 _PyEval_Vector (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, func=func@entry=0x7d2dcc1d60c0, locals=locals@entry=0x7d2dcc1f69c0, args=args@entry=0x0, argcount=argcount@entry=0, kwnames=kwnames@entry=0x0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:6434
#32 0x00000000005cc77f in PyEval_EvalCode (co=co@entry=0x7d2dcc1c8030, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:1148
#33 0x00000000005ed557 in run_eval_code_obj (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, co=co@entry=0x7d2dcc1c8030, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:1741
#34 0x00000000005e9080 in run_mod (mod=mod@entry=0x5431ae0, filename=filename@entry=0x7d2dcc1ff780, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0, flags=flags@entry=0x7fffa58d6dd8, arena=arena@entry=0x7d2dcc11b670) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:1762
#35 0x00000000005fde72 in pyrun_file (fp=fp@entry=0x53c05a0, filename=filename@entry=0x7d2dcc1ff780, start=start@entry=257, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0, closeit=closeit@entry=1, flags=0x7fffa58d6dd8) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:1657
#36 0x00000000005fd28f in _PyRun_SimpleFileObject (fp=0x53c05a0, filename=0x7d2dcc1ff780, closeit=1, flags=0x7fffa58d6dd8) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:440
#37 0x00000000005fcfb3 in _PyRun_AnyFileObject (fp=0x53c05a0, filename=filename@entry=0x7d2dcc1ff780, closeit=closeit@entry=1, flags=flags@entry=0x7fffa58d6dd8) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:79
#38 0x00000000005f7dae in pymain_run_file_obj (skip_source_first_line=0, filename=0x7d2dcc1ff780, program_name=0x7d2dcc1973b0) at /usr/local/src/conda/python-3.11.13/Modules/main.c:360
#39 pymain_run_file (config=0x88f560 <_PyRuntime+59904>) at /usr/local/src/conda/python-3.11.13/Modules/main.c:379
#40 pymain_run_python (exitcode=0x7fffa58d6dd0) at /usr/local/src/conda/python-3.11.13/Modules/main.c:605
#41 Py_RunMain () at /usr/local/src/conda/python-3.11.13/Modules/main.c:684
#42 0x00000000005bcdf9 in Py_BytesMain (argc=<optimized out>, argv=<optimized out>) at /usr/local/src/conda/python-3.11.13/Modules/main.c:738
#43 0x00007d2dcc22a1ca in __libc_start_call_main (main=main@entry=0x5bcd50 <main>, argc=argc@entry=3, argv=argv@entry=0x7fffa58d7038) at ../sysdeps/nptl/libc_start_call_main.h:58
#44 0x00007d2dcc22a28b in __libc_start_main_impl (main=0x5bcd50 <main>, argc=3, argv=0x7fffa58d7038, init=<optimized out>, fini=<optimized out>, rtld_fini=<optimized out>, stack_end=0x7fffa58d7028) at ../csu/libc-start.c:360
#45 0x00000000005bcc43 in _start ()
---
[HIT] uct_iface_open
#0  uct_iface_open (md=0x7d2d646ff520 <md>, worker=0x1229f530, params=0x7fffa58d4dd0, config=0xe0144a0, iface_p=0x1229f5e0) at base/uct_md.c:232
#1  0x00007d2c994a3fec in ucp_worker_iface_open (worker=0x122ff820, tl_id=0 '\000', wiface_p=0x122bdeb0) at core/ucp_worker.c:1408
#2  0x00007d2c994a1c5f in ucp_worker_add_resource_ifaces (worker=0x122ff820) at core/ucp_worker.c:1119
#3  0x00007d2c994a88d7 in ucp_worker_create (context=0x122a21e0, params=0x7fffa58d55c0, worker_p=0x1229f000) at core/ucp_worker.c:2595
#4  0x00007d2c9999a9d6 in c10d::CommUCX::CommUCX (this=0x1229efe8, comm_size=2, logger=...) at /data/ZYH/torch_ucc/src/torch_ucc_comm.cpp:62
#5  0x00007d2c9992efba in c10d::Comm::Comm (this=0x1229efd0, logger_=..., oob_=std::shared_ptr<c10d::torch_ucc_oob_coll_info_t> (use count 4, weak count 0) = {...}, dev=..., is_health_check=false) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:336
#6  0x00007d2c9998dfd0 in std::_Construct<c10d::Comm, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (__p=0x1229efd0) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/stl_construct.h:119
#7  0x00007d2c9998a36c in std::allocator_traits<std::allocator<void> >::construct<c10d::Comm, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (__p=0x1229efd0) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/alloc_traits.h:635
#8  0x00007d2c9998494a in std::_Sp_counted_ptr_inplace<c10d::Comm, std::allocator<void>, (__gnu_cxx::_Lock_policy)2>::_Sp_counted_ptr_inplace<c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (this=0x1229efc0, __a=...) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr_base.h:604
#9  0x00007d2c9997b2d0 in std::__shared_count<(__gnu_cxx::_Lock_policy)2>::__shared_count<c10d::Comm, std::allocator<void>, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (this=0x7fffa58d5c88, __p=@0x7fffa58d5c80: 0x0, __a=...) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr_base.h:971
#10 0x00007d2c9996e535 in std::__shared_ptr<c10d::Comm, (__gnu_cxx::_Lock_policy)2>::__shared_ptr<std::allocator<void>, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (this=0x7fffa58d5c80, __tag=...) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr_base.h:1715
#11 0x00007d2c9995fb42 in std::shared_ptr<c10d::Comm>::shared_ptr<std::allocator<void>, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (this=0x7fffa58d5c80, __tag=...) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr.h:464
#12 0x00007d2c99949448 in std::make_shared<c10d::Comm, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> () at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr.h:1010
#13 0x00007d2c9992fc97 in c10d::Comm::get_comm (id=@0xa9b14f8: 0, dev=..., oob=std::shared_ptr<c10d::torch_ucc_oob_coll_info_t> (use count 4, weak count 0) = {...}, logger=..., is_health_check=false) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:407
#14 0x00007d2c9993e3b2 in c10d::ProcessGroupUCC::initComm (this=0xa9b13a0, dev=...) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:1873
#15 0x00007d2c9993d8d9 in c10d::ProcessGroupUCC::send (this=0xa9b13a0, tensors=std::vector of length 1, capacity 1 = {...}, dstRank=1, tag=0) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:1710
#16 0x00007d2dca343100 in pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}::operator()(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int) const (__closure=0x96f13f8, c=0xa9b13a0, args#0=std::vector of length 1, capacity 1 = {...}, args#1=1, args#2=0) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:136
#17 0x00007d2dca41dc91 in pybind11::detail::argument_loader<c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int>::call_impl<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&, 0ul, 1ul, 2ul, 3ul, pybind11::gil_scoped_release>(pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&, std::integer_sequence<unsigned long, 0ul, 1ul, 2ul, 3ul>, pybind11::gil_scoped_release&&) && (this=0x7fffa58d6340, f=...) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/cast.h:1631
#18 0x00007d2dca3e930e in pybind11::detail::argument_loader<c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int>::call<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, pybind11::gil_scoped_release, pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&>(pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&) && (this=0x7fffa58d6340, f=...) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/cast.h:1600
#19 0x00007d2dca39a925 in pybind11::cpp_function::initialize<pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&&, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (*)(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(pybind11::detail::function_call&)#1}::operator()(pybind11::detail::function_call&) const (__closure=0x0, call=...) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:278
#20 0x00007d2dca39ab46 in pybind11::cpp_function::initialize<pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&&, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (*)(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(pybind11::detail::function_call&)#1}::_FUN(pybind11::detail::function_call&) () at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:249
#21 0x00007d2dc8fe0da1 in pybind11::cpp_function::dispatcher (self=0x7d2c9bc16820, args_in=0x7d2dcbd4c400, kwargs_in=0x0) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:971
#22 0x0000000000528db7 in cfunction_call (func=0x7d2c9bc1b1a0, args=<optimized out>, kwargs=<optimized out>) at /usr/local/src/conda/python-3.11.13/Objects/methodobject.c:542
#23 0x000000000050454c in _PyObject_MakeTpCall (tstate=0x8a9518 <_PyRuntime+166328>, callable=0x7d2c9bc1b1a0, args=<optimized out>, nargs=<optimized out>, keywords=0x0) at /usr/local/src/conda/python-3.11.13/Objects/call.c:214
#24 0x0000000000511cf6 in _PyEval_EvalFrameDefault (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, frame=<optimized out>, frame@entry=0x7d2dcc5831e0, throwflag=throwflag@entry=0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:4769
#25 0x0000000000539503 in _PyEval_EvalFrame (throwflag=0, frame=0x7d2dcc5831e0, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Include/internal/pycore_ceval.h:73
#26 _PyEval_Vector (kwnames=<optimized out>, argcount=1, args=0x7d2d647caa78, locals=0x0, func=<optimized out>, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:6434
#27 _PyFunction_Vectorcall (func=<optimized out>, stack=0x7d2d647caa78, nargsf=<optimized out>, kwnames=<optimized out>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:393
#28 0x000000000054358c in _PyVectorcall_Call (kwargs=<optimized out>, tuple=<optimized out>, callable=0x7d2c9bcd13a0, func=0x539390 <_PyFunction_Vectorcall>, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:257
#29 _PyObject_Call (kwargs=<optimized out>, args=<optimized out>, callable=0x7d2c9bcd13a0, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:328
#30 PyObject_Call (callable=0x7d2c9bcd13a0, args=<optimized out>, kwargs=<optimized out>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:355
#31 0x0000000000515f58 in do_call_core (use_tracing=<optimized out>, kwdict=0x7d2c99b21b80, callargs=0x7d2dcc1be590, func=0x7d2c9bcd13a0, tstate=<optimized out>) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:7349
#32 _PyEval_EvalFrameDefault (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, frame=<optimized out>, frame@entry=0x7d2dcc583020, throwflag=throwflag@entry=0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:5376
#33 0x00000000005cd0aa in _PyEval_EvalFrame (throwflag=0, frame=0x7d2dcc583020, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Include/internal/pycore_ceval.h:73
#34 _PyEval_Vector (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, func=func@entry=0x7d2dcc1d60c0, locals=locals@entry=0x7d2dcc1f69c0, args=args@entry=0x0, argcount=argcount@entry=0, kwnames=kwnames@entry=0x0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:6434
#35 0x00000000005cc77f in PyEval_EvalCode (co=co@entry=0x7d2dcc1c8030, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:1148
#36 0x00000000005ed557 in run_eval_code_obj (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, co=co@entry=0x7d2dcc1c8030, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:1741
#37 0x00000000005e9080 in run_mod (mod=mod@entry=0x5431ae0, filename=filename@entry=0x7d2dcc1ff780, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0, flags=flags@entry=0x7fffa58d6dd8, arena=arena@entry=0x7d2dcc11b670) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:1762
#38 0x00000000005fde72 in pyrun_file (fp=fp@entry=0x53c05a0, filename=filename@entry=0x7d2dcc1ff780, start=start@entry=257, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0, closeit=closeit@entry=1, flags=0x7fffa58d6dd8) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:1657
#39 0x00000000005fd28f in _PyRun_SimpleFileObject (fp=0x53c05a0, filename=0x7d2dcc1ff780, closeit=1, flags=0x7fffa58d6dd8) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:440
#40 0x00000000005fcfb3 in _PyRun_AnyFileObject (fp=0x53c05a0, filename=filename@entry=0x7d2dcc1ff780, closeit=closeit@entry=1, flags=flags@entry=0x7fffa58d6dd8) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:79
#41 0x00000000005f7dae in pymain_run_file_obj (skip_source_first_line=0, filename=0x7d2dcc1ff780, program_name=0x7d2dcc1973b0) at /usr/local/src/conda/python-3.11.13/Modules/main.c:360
#42 pymain_run_file (config=0x88f560 <_PyRuntime+59904>) at /usr/local/src/conda/python-3.11.13/Modules/main.c:379
#43 pymain_run_python (exitcode=0x7fffa58d6dd0) at /usr/local/src/conda/python-3.11.13/Modules/main.c:605
#44 Py_RunMain () at /usr/local/src/conda/python-3.11.13/Modules/main.c:684
#45 0x00000000005bcdf9 in Py_BytesMain (argc=<optimized out>, argv=<optimized out>) at /usr/local/src/conda/python-3.11.13/Modules/main.c:738
#46 0x00007d2dcc22a1ca in __libc_start_call_main (main=main@entry=0x5bcd50 <main>, argc=argc@entry=3, argv=argv@entry=0x7fffa58d7038) at ../sysdeps/nptl/libc_start_call_main.h:58
#47 0x00007d2dcc22a28b in __libc_start_main_impl (main=0x5bcd50 <main>, argc=3, argv=0x7fffa58d7038, init=<optimized out>, fini=<optimized out>, rtld_fini=<optimized out>, stack_end=0x7fffa58d7028) at ../csu/libc-start.c:360
#48 0x00000000005bcc43 in _start ()
---
[HIT] uct_iface_query
#0  uct_iface_query (iface=0x1229fa60, iface_attr=0x1229f5e8) at base/uct_iface.c:195
#1  0x00007d2c994a412c in ucp_worker_iface_open (worker=0x122ff820, tl_id=0 '\000', wiface_p=0x122bdeb0) at core/ucp_worker.c:1421
#2  0x00007d2c994a1c5f in ucp_worker_add_resource_ifaces (worker=0x122ff820) at core/ucp_worker.c:1119
#3  0x00007d2c994a88d7 in ucp_worker_create (context=0x122a21e0, params=0x7fffa58d55c0, worker_p=0x1229f000) at core/ucp_worker.c:2595
#4  0x00007d2c9999a9d6 in c10d::CommUCX::CommUCX (this=0x1229efe8, comm_size=2, logger=...) at /data/ZYH/torch_ucc/src/torch_ucc_comm.cpp:62
#5  0x00007d2c9992efba in c10d::Comm::Comm (this=0x1229efd0, logger_=..., oob_=std::shared_ptr<c10d::torch_ucc_oob_coll_info_t> (use count 4, weak count 0) = {...}, dev=..., is_health_check=false) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:336
#6  0x00007d2c9998dfd0 in std::_Construct<c10d::Comm, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (__p=0x1229efd0) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/stl_construct.h:119
#7  0x00007d2c9998a36c in std::allocator_traits<std::allocator<void> >::construct<c10d::Comm, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (__p=0x1229efd0) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/alloc_traits.h:635
#8  0x00007d2c9998494a in std::_Sp_counted_ptr_inplace<c10d::Comm, std::allocator<void>, (__gnu_cxx::_Lock_policy)2>::_Sp_counted_ptr_inplace<c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (this=0x1229efc0, __a=...) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr_base.h:604
#9  0x00007d2c9997b2d0 in std::__shared_count<(__gnu_cxx::_Lock_policy)2>::__shared_count<c10d::Comm, std::allocator<void>, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (this=0x7fffa58d5c88, __p=@0x7fffa58d5c80: 0x0, __a=...) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr_base.h:971
#10 0x00007d2c9996e535 in std::__shared_ptr<c10d::Comm, (__gnu_cxx::_Lock_policy)2>::__shared_ptr<std::allocator<void>, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (this=0x7fffa58d5c80, __tag=...) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr_base.h:1715
#11 0x00007d2c9995fb42 in std::shared_ptr<c10d::Comm>::shared_ptr<std::allocator<void>, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (this=0x7fffa58d5c80, __tag=...) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr.h:464
#12 0x00007d2c99949448 in std::make_shared<c10d::Comm, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> () at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr.h:1010
#13 0x00007d2c9992fc97 in c10d::Comm::get_comm (id=@0xa9b14f8: 0, dev=..., oob=std::shared_ptr<c10d::torch_ucc_oob_coll_info_t> (use count 4, weak count 0) = {...}, logger=..., is_health_check=false) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:407
#14 0x00007d2c9993e3b2 in c10d::ProcessGroupUCC::initComm (this=0xa9b13a0, dev=...) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:1873
#15 0x00007d2c9993d8d9 in c10d::ProcessGroupUCC::send (this=0xa9b13a0, tensors=std::vector of length 1, capacity 1 = {...}, dstRank=1, tag=0) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:1710
#16 0x00007d2dca343100 in pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}::operator()(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int) const (__closure=0x96f13f8, c=0xa9b13a0, args#0=std::vector of length 1, capacity 1 = {...}, args#1=1, args#2=0) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:136
#17 0x00007d2dca41dc91 in pybind11::detail::argument_loader<c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int>::call_impl<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&, 0ul, 1ul, 2ul, 3ul, pybind11::gil_scoped_release>(pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&, std::integer_sequence<unsigned long, 0ul, 1ul, 2ul, 3ul>, pybind11::gil_scoped_release&&) && (this=0x7fffa58d6340, f=...) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/cast.h:1631
#18 0x00007d2dca3e930e in pybind11::detail::argument_loader<c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int>::call<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, pybind11::gil_scoped_release, pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&>(pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&) && (this=0x7fffa58d6340, f=...) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/cast.h:1600
#19 0x00007d2dca39a925 in pybind11::cpp_function::initialize<pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&&, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (*)(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(pybind11::detail::function_call&)#1}::operator()(pybind11::detail::function_call&) const (__closure=0x0, call=...) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:278
#20 0x00007d2dca39ab46 in pybind11::cpp_function::initialize<pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&&, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (*)(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(pybind11::detail::function_call&)#1}::_FUN(pybind11::detail::function_call&) () at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:249
#21 0x00007d2dc8fe0da1 in pybind11::cpp_function::dispatcher (self=0x7d2c9bc16820, args_in=0x7d2dcbd4c400, kwargs_in=0x0) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:971
#22 0x0000000000528db7 in cfunction_call (func=0x7d2c9bc1b1a0, args=<optimized out>, kwargs=<optimized out>) at /usr/local/src/conda/python-3.11.13/Objects/methodobject.c:542
#23 0x000000000050454c in _PyObject_MakeTpCall (tstate=0x8a9518 <_PyRuntime+166328>, callable=0x7d2c9bc1b1a0, args=<optimized out>, nargs=<optimized out>, keywords=0x0) at /usr/local/src/conda/python-3.11.13/Objects/call.c:214
#24 0x0000000000511cf6 in _PyEval_EvalFrameDefault (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, frame=<optimized out>, frame@entry=0x7d2dcc5831e0, throwflag=throwflag@entry=0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:4769
#25 0x0000000000539503 in _PyEval_EvalFrame (throwflag=0, frame=0x7d2dcc5831e0, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Include/internal/pycore_ceval.h:73
#26 _PyEval_Vector (kwnames=<optimized out>, argcount=1, args=0x7d2d647caa78, locals=0x0, func=<optimized out>, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:6434
#27 _PyFunction_Vectorcall (func=<optimized out>, stack=0x7d2d647caa78, nargsf=<optimized out>, kwnames=<optimized out>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:393
#28 0x000000000054358c in _PyVectorcall_Call (kwargs=<optimized out>, tuple=<optimized out>, callable=0x7d2c9bcd13a0, func=0x539390 <_PyFunction_Vectorcall>, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:257
#29 _PyObject_Call (kwargs=<optimized out>, args=<optimized out>, callable=0x7d2c9bcd13a0, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:328
#30 PyObject_Call (callable=0x7d2c9bcd13a0, args=<optimized out>, kwargs=<optimized out>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:355
#31 0x0000000000515f58 in do_call_core (use_tracing=<optimized out>, kwdict=0x7d2c99b21b80, callargs=0x7d2dcc1be590, func=0x7d2c9bcd13a0, tstate=<optimized out>) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:7349
#32 _PyEval_EvalFrameDefault (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, frame=<optimized out>, frame@entry=0x7d2dcc583020, throwflag=throwflag@entry=0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:5376
#33 0x00000000005cd0aa in _PyEval_EvalFrame (throwflag=0, frame=0x7d2dcc583020, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Include/internal/pycore_ceval.h:73
#34 _PyEval_Vector (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, func=func@entry=0x7d2dcc1d60c0, locals=locals@entry=0x7d2dcc1f69c0, args=args@entry=0x0, argcount=argcount@entry=0, kwnames=kwnames@entry=0x0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:6434
#35 0x00000000005cc77f in PyEval_EvalCode (co=co@entry=0x7d2dcc1c8030, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:1148
#36 0x00000000005ed557 in run_eval_code_obj (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, co=co@entry=0x7d2dcc1c8030, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:1741
#37 0x00000000005e9080 in run_mod (mod=mod@entry=0x5431ae0, filename=filename@entry=0x7d2dcc1ff780, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0, flags=flags@entry=0x7fffa58d6dd8, arena=arena@entry=0x7d2dcc11b670) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:1762
#38 0x00000000005fde72 in pyrun_file (fp=fp@entry=0x53c05a0, filename=filename@entry=0x7d2dcc1ff780, start=start@entry=257, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0, closeit=closeit@entry=1, flags=0x7fffa58d6dd8) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:1657
#39 0x00000000005fd28f in _PyRun_SimpleFileObject (fp=0x53c05a0, filename=0x7d2dcc1ff780, closeit=1, flags=0x7fffa58d6dd8) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:440
#40 0x00000000005fcfb3 in _PyRun_AnyFileObject (fp=0x53c05a0, filename=filename@entry=0x7d2dcc1ff780, closeit=closeit@entry=1, flags=flags@entry=0x7fffa58d6dd8) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:79
#41 0x00000000005f7dae in pymain_run_file_obj (skip_source_first_line=0, filename=0x7d2dcc1ff780, program_name=0x7d2dcc1973b0) at /usr/local/src/conda/python-3.11.13/Modules/main.c:360
#42 pymain_run_file (config=0x88f560 <_PyRuntime+59904>) at /usr/local/src/conda/python-3.11.13/Modules/main.c:379
#43 pymain_run_python (exitcode=0x7fffa58d6dd0) at /usr/local/src/conda/python-3.11.13/Modules/main.c:605
#44 Py_RunMain () at /usr/local/src/conda/python-3.11.13/Modules/main.c:684
#45 0x00000000005bcdf9 in Py_BytesMain (argc=<optimized out>, argv=<optimized out>) at /usr/local/src/conda/python-3.11.13/Modules/main.c:738
#46 0x00007d2dcc22a1ca in __libc_start_call_main (main=main@entry=0x5bcd50 <main>, argc=argc@entry=3, argv=argv@entry=0x7fffa58d7038) at ../sysdeps/nptl/libc_start_call_main.h:58
#47 0x00007d2dcc22a28b in __libc_start_main_impl (main=0x5bcd50 <main>, argc=3, argv=0x7fffa58d7038, init=<optimized out>, fini=<optimized out>, rtld_fini=<optimized out>, stack_end=0x7fffa58d7028) at ../csu/libc-start.c:360
#48 0x00000000005bcc43 in _start ()
---
[HIT] uct_md_mem_reg
#0  uct_md_mem_reg (md=0x122b5610, address=0x7d2d467d2000, length=151552, flags=772, memh_p=0x7fffa58d49d0) at base/uct_md.c:566
#1  0x00007d2d646b0614 in uct_iface_mem_alloc (tl_iface=0x12340430, length=147568, flags=772, name=0xdd14de0 "ud_recv_skb", mem=0x7fffa58d49b0) at base/uct_mem.c:409
#2  0x00007d2d646b0830 in uct_iface_mp_chunk_alloc_inner (chunk_p=0x7fffa58d4a28, size_p=0x7fffa58d4a20, mp=0x12340a08) at base/uct_mem.c:457
#3  uct_iface_mp_chunk_alloc (mp=0x12340a08, size_p=0x7fffa58d4a20, chunk_p=0x7fffa58d4a28) at base/uct_mem.c:446
#4  0x00007d2d71896826 in ucs_mpool_grow (mp=0x12340a08, num_elems=128) at datastruct/mpool.c:266
#5  0x00007d2d3e1cb250 in uct_ud_iface_t_init (self=0x12340430, _myclass=0x7d2d3e1fe780 <uct_ud_iface_t_class>, _init_count=0x7fffa58d4cac, ops=0x7d2d3e1fed20 <uct_ud_verbs_iface_ops>, tl_ops=0x7d2d3e1fede0 <uct_ud_verbs_iface_tl_ops>, md=0x122b5610, worker=0x1229f530, params=0x7fffa58d4dd0, config=0x123224e0, init_attr=0x7fffa58d4c10) at ud/base/ud_iface.c:527
#6  0x00007d2d3e1e544b in uct_ud_verbs_iface_t_init (self=0x12340430, _myclass=0x7d2d3e1fef80 <uct_ud_verbs_iface_t_class>, _init_count=0x7fffa58d4cac, md=0x122b5610, worker=0x1229f530, params=0x7fffa58d4dd0, tl_config=0x123224e0) at ud/verbs/ud_verbs.c:761
#7  0x00007d2d3e1e584c in uct_ud_verbs_iface_t_new (arg0=0x122b5610, arg1=0x1229f530, arg2=0x7fffa58d4dd0, arg3=0x123224e0, obj_p=0x12325570) at ud/verbs/ud_verbs.c:827
#8  0x00007d2d646ad64b in uct_iface_open (md=0x122b5610, worker=0x1229f530, params=0x7fffa58d4dd0, config=0x123224e0, iface_p=0x12325570) at base/uct_md.c:250
#9  0x00007d2c994a3fec in ucp_worker_iface_open (worker=0x122ff820, tl_id=6 '\006', wiface_p=0x122bdee0) at core/ucp_worker.c:1408
#10 0x00007d2c994a1c5f in ucp_worker_add_resource_ifaces (worker=0x122ff820) at core/ucp_worker.c:1119
#11 0x00007d2c994a88d7 in ucp_worker_create (context=0x122a21e0, params=0x7fffa58d55c0, worker_p=0x1229f000) at core/ucp_worker.c:2595
#12 0x00007d2c9999a9d6 in c10d::CommUCX::CommUCX (this=0x1229efe8, comm_size=2, logger=...) at /data/ZYH/torch_ucc/src/torch_ucc_comm.cpp:62
#13 0x00007d2c9992efba in c10d::Comm::Comm (this=0x1229efd0, logger_=..., oob_=std::shared_ptr<c10d::torch_ucc_oob_coll_info_t> (use count 4, weak count 0) = {...}, dev=..., is_health_check=false) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:336
#14 0x00007d2c9998dfd0 in std::_Construct<c10d::Comm, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (__p=0x1229efd0) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/stl_construct.h:119
#15 0x00007d2c9998a36c in std::allocator_traits<std::allocator<void> >::construct<c10d::Comm, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (__p=0x1229efd0) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/alloc_traits.h:635
#16 0x00007d2c9998494a in std::_Sp_counted_ptr_inplace<c10d::Comm, std::allocator<void>, (__gnu_cxx::_Lock_policy)2>::_Sp_counted_ptr_inplace<c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (this=0x1229efc0, __a=...) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr_base.h:604
#17 0x00007d2c9997b2d0 in std::__shared_count<(__gnu_cxx::_Lock_policy)2>::__shared_count<c10d::Comm, std::allocator<void>, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (this=0x7fffa58d5c88, __p=@0x7fffa58d5c80: 0x0, __a=...) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr_base.h:971
#18 0x00007d2c9996e535 in std::__shared_ptr<c10d::Comm, (__gnu_cxx::_Lock_policy)2>::__shared_ptr<std::allocator<void>, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (this=0x7fffa58d5c80, __tag=...) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr_base.h:1715
#19 0x00007d2c9995fb42 in std::shared_ptr<c10d::Comm>::shared_ptr<std::allocator<void>, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (this=0x7fffa58d5c80, __tag=...) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr.h:464
#20 0x00007d2c99949448 in std::make_shared<c10d::Comm, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> () at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr.h:1010
#21 0x00007d2c9992fc97 in c10d::Comm::get_comm (id=@0xa9b14f8: 0, dev=..., oob=std::shared_ptr<c10d::torch_ucc_oob_coll_info_t> (use count 4, weak count 0) = {...}, logger=..., is_health_check=false) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:407
#22 0x00007d2c9993e3b2 in c10d::ProcessGroupUCC::initComm (this=0xa9b13a0, dev=...) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:1873
#23 0x00007d2c9993d8d9 in c10d::ProcessGroupUCC::send (this=0xa9b13a0, tensors=std::vector of length 1, capacity 1 = {...}, dstRank=1, tag=0) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:1710
#24 0x00007d2dca343100 in pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}::operator()(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int) const (__closure=0x96f13f8, c=0xa9b13a0, args#0=std::vector of length 1, capacity 1 = {...}, args#1=1, args#2=0) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:136
#25 0x00007d2dca41dc91 in pybind11::detail::argument_loader<c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int>::call_impl<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&, 0ul, 1ul, 2ul, 3ul, pybind11::gil_scoped_release>(pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&, std::integer_sequence<unsigned long, 0ul, 1ul, 2ul, 3ul>, pybind11::gil_scoped_release&&) && (this=0x7fffa58d6340, f=...) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/cast.h:1631
#26 0x00007d2dca3e930e in pybind11::detail::argument_loader<c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int>::call<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, pybind11::gil_scoped_release, pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&>(pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&) && (this=0x7fffa58d6340, f=...) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/cast.h:1600
#27 0x00007d2dca39a925 in pybind11::cpp_function::initialize<pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&&, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (*)(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(pybind11::detail::function_call&)#1}::operator()(pybind11::detail::function_call&) const (__closure=0x0, call=...) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:278
#28 0x00007d2dca39ab46 in pybind11::cpp_function::initialize<pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&&, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (*)(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(pybind11::detail::function_call&)#1}::_FUN(pybind11::detail::function_call&) () at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:249
#29 0x00007d2dc8fe0da1 in pybind11::cpp_function::dispatcher (self=0x7d2c9bc16820, args_in=0x7d2dcbd4c400, kwargs_in=0x0) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:971
#30 0x0000000000528db7 in cfunction_call (func=0x7d2c9bc1b1a0, args=<optimized out>, kwargs=<optimized out>) at /usr/local/src/conda/python-3.11.13/Objects/methodobject.c:542
#31 0x000000000050454c in _PyObject_MakeTpCall (tstate=0x8a9518 <_PyRuntime+166328>, callable=0x7d2c9bc1b1a0, args=<optimized out>, nargs=<optimized out>, keywords=0x0) at /usr/local/src/conda/python-3.11.13/Objects/call.c:214
#32 0x0000000000511cf6 in _PyEval_EvalFrameDefault (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, frame=<optimized out>, frame@entry=0x7d2dcc5831e0, throwflag=throwflag@entry=0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:4769
#33 0x0000000000539503 in _PyEval_EvalFrame (throwflag=0, frame=0x7d2dcc5831e0, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Include/internal/pycore_ceval.h:73
#34 _PyEval_Vector (kwnames=<optimized out>, argcount=1, args=0x7d2d647caa78, locals=0x0, func=<optimized out>, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:6434
#35 _PyFunction_Vectorcall (func=<optimized out>, stack=0x7d2d647caa78, nargsf=<optimized out>, kwnames=<optimized out>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:393
#36 0x000000000054358c in _PyVectorcall_Call (kwargs=<optimized out>, tuple=<optimized out>, callable=0x7d2c9bcd13a0, func=0x539390 <_PyFunction_Vectorcall>, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:257
#37 _PyObject_Call (kwargs=<optimized out>, args=<optimized out>, callable=0x7d2c9bcd13a0, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:328
#38 PyObject_Call (callable=0x7d2c9bcd13a0, args=<optimized out>, kwargs=<optimized out>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:355
#39 0x0000000000515f58 in do_call_core (use_tracing=<optimized out>, kwdict=0x7d2c99b21b80, callargs=0x7d2dcc1be590, func=0x7d2c9bcd13a0, tstate=<optimized out>) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:7349
#40 _PyEval_EvalFrameDefault (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, frame=<optimized out>, frame@entry=0x7d2dcc583020, throwflag=throwflag@entry=0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:5376
#41 0x00000000005cd0aa in _PyEval_EvalFrame (throwflag=0, frame=0x7d2dcc583020, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Include/internal/pycore_ceval.h:73
#42 _PyEval_Vector (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, func=func@entry=0x7d2dcc1d60c0, locals=locals@entry=0x7d2dcc1f69c0, args=args@entry=0x0, argcount=argcount@entry=0, kwnames=kwnames@entry=0x0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:6434
#43 0x00000000005cc77f in PyEval_EvalCode (co=co@entry=0x7d2dcc1c8030, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:1148
#44 0x00000000005ed557 in run_eval_code_obj (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, co=co@entry=0x7d2dcc1c8030, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:1741
#45 0x00000000005e9080 in run_mod (mod=mod@entry=0x5431ae0, filename=filename@entry=0x7d2dcc1ff780, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0, flags=flags@entry=0x7fffa58d6dd8, arena=arena@entry=0x7d2dcc11b670) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:1762
#46 0x00000000005fde72 in pyrun_file (fp=fp@entry=0x53c05a0, filename=filename@entry=0x7d2dcc1ff780, start=start@entry=257, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0, closeit=closeit@entry=1, flags=0x7fffa58d6dd8) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:1657
#47 0x00000000005fd28f in _PyRun_SimpleFileObject (fp=0x53c05a0, filename=0x7d2dcc1ff780, closeit=1, flags=0x7fffa58d6dd8) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:440
#48 0x00000000005fcfb3 in _PyRun_AnyFileObject (fp=0x53c05a0, filename=filename@entry=0x7d2dcc1ff780, closeit=closeit@entry=1, flags=flags@entry=0x7fffa58d6dd8) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:79
#49 0x00000000005f7dae in pymain_run_file_obj (skip_source_first_line=0, filename=0x7d2dcc1ff780, program_name=0x7d2dcc1973b0) at /usr/local/src/conda/python-3.11.13/Modules/main.c:360
---
[HIT] uct_ep_create
#0  uct_ep_create (params=0x7fffa58d4640, ep_p=0x7fffa58d45e0) at base/uct_iface.c:725
#1  0x00007d2c996647ea in ucp_wireup_connect_lane_to_iface (ep=0x7d2d430e0000, lane=0 '\000', path_index=0, wiface=0x12322cd0, address=0x12a23030) at wireup/wireup.c:1054
#2  0x00007d2c99665c8f in ucp_wireup_connect_lane (ep=0x7d2d430e0000, ep_init_flags=65, lane=0 '\000', path_index=0, remote_address=0x7fffa58d5270, addr_index=0) at wireup/wireup.c:1178
#3  0x00007d2c996692e1 in ucp_wireup_init_lanes (ep=0x7d2d430e0000, ep_init_flags=65, local_tl_bitmap=0x7d2c9967b0f0 <ucp_tl_bitmap_max>, remote_address=0x7fffa58d5270, addr_indices=0x7fffa58d52b0) at wireup/wireup.c:1751
#4  0x00007d2c9946ad3d in ucp_ep_create_to_worker_addr (worker=0x122ff820, local_tl_bitmap=0x7d2c9967b0f0 <ucp_tl_bitmap_max>, remote_address=0x7fffa58d5270, ep_init_flags=65, message=0x7fffa58d53b0 "mem_type_ep:cuda", addr_indices=0x7fffa58d52b0, ep_p=0x122ffc88) at core/ucp_ep.c:838
#5  0x00007d2c9946a1e7 in ucp_worker_mem_type_eps_create (worker=0x122ff820) at core/ucp_ep.c:714
#6  0x00007d2c994a8915 in ucp_worker_create (context=0x122a21e0, params=0x7fffa58d55c0, worker_p=0x1229f000) at core/ucp_worker.c:2607
#7  0x00007d2c9999a9d6 in c10d::CommUCX::CommUCX (this=0x1229efe8, comm_size=2, logger=...) at /data/ZYH/torch_ucc/src/torch_ucc_comm.cpp:62
#8  0x00007d2c9992efba in c10d::Comm::Comm (this=0x1229efd0, logger_=..., oob_=std::shared_ptr<c10d::torch_ucc_oob_coll_info_t> (use count 4, weak count 0) = {...}, dev=..., is_health_check=false) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:336
#9  0x00007d2c9998dfd0 in std::_Construct<c10d::Comm, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (__p=0x1229efd0) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/stl_construct.h:119
#10 0x00007d2c9998a36c in std::allocator_traits<std::allocator<void> >::construct<c10d::Comm, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (__p=0x1229efd0) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/alloc_traits.h:635
#11 0x00007d2c9998494a in std::_Sp_counted_ptr_inplace<c10d::Comm, std::allocator<void>, (__gnu_cxx::_Lock_policy)2>::_Sp_counted_ptr_inplace<c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (this=0x1229efc0, __a=...) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr_base.h:604
#12 0x00007d2c9997b2d0 in std::__shared_count<(__gnu_cxx::_Lock_policy)2>::__shared_count<c10d::Comm, std::allocator<void>, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (this=0x7fffa58d5c88, __p=@0x7fffa58d5c80: 0x0, __a=...) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr_base.h:971
#13 0x00007d2c9996e535 in std::__shared_ptr<c10d::Comm, (__gnu_cxx::_Lock_policy)2>::__shared_ptr<std::allocator<void>, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (this=0x7fffa58d5c80, __tag=...) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr_base.h:1715
#14 0x00007d2c9995fb42 in std::shared_ptr<c10d::Comm>::shared_ptr<std::allocator<void>, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (this=0x7fffa58d5c80, __tag=...) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr.h:464
#15 0x00007d2c99949448 in std::make_shared<c10d::Comm, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> () at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr.h:1010
#16 0x00007d2c9992fc97 in c10d::Comm::get_comm (id=@0xa9b14f8: 0, dev=..., oob=std::shared_ptr<c10d::torch_ucc_oob_coll_info_t> (use count 4, weak count 0) = {...}, logger=..., is_health_check=false) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:407
#17 0x00007d2c9993e3b2 in c10d::ProcessGroupUCC::initComm (this=0xa9b13a0, dev=...) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:1873
#18 0x00007d2c9993d8d9 in c10d::ProcessGroupUCC::send (this=0xa9b13a0, tensors=std::vector of length 1, capacity 1 = {...}, dstRank=1, tag=0) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:1710
#19 0x00007d2dca343100 in pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}::operator()(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int) const (__closure=0x96f13f8, c=0xa9b13a0, args#0=std::vector of length 1, capacity 1 = {...}, args#1=1, args#2=0) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:136
#20 0x00007d2dca41dc91 in pybind11::detail::argument_loader<c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int>::call_impl<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&, 0ul, 1ul, 2ul, 3ul, pybind11::gil_scoped_release>(pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&, std::integer_sequence<unsigned long, 0ul, 1ul, 2ul, 3ul>, pybind11::gil_scoped_release&&) && (this=0x7fffa58d6340, f=...) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/cast.h:1631
#21 0x00007d2dca3e930e in pybind11::detail::argument_loader<c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int>::call<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, pybind11::gil_scoped_release, pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&>(pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&) && (this=0x7fffa58d6340, f=...) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/cast.h:1600
#22 0x00007d2dca39a925 in pybind11::cpp_function::initialize<pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&&, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (*)(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(pybind11::detail::function_call&)#1}::operator()(pybind11::detail::function_call&) const (__closure=0x0, call=...) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:278
#23 0x00007d2dca39ab46 in pybind11::cpp_function::initialize<pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&&, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (*)(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(pybind11::detail::function_call&)#1}::_FUN(pybind11::detail::function_call&) () at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:249
#24 0x00007d2dc8fe0da1 in pybind11::cpp_function::dispatcher (self=0x7d2c9bc16820, args_in=0x7d2dcbd4c400, kwargs_in=0x0) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:971
#25 0x0000000000528db7 in cfunction_call (func=0x7d2c9bc1b1a0, args=<optimized out>, kwargs=<optimized out>) at /usr/local/src/conda/python-3.11.13/Objects/methodobject.c:542
#26 0x000000000050454c in _PyObject_MakeTpCall (tstate=0x8a9518 <_PyRuntime+166328>, callable=0x7d2c9bc1b1a0, args=<optimized out>, nargs=<optimized out>, keywords=0x0) at /usr/local/src/conda/python-3.11.13/Objects/call.c:214
#27 0x0000000000511cf6 in _PyEval_EvalFrameDefault (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, frame=<optimized out>, frame@entry=0x7d2dcc5831e0, throwflag=throwflag@entry=0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:4769
#28 0x0000000000539503 in _PyEval_EvalFrame (throwflag=0, frame=0x7d2dcc5831e0, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Include/internal/pycore_ceval.h:73
#29 _PyEval_Vector (kwnames=<optimized out>, argcount=1, args=0x7d2d647caa78, locals=0x0, func=<optimized out>, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:6434
#30 _PyFunction_Vectorcall (func=<optimized out>, stack=0x7d2d647caa78, nargsf=<optimized out>, kwnames=<optimized out>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:393
#31 0x000000000054358c in _PyVectorcall_Call (kwargs=<optimized out>, tuple=<optimized out>, callable=0x7d2c9bcd13a0, func=0x539390 <_PyFunction_Vectorcall>, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:257
#32 _PyObject_Call (kwargs=<optimized out>, args=<optimized out>, callable=0x7d2c9bcd13a0, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:328
#33 PyObject_Call (callable=0x7d2c9bcd13a0, args=<optimized out>, kwargs=<optimized out>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:355
#34 0x0000000000515f58 in do_call_core (use_tracing=<optimized out>, kwdict=0x7d2c99b21b80, callargs=0x7d2dcc1be590, func=0x7d2c9bcd13a0, tstate=<optimized out>) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:7349
#35 _PyEval_EvalFrameDefault (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, frame=<optimized out>, frame@entry=0x7d2dcc583020, throwflag=throwflag@entry=0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:5376
#36 0x00000000005cd0aa in _PyEval_EvalFrame (throwflag=0, frame=0x7d2dcc583020, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Include/internal/pycore_ceval.h:73
#37 _PyEval_Vector (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, func=func@entry=0x7d2dcc1d60c0, locals=locals@entry=0x7d2dcc1f69c0, args=args@entry=0x0, argcount=argcount@entry=0, kwnames=kwnames@entry=0x0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:6434
#38 0x00000000005cc77f in PyEval_EvalCode (co=co@entry=0x7d2dcc1c8030, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:1148
#39 0x00000000005ed557 in run_eval_code_obj (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, co=co@entry=0x7d2dcc1c8030, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:1741
#40 0x00000000005e9080 in run_mod (mod=mod@entry=0x5431ae0, filename=filename@entry=0x7d2dcc1ff780, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0, flags=flags@entry=0x7fffa58d6dd8, arena=arena@entry=0x7d2dcc11b670) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:1762
#41 0x00000000005fde72 in pyrun_file (fp=fp@entry=0x53c05a0, filename=filename@entry=0x7d2dcc1ff780, start=start@entry=257, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0, closeit=closeit@entry=1, flags=0x7fffa58d6dd8) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:1657
#42 0x00000000005fd28f in _PyRun_SimpleFileObject (fp=0x53c05a0, filename=0x7d2dcc1ff780, closeit=1, flags=0x7fffa58d6dd8) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:440
#43 0x00000000005fcfb3 in _PyRun_AnyFileObject (fp=0x53c05a0, filename=filename@entry=0x7d2dcc1ff780, closeit=closeit@entry=1, flags=flags@entry=0x7fffa58d6dd8) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:79
#44 0x00000000005f7dae in pymain_run_file_obj (skip_source_first_line=0, filename=0x7d2dcc1ff780, program_name=0x7d2dcc1973b0) at /usr/local/src/conda/python-3.11.13/Modules/main.c:360
#45 pymain_run_file (config=0x88f560 <_PyRuntime+59904>) at /usr/local/src/conda/python-3.11.13/Modules/main.c:379
#46 pymain_run_python (exitcode=0x7fffa58d6dd0) at /usr/local/src/conda/python-3.11.13/Modules/main.c:605
#47 Py_RunMain () at /usr/local/src/conda/python-3.11.13/Modules/main.c:684
#48 0x00000000005bcdf9 in Py_BytesMain (argc=<optimized out>, argv=<optimized out>) at /usr/local/src/conda/python-3.11.13/Modules/main.c:738
#49 0x00007d2dcc22a1ca in __libc_start_call_main (main=main@entry=0x5bcd50 <main>, argc=argc@entry=3, argv=argv@entry=0x7fffa58d7038) at ../sysdeps/nptl/libc_start_call_main.h:58
---
[HIT] ucp_context_destroy
#0  ucp_lib_query (attr=0x7fffa58d5290) at core/ucp_context.c:2409
#1  0x00007d2c99aa43ea in ucc_tl_ucp_get_lib_attr (lib=0x0, base_attr=0x7fffa58d52f0) at tl_ucp_lib.c:95
#2  0x00007d2d467a7d19 in check_tl_lib_attr (lib=0x12a3bfc0, tl_iface=0x7d2c99b14560 <ucc_tl_ucp>, attr=0x12a3beb0) at cl_basic_lib.c:39
#3  0x00007d2d467a7fa4 in ucc_cl_basic_get_lib_attr (lib=0x12a3bfc0, base_attr=0x12a3beb0) at cl_basic_lib.c:87
#4  0x00007d2da8bc45e6 in ucc_cl_lib_init (user_params=0x7fffa58d5580, config=0x12a3b730, lib=0x12a3be30) at core/ucc_lib.c:143
#5  0x00007d2da8bc51d2 in ucc_init_version (api_major_version=1, api_minor_version=5, params=0x7fffa58d5580, config=0x12a3b730, lib_p=0x1229f018) at core/ucc_lib.c:349
#6  0x00007d2c99999d83 in ucc_init (params=0x7fffa58d5580, config=0x12a3b730, lib_p=0x1229f018) at /data/ZYH/ucc/install/include/ucc/api/ucc.h:783
#7  0x00007d2c9999cb7b in c10d::CommUCC::CommUCC (this=0x1229f008, oob=std::shared_ptr<c10d::torch_ucc_oob_coll_info_t> (use count 5, weak count 0) = {...}, logger=...) at /data/ZYH/torch_ucc/src/torch_ucc_comm.cpp:189
#8  0x00007d2c9992eff1 in c10d::Comm::Comm (this=0x1229efd0, logger_=..., oob_=std::shared_ptr<c10d::torch_ucc_oob_coll_info_t> (use count 5, weak count 0) = {...}, dev=..., is_health_check=false) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:338
#9  0x00007d2c9998dfd0 in std::_Construct<c10d::Comm, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (__p=0x1229efd0) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/stl_construct.h:119
#10 0x00007d2c9998a36c in std::allocator_traits<std::allocator<void> >::construct<c10d::Comm, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (__p=0x1229efd0) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/alloc_traits.h:635
#11 0x00007d2c9998494a in std::_Sp_counted_ptr_inplace<c10d::Comm, std::allocator<void>, (__gnu_cxx::_Lock_policy)2>::_Sp_counted_ptr_inplace<c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (this=0x1229efc0, __a=...) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr_base.h:604
#12 0x00007d2c9997b2d0 in std::__shared_count<(__gnu_cxx::_Lock_policy)2>::__shared_count<c10d::Comm, std::allocator<void>, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (this=0x7fffa58d5c88, __p=@0x7fffa58d5c80: 0x0, __a=...) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr_base.h:971
#13 0x00007d2c9996e535 in std::__shared_ptr<c10d::Comm, (__gnu_cxx::_Lock_policy)2>::__shared_ptr<std::allocator<void>, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (this=0x7fffa58d5c80, __tag=...) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr_base.h:1715
#14 0x00007d2c9995fb42 in std::shared_ptr<c10d::Comm>::shared_ptr<std::allocator<void>, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (this=0x7fffa58d5c80, __tag=...) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr.h:464
#15 0x00007d2c99949448 in std::make_shared<c10d::Comm, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> () at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr.h:1010
#16 0x00007d2c9992fc97 in c10d::Comm::get_comm (id=@0xa9b14f8: 0, dev=..., oob=std::shared_ptr<c10d::torch_ucc_oob_coll_info_t> (use count 5, weak count 0) = {...}, logger=..., is_health_check=false) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:407
#17 0x00007d2c9993e3b2 in c10d::ProcessGroupUCC::initComm (this=0xa9b13a0, dev=...) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:1873
#18 0x00007d2c9993d8d9 in c10d::ProcessGroupUCC::send (this=0xa9b13a0, tensors=std::vector of length 1, capacity 1 = {...}, dstRank=1, tag=0) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:1710
#19 0x00007d2dca343100 in pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}::operator()(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int) const (__closure=0x96f13f8, c=0xa9b13a0, args#0=std::vector of length 1, capacity 1 = {...}, args#1=1, args#2=0) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:136
#20 0x00007d2dca41dc91 in pybind11::detail::argument_loader<c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int>::call_impl<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&, 0ul, 1ul, 2ul, 3ul, pybind11::gil_scoped_release>(pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&, std::integer_sequence<unsigned long, 0ul, 1ul, 2ul, 3ul>, pybind11::gil_scoped_release&&) && (this=0x7fffa58d6340, f=...) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/cast.h:1631
#21 0x00007d2dca3e930e in pybind11::detail::argument_loader<c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int>::call<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, pybind11::gil_scoped_release, pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&>(pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&) && (this=0x7fffa58d6340, f=...) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/cast.h:1600
#22 0x00007d2dca39a925 in pybind11::cpp_function::initialize<pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&&, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (*)(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(pybind11::detail::function_call&)#1}::operator()(pybind11::detail::function_call&) const (__closure=0x0, call=...) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:278
#23 0x00007d2dca39ab46 in pybind11::cpp_function::initialize<pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&&, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (*)(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(pybind11::detail::function_call&)#1}::_FUN(pybind11::detail::function_call&) () at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:249
#24 0x00007d2dc8fe0da1 in pybind11::cpp_function::dispatcher (self=0x7d2c9bc16820, args_in=0x7d2dcbd4c400, kwargs_in=0x0) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:971
#25 0x0000000000528db7 in cfunction_call (func=0x7d2c9bc1b1a0, args=<optimized out>, kwargs=<optimized out>) at /usr/local/src/conda/python-3.11.13/Objects/methodobject.c:542
#26 0x000000000050454c in _PyObject_MakeTpCall (tstate=0x8a9518 <_PyRuntime+166328>, callable=0x7d2c9bc1b1a0, args=<optimized out>, nargs=<optimized out>, keywords=0x0) at /usr/local/src/conda/python-3.11.13/Objects/call.c:214
#27 0x0000000000511cf6 in _PyEval_EvalFrameDefault (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, frame=<optimized out>, frame@entry=0x7d2dcc5831e0, throwflag=throwflag@entry=0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:4769
#28 0x0000000000539503 in _PyEval_EvalFrame (throwflag=0, frame=0x7d2dcc5831e0, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Include/internal/pycore_ceval.h:73
#29 _PyEval_Vector (kwnames=<optimized out>, argcount=1, args=0x7d2d647caa78, locals=0x0, func=<optimized out>, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:6434
#30 _PyFunction_Vectorcall (func=<optimized out>, stack=0x7d2d647caa78, nargsf=<optimized out>, kwnames=<optimized out>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:393
#31 0x000000000054358c in _PyVectorcall_Call (kwargs=<optimized out>, tuple=<optimized out>, callable=0x7d2c9bcd13a0, func=0x539390 <_PyFunction_Vectorcall>, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:257
#32 _PyObject_Call (kwargs=<optimized out>, args=<optimized out>, callable=0x7d2c9bcd13a0, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:328
#33 PyObject_Call (callable=0x7d2c9bcd13a0, args=<optimized out>, kwargs=<optimized out>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:355
#34 0x0000000000515f58 in do_call_core (use_tracing=<optimized out>, kwdict=0x7d2c99b21b80, callargs=0x7d2dcc1be590, func=0x7d2c9bcd13a0, tstate=<optimized out>) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:7349
#35 _PyEval_EvalFrameDefault (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, frame=<optimized out>, frame@entry=0x7d2dcc583020, throwflag=throwflag@entry=0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:5376
#36 0x00000000005cd0aa in _PyEval_EvalFrame (throwflag=0, frame=0x7d2dcc583020, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Include/internal/pycore_ceval.h:73
#37 _PyEval_Vector (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, func=func@entry=0x7d2dcc1d60c0, locals=locals@entry=0x7d2dcc1f69c0, args=args@entry=0x0, argcount=argcount@entry=0, kwnames=kwnames@entry=0x0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:6434
#38 0x00000000005cc77f in PyEval_EvalCode (co=co@entry=0x7d2dcc1c8030, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:1148
#39 0x00000000005ed557 in run_eval_code_obj (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, co=co@entry=0x7d2dcc1c8030, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:1741
#40 0x00000000005e9080 in run_mod (mod=mod@entry=0x5431ae0, filename=filename@entry=0x7d2dcc1ff780, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0, flags=flags@entry=0x7fffa58d6dd8, arena=arena@entry=0x7d2dcc11b670) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:1762
#41 0x00000000005fde72 in pyrun_file (fp=fp@entry=0x53c05a0, filename=filename@entry=0x7d2dcc1ff780, start=start@entry=257, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0, closeit=closeit@entry=1, flags=0x7fffa58d6dd8) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:1657
#42 0x00000000005fd28f in _PyRun_SimpleFileObject (fp=0x53c05a0, filename=0x7d2dcc1ff780, closeit=1, flags=0x7fffa58d6dd8) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:440
#43 0x00000000005fcfb3 in _PyRun_AnyFileObject (fp=0x53c05a0, filename=filename@entry=0x7d2dcc1ff780, closeit=closeit@entry=1, flags=flags@entry=0x7fffa58d6dd8) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:79
#44 0x00000000005f7dae in pymain_run_file_obj (skip_source_first_line=0, filename=0x7d2dcc1ff780, program_name=0x7d2dcc1973b0) at /usr/local/src/conda/python-3.11.13/Modules/main.c:360
#45 pymain_run_file (config=0x88f560 <_PyRuntime+59904>) at /usr/local/src/conda/python-3.11.13/Modules/main.c:379
#46 pymain_run_python (exitcode=0x7fffa58d6dd0) at /usr/local/src/conda/python-3.11.13/Modules/main.c:605
#47 Py_RunMain () at /usr/local/src/conda/python-3.11.13/Modules/main.c:684
#48 0x00000000005bcdf9 in Py_BytesMain (argc=<optimized out>, argv=<optimized out>) at /usr/local/src/conda/python-3.11.13/Modules/main.c:738
#49 0x00007d2dcc22a1ca in __libc_start_call_main (main=main@entry=0x5bcd50 <main>, argc=argc@entry=3, argv=argv@entry=0x7fffa58d7038) at ../sysdeps/nptl/libc_start_call_main.h:58
---
[HIT] ucp_worker_get_address
#0  ucp_worker_get_address (worker=0x12aa0c40, address_p=0x122ade80, address_length_p=0x122ade78) at core/ucp_worker.c:3260
#1  0x00007d2c99aa9081 in ucc_tl_ucp_get_context_attr (context=0x122ade10, attr=0x7fffa58d5090) at tl_ucp_context.c:628
#2  0x00007d2da8bca4d8 in ucc_context_pack_addr (context=0x12a3c3e0, addr_len=0x12a3c450, n_packed=0x12a3c488, h=0x0) at core/ucc_context.c:1056
#3  0x00007d2da8bca6ee in ucc_context_get_attr (context=0x12a3c3e0, context_attr=0x7fffa58d5200) at core/ucc_context.c:1092
#4  0x00007d2da8bc802a in ucc_core_addr_exchange (context=0x12a3c3e0, oob=0x12a3c3f8, addr_storage=0x12a3c4f0) at core/ucc_context.c:477
#5  0x00007d2da8bc9083 in ucc_context_create_proc_info (lib=0x12a3be30, params=0x7fffa58d55e0, config=0x12a3b770, context=0x1229f020, proc_info=0x7d2da8bffb40 <ucc_local_proc>) at core/ucc_context.c:723
#6  0x00007d2da8bc9b78 in ucc_context_create (lib=0x12a3be30, params=0x7fffa58d55e0, config=0x12a3b770, context=0x1229f020) at core/ucc_context.c:870
#7  0x00007d2c9999d52f in c10d::CommUCC::CommUCC (this=0x1229f008, oob=std::shared_ptr<c10d::torch_ucc_oob_coll_info_t> (use count 5, weak count 0) = {...}, logger=...) at /data/ZYH/torch_ucc/src/torch_ucc_comm.cpp:236
#8  0x00007d2c9992eff1 in c10d::Comm::Comm (this=0x1229efd0, logger_=..., oob_=std::shared_ptr<c10d::torch_ucc_oob_coll_info_t> (use count 5, weak count 0) = {...}, dev=..., is_health_check=false) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:338
#9  0x00007d2c9998dfd0 in std::_Construct<c10d::Comm, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (__p=0x1229efd0) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/stl_construct.h:119
#10 0x00007d2c9998a36c in std::allocator_traits<std::allocator<void> >::construct<c10d::Comm, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (__p=0x1229efd0) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/alloc_traits.h:635
#11 0x00007d2c9998494a in std::_Sp_counted_ptr_inplace<c10d::Comm, std::allocator<void>, (__gnu_cxx::_Lock_policy)2>::_Sp_counted_ptr_inplace<c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (this=0x1229efc0, __a=...) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr_base.h:604
#12 0x00007d2c9997b2d0 in std::__shared_count<(__gnu_cxx::_Lock_policy)2>::__shared_count<c10d::Comm, std::allocator<void>, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (this=0x7fffa58d5c88, __p=@0x7fffa58d5c80: 0x0, __a=...) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr_base.h:971
#13 0x00007d2c9996e535 in std::__shared_ptr<c10d::Comm, (__gnu_cxx::_Lock_policy)2>::__shared_ptr<std::allocator<void>, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (this=0x7fffa58d5c80, __tag=...) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr_base.h:1715
#14 0x00007d2c9995fb42 in std::shared_ptr<c10d::Comm>::shared_ptr<std::allocator<void>, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> (this=0x7fffa58d5c80, __tag=...) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr.h:464
#15 0x00007d2c99949448 in std::make_shared<c10d::Comm, c10::intrusive_ptr<c10d::ProcessGroupUCCLogger, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroupUCCLogger> > const&, std::shared_ptr<c10d::torch_ucc_oob_coll_info_t>&, c10::Device&, bool&> () at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr.h:1010
#16 0x00007d2c9992fc97 in c10d::Comm::get_comm (id=@0xa9b14f8: 0, dev=..., oob=std::shared_ptr<c10d::torch_ucc_oob_coll_info_t> (use count 5, weak count 0) = {...}, logger=..., is_health_check=false) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:407
#17 0x00007d2c9993e3b2 in c10d::ProcessGroupUCC::initComm (this=0xa9b13a0, dev=...) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:1873
#18 0x00007d2c9993d8d9 in c10d::ProcessGroupUCC::send (this=0xa9b13a0, tensors=std::vector of length 1, capacity 1 = {...}, dstRank=1, tag=0) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:1710
#19 0x00007d2dca343100 in pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}::operator()(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int) const (__closure=0x96f13f8, c=0xa9b13a0, args#0=std::vector of length 1, capacity 1 = {...}, args#1=1, args#2=0) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:136
#20 0x00007d2dca41dc91 in pybind11::detail::argument_loader<c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int>::call_impl<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&, 0ul, 1ul, 2ul, 3ul, pybind11::gil_scoped_release>(pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&, std::integer_sequence<unsigned long, 0ul, 1ul, 2ul, 3ul>, pybind11::gil_scoped_release&&) && (this=0x7fffa58d6340, f=...) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/cast.h:1631
#21 0x00007d2dca3e930e in pybind11::detail::argument_loader<c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int>::call<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, pybind11::gil_scoped_release, pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&>(pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&) && (this=0x7fffa58d6340, f=...) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/cast.h:1600
#22 0x00007d2dca39a925 in pybind11::cpp_function::initialize<pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&&, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (*)(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(pybind11::detail::function_call&)#1}::operator()(pybind11::detail::function_call&) const (__closure=0x0, call=...) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:278
#23 0x00007d2dca39ab46 in pybind11::cpp_function::initialize<pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&&, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (*)(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(pybind11::detail::function_call&)#1}::_FUN(pybind11::detail::function_call&) () at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:249
#24 0x00007d2dc8fe0da1 in pybind11::cpp_function::dispatcher (self=0x7d2c9bc16820, args_in=0x7d2dcbd4c400, kwargs_in=0x0) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:971
#25 0x0000000000528db7 in cfunction_call (func=0x7d2c9bc1b1a0, args=<optimized out>, kwargs=<optimized out>) at /usr/local/src/conda/python-3.11.13/Objects/methodobject.c:542
#26 0x000000000050454c in _PyObject_MakeTpCall (tstate=0x8a9518 <_PyRuntime+166328>, callable=0x7d2c9bc1b1a0, args=<optimized out>, nargs=<optimized out>, keywords=0x0) at /usr/local/src/conda/python-3.11.13/Objects/call.c:214
#27 0x0000000000511cf6 in _PyEval_EvalFrameDefault (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, frame=<optimized out>, frame@entry=0x7d2dcc5831e0, throwflag=throwflag@entry=0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:4769
#28 0x0000000000539503 in _PyEval_EvalFrame (throwflag=0, frame=0x7d2dcc5831e0, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Include/internal/pycore_ceval.h:73
#29 _PyEval_Vector (kwnames=<optimized out>, argcount=1, args=0x7d2d647caa78, locals=0x0, func=<optimized out>, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:6434
#30 _PyFunction_Vectorcall (func=<optimized out>, stack=0x7d2d647caa78, nargsf=<optimized out>, kwnames=<optimized out>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:393
#31 0x000000000054358c in _PyVectorcall_Call (kwargs=<optimized out>, tuple=<optimized out>, callable=0x7d2c9bcd13a0, func=0x539390 <_PyFunction_Vectorcall>, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:257
#32 _PyObject_Call (kwargs=<optimized out>, args=<optimized out>, callable=0x7d2c9bcd13a0, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:328
#33 PyObject_Call (callable=0x7d2c9bcd13a0, args=<optimized out>, kwargs=<optimized out>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:355
#34 0x0000000000515f58 in do_call_core (use_tracing=<optimized out>, kwdict=0x7d2c99b21b80, callargs=0x7d2dcc1be590, func=0x7d2c9bcd13a0, tstate=<optimized out>) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:7349
#35 _PyEval_EvalFrameDefault (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, frame=<optimized out>, frame@entry=0x7d2dcc583020, throwflag=throwflag@entry=0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:5376
#36 0x00000000005cd0aa in _PyEval_EvalFrame (throwflag=0, frame=0x7d2dcc583020, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Include/internal/pycore_ceval.h:73
#37 _PyEval_Vector (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, func=func@entry=0x7d2dcc1d60c0, locals=locals@entry=0x7d2dcc1f69c0, args=args@entry=0x0, argcount=argcount@entry=0, kwnames=kwnames@entry=0x0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:6434
#38 0x00000000005cc77f in PyEval_EvalCode (co=co@entry=0x7d2dcc1c8030, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:1148
#39 0x00000000005ed557 in run_eval_code_obj (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, co=co@entry=0x7d2dcc1c8030, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:1741
#40 0x00000000005e9080 in run_mod (mod=mod@entry=0x5431ae0, filename=filename@entry=0x7d2dcc1ff780, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0, flags=flags@entry=0x7fffa58d6dd8, arena=arena@entry=0x7d2dcc11b670) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:1762
#41 0x00000000005fde72 in pyrun_file (fp=fp@entry=0x53c05a0, filename=filename@entry=0x7d2dcc1ff780, start=start@entry=257, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0, closeit=closeit@entry=1, flags=0x7fffa58d6dd8) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:1657
#42 0x00000000005fd28f in _PyRun_SimpleFileObject (fp=0x53c05a0, filename=0x7d2dcc1ff780, closeit=1, flags=0x7fffa58d6dd8) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:440
#43 0x00000000005fcfb3 in _PyRun_AnyFileObject (fp=0x53c05a0, filename=filename@entry=0x7d2dcc1ff780, closeit=closeit@entry=1, flags=flags@entry=0x7fffa58d6dd8) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:79
#44 0x00000000005f7dae in pymain_run_file_obj (skip_source_first_line=0, filename=0x7d2dcc1ff780, program_name=0x7d2dcc1973b0) at /usr/local/src/conda/python-3.11.13/Modules/main.c:360
#45 pymain_run_file (config=0x88f560 <_PyRuntime+59904>) at /usr/local/src/conda/python-3.11.13/Modules/main.c:379
#46 pymain_run_python (exitcode=0x7fffa58d6dd0) at /usr/local/src/conda/python-3.11.13/Modules/main.c:605
#47 Py_RunMain () at /usr/local/src/conda/python-3.11.13/Modules/main.c:684
#48 0x00000000005bcdf9 in Py_BytesMain (argc=<optimized out>, argv=<optimized out>) at /usr/local/src/conda/python-3.11.13/Modules/main.c:738
#49 0x00007d2dcc22a1ca in __libc_start_call_main (main=main@entry=0x5bcd50 <main>, argc=argc@entry=3, argv=argv@entry=0x7fffa58d7038) at ../sysdeps/nptl/libc_start_call_main.h:58
---
[HIT] ucp_worker_release_address
#0  ucp_worker_release_address (worker=0x122ff820, address=0x12ba0a10) at core/ucp_worker.c:3272
#1  0x00007d2c99930798 in c10d::Comm::ucx_connect_eps (this=0x1229efd0, eps=std::vector of length 0, capacity 0, oob=std::shared_ptr<c10d::torch_ucc_oob_coll_info_t> (use count 3, weak count 0) = {...}) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:446
#2  0x00007d2c9993e451 in c10d::ProcessGroupUCC::initComm (this=0xa9b13a0, dev=...) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:1875
#3  0x00007d2c9993d8d9 in c10d::ProcessGroupUCC::send (this=0xa9b13a0, tensors=std::vector of length 1, capacity 1 = {...}, dstRank=1, tag=0) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:1710
#4  0x00007d2dca343100 in pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}::operator()(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int) const (__closure=0x96f13f8, c=0xa9b13a0, args#0=std::vector of length 1, capacity 1 = {...}, args#1=1, args#2=0) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:136
#5  0x00007d2dca41dc91 in pybind11::detail::argument_loader<c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int>::call_impl<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&, 0ul, 1ul, 2ul, 3ul, pybind11::gil_scoped_release>(pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&, std::integer_sequence<unsigned long, 0ul, 1ul, 2ul, 3ul>, pybind11::gil_scoped_release&&) && (this=0x7fffa58d6340, f=...) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/cast.h:1631
#6  0x00007d2dca3e930e in pybind11::detail::argument_loader<c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int>::call<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, pybind11::gil_scoped_release, pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&>(pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&) && (this=0x7fffa58d6340, f=...) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/cast.h:1600
#7  0x00007d2dca39a925 in pybind11::cpp_function::initialize<pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&&, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (*)(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(pybind11::detail::function_call&)#1}::operator()(pybind11::detail::function_call&) const (__closure=0x0, call=...) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:278
#8  0x00007d2dca39ab46 in pybind11::cpp_function::initialize<pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&&, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (*)(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(pybind11::detail::function_call&)#1}::_FUN(pybind11::detail::function_call&) () at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:249
#9  0x00007d2dc8fe0da1 in pybind11::cpp_function::dispatcher (self=0x7d2c9bc16820, args_in=0x7d2dcbd4c400, kwargs_in=0x0) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:971
#10 0x0000000000528db7 in cfunction_call (func=0x7d2c9bc1b1a0, args=<optimized out>, kwargs=<optimized out>) at /usr/local/src/conda/python-3.11.13/Objects/methodobject.c:542
#11 0x000000000050454c in _PyObject_MakeTpCall (tstate=0x8a9518 <_PyRuntime+166328>, callable=0x7d2c9bc1b1a0, args=<optimized out>, nargs=<optimized out>, keywords=0x0) at /usr/local/src/conda/python-3.11.13/Objects/call.c:214
#12 0x0000000000511cf6 in _PyEval_EvalFrameDefault (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, frame=<optimized out>, frame@entry=0x7d2dcc5831e0, throwflag=throwflag@entry=0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:4769
#13 0x0000000000539503 in _PyEval_EvalFrame (throwflag=0, frame=0x7d2dcc5831e0, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Include/internal/pycore_ceval.h:73
#14 _PyEval_Vector (kwnames=<optimized out>, argcount=1, args=0x7d2d647caa78, locals=0x0, func=<optimized out>, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:6434
#15 _PyFunction_Vectorcall (func=<optimized out>, stack=0x7d2d647caa78, nargsf=<optimized out>, kwnames=<optimized out>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:393
#16 0x000000000054358c in _PyVectorcall_Call (kwargs=<optimized out>, tuple=<optimized out>, callable=0x7d2c9bcd13a0, func=0x539390 <_PyFunction_Vectorcall>, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:257
#17 _PyObject_Call (kwargs=<optimized out>, args=<optimized out>, callable=0x7d2c9bcd13a0, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:328
#18 PyObject_Call (callable=0x7d2c9bcd13a0, args=<optimized out>, kwargs=<optimized out>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:355
#19 0x0000000000515f58 in do_call_core (use_tracing=<optimized out>, kwdict=0x7d2c99b21b80, callargs=0x7d2dcc1be590, func=0x7d2c9bcd13a0, tstate=<optimized out>) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:7349
#20 _PyEval_EvalFrameDefault (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, frame=<optimized out>, frame@entry=0x7d2dcc583020, throwflag=throwflag@entry=0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:5376
#21 0x00000000005cd0aa in _PyEval_EvalFrame (throwflag=0, frame=0x7d2dcc583020, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Include/internal/pycore_ceval.h:73
#22 _PyEval_Vector (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, func=func@entry=0x7d2dcc1d60c0, locals=locals@entry=0x7d2dcc1f69c0, args=args@entry=0x0, argcount=argcount@entry=0, kwnames=kwnames@entry=0x0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:6434
#23 0x00000000005cc77f in PyEval_EvalCode (co=co@entry=0x7d2dcc1c8030, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:1148
#24 0x00000000005ed557 in run_eval_code_obj (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, co=co@entry=0x7d2dcc1c8030, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:1741
#25 0x00000000005e9080 in run_mod (mod=mod@entry=0x5431ae0, filename=filename@entry=0x7d2dcc1ff780, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0, flags=flags@entry=0x7fffa58d6dd8, arena=arena@entry=0x7d2dcc11b670) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:1762
#26 0x00000000005fde72 in pyrun_file (fp=fp@entry=0x53c05a0, filename=filename@entry=0x7d2dcc1ff780, start=start@entry=257, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0, closeit=closeit@entry=1, flags=0x7fffa58d6dd8) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:1657
#27 0x00000000005fd28f in _PyRun_SimpleFileObject (fp=0x53c05a0, filename=0x7d2dcc1ff780, closeit=1, flags=0x7fffa58d6dd8) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:440
#28 0x00000000005fcfb3 in _PyRun_AnyFileObject (fp=0x53c05a0, filename=filename@entry=0x7d2dcc1ff780, closeit=closeit@entry=1, flags=flags@entry=0x7fffa58d6dd8) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:79
#29 0x00000000005f7dae in pymain_run_file_obj (skip_source_first_line=0, filename=0x7d2dcc1ff780, program_name=0x7d2dcc1973b0) at /usr/local/src/conda/python-3.11.13/Modules/main.c:360
#30 pymain_run_file (config=0x88f560 <_PyRuntime+59904>) at /usr/local/src/conda/python-3.11.13/Modules/main.c:379
#31 pymain_run_python (exitcode=0x7fffa58d6dd0) at /usr/local/src/conda/python-3.11.13/Modules/main.c:605
#32 Py_RunMain () at /usr/local/src/conda/python-3.11.13/Modules/main.c:684
#33 0x00000000005bcdf9 in Py_BytesMain (argc=<optimized out>, argv=<optimized out>) at /usr/local/src/conda/python-3.11.13/Modules/main.c:738
#34 0x00007d2dcc22a1ca in __libc_start_call_main (main=main@entry=0x5bcd50 <main>, argc=argc@entry=3, argv=argv@entry=0x7fffa58d7038) at ../sysdeps/nptl/libc_start_call_main.h:58
#35 0x00007d2dcc22a28b in __libc_start_main_impl (main=0x5bcd50 <main>, argc=3, argv=0x7fffa58d7038, init=<optimized out>, fini=<optimized out>, rtld_fini=<optimized out>, stack_end=0x7fffa58d7028) at ../csu/libc-start.c:360
#36 0x00000000005bcc43 in _start ()
---
[HIT] uct_ep_am_bcopy
#0  uct_ep_am_bcopy (flags=1, arg=0x7fffa58d5820, pack_cb=0x7d2c9965ea71 <ucp_wireup_msg_pack>, id=1 '\001', ep=0x1326f2d0) at /data/ZYH/ucx-1.18.1/src/uct/api/uct.h:3064
#1  ucp_wireup_msg_progress (self=0x1326fa60) at wireup/wireup.c:148
#2  0x00007d2c99660283 in ucp_request_try_send (req=0x1326f980) at /data/ZYH/ucx-1.18.1/src/ucp/core/ucp_request.inl:307
#3  ucp_request_send (req=0x1326f980) at /data/ZYH/ucx-1.18.1/src/ucp/core/ucp_request.inl:330
#4  ucp_wireup_msg_send (ep=0x7d2d430e0140, type=1 '\001', tl_bitmap=0x7fffa58d5a60, lanes2remote=0x0) at wireup/wireup.c:264
#5  0x00007d2c99669838 in ucp_wireup_send_request (ep=0x7d2d430e0140) at wireup/wireup.c:1792
#6  0x00007d2c9946bbc3 in ucp_ep_create_api_to_worker_addr (worker=0x122ff820, params=0x7fffa58d5d70, ep_p=0x7fffa58d5ca0) at core/ucp_ep.c:1129
#7  0x00007d2c9946bfe8 in ucp_ep_create (worker=0x122ff820, params=0x7fffa58d5d70, ep_p=0x12a3b8d0) at core/ucp_ep.c:1198
#8  0x00007d2c99930918 in c10d::Comm::ucx_connect_eps (this=0x1229efd0, eps=std::vector of length 2, capacity 2 = {...}, oob=std::shared_ptr<c10d::torch_ucc_oob_coll_info_t> (use count 3, weak count 0) = {...}) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:453
#9  0x00007d2c9993e451 in c10d::ProcessGroupUCC::initComm (this=0xa9b13a0, dev=...) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:1875
#10 0x00007d2c9993d8d9 in c10d::ProcessGroupUCC::send (this=0xa9b13a0, tensors=std::vector of length 1, capacity 1 = {...}, dstRank=1, tag=0) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:1710
#11 0x00007d2dca343100 in pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}::operator()(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int) const (__closure=0x96f13f8, c=0xa9b13a0, args#0=std::vector of length 1, capacity 1 = {...}, args#1=1, args#2=0) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:136
#12 0x00007d2dca41dc91 in pybind11::detail::argument_loader<c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int>::call_impl<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&, 0ul, 1ul, 2ul, 3ul, pybind11::gil_scoped_release>(pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&, std::integer_sequence<unsigned long, 0ul, 1ul, 2ul, 3ul>, pybind11::gil_scoped_release&&) && (this=0x7fffa58d6340, f=...) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/cast.h:1631
#13 0x00007d2dca3e930e in pybind11::detail::argument_loader<c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int>::call<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, pybind11::gil_scoped_release, pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&>(pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&) && (this=0x7fffa58d6340, f=...) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/cast.h:1600
#14 0x00007d2dca39a925 in pybind11::cpp_function::initialize<pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&&, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (*)(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(pybind11::detail::function_call&)#1}::operator()(pybind11::detail::function_call&) const (__closure=0x0, call=...) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:278
#15 0x00007d2dca39ab46 in pybind11::cpp_function::initialize<pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&&, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (*)(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(pybind11::detail::function_call&)#1}::_FUN(pybind11::detail::function_call&) () at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:249
#16 0x00007d2dc8fe0da1 in pybind11::cpp_function::dispatcher (self=0x7d2c9bc16820, args_in=0x7d2dcbd4c400, kwargs_in=0x0) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:971
#17 0x0000000000528db7 in cfunction_call (func=0x7d2c9bc1b1a0, args=<optimized out>, kwargs=<optimized out>) at /usr/local/src/conda/python-3.11.13/Objects/methodobject.c:542
#18 0x000000000050454c in _PyObject_MakeTpCall (tstate=0x8a9518 <_PyRuntime+166328>, callable=0x7d2c9bc1b1a0, args=<optimized out>, nargs=<optimized out>, keywords=0x0) at /usr/local/src/conda/python-3.11.13/Objects/call.c:214
#19 0x0000000000511cf6 in _PyEval_EvalFrameDefault (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, frame=<optimized out>, frame@entry=0x7d2dcc5831e0, throwflag=throwflag@entry=0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:4769
#20 0x0000000000539503 in _PyEval_EvalFrame (throwflag=0, frame=0x7d2dcc5831e0, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Include/internal/pycore_ceval.h:73
#21 _PyEval_Vector (kwnames=<optimized out>, argcount=1, args=0x7d2d647caa78, locals=0x0, func=<optimized out>, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:6434
#22 _PyFunction_Vectorcall (func=<optimized out>, stack=0x7d2d647caa78, nargsf=<optimized out>, kwnames=<optimized out>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:393
#23 0x000000000054358c in _PyVectorcall_Call (kwargs=<optimized out>, tuple=<optimized out>, callable=0x7d2c9bcd13a0, func=0x539390 <_PyFunction_Vectorcall>, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:257
#24 _PyObject_Call (kwargs=<optimized out>, args=<optimized out>, callable=0x7d2c9bcd13a0, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:328
#25 PyObject_Call (callable=0x7d2c9bcd13a0, args=<optimized out>, kwargs=<optimized out>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:355
#26 0x0000000000515f58 in do_call_core (use_tracing=<optimized out>, kwdict=0x7d2c99b21b80, callargs=0x7d2dcc1be590, func=0x7d2c9bcd13a0, tstate=<optimized out>) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:7349
#27 _PyEval_EvalFrameDefault (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, frame=<optimized out>, frame@entry=0x7d2dcc583020, throwflag=throwflag@entry=0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:5376
#28 0x00000000005cd0aa in _PyEval_EvalFrame (throwflag=0, frame=0x7d2dcc583020, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Include/internal/pycore_ceval.h:73
#29 _PyEval_Vector (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, func=func@entry=0x7d2dcc1d60c0, locals=locals@entry=0x7d2dcc1f69c0, args=args@entry=0x0, argcount=argcount@entry=0, kwnames=kwnames@entry=0x0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:6434
#30 0x00000000005cc77f in PyEval_EvalCode (co=co@entry=0x7d2dcc1c8030, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:1148
#31 0x00000000005ed557 in run_eval_code_obj (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, co=co@entry=0x7d2dcc1c8030, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:1741
#32 0x00000000005e9080 in run_mod (mod=mod@entry=0x5431ae0, filename=filename@entry=0x7d2dcc1ff780, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0, flags=flags@entry=0x7fffa58d6dd8, arena=arena@entry=0x7d2dcc11b670) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:1762
#33 0x00000000005fde72 in pyrun_file (fp=fp@entry=0x53c05a0, filename=filename@entry=0x7d2dcc1ff780, start=start@entry=257, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0, closeit=closeit@entry=1, flags=0x7fffa58d6dd8) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:1657
#34 0x00000000005fd28f in _PyRun_SimpleFileObject (fp=0x53c05a0, filename=0x7d2dcc1ff780, closeit=1, flags=0x7fffa58d6dd8) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:440
#35 0x00000000005fcfb3 in _PyRun_AnyFileObject (fp=0x53c05a0, filename=filename@entry=0x7d2dcc1ff780, closeit=closeit@entry=1, flags=flags@entry=0x7fffa58d6dd8) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:79
#36 0x00000000005f7dae in pymain_run_file_obj (skip_source_first_line=0, filename=0x7d2dcc1ff780, program_name=0x7d2dcc1973b0) at /usr/local/src/conda/python-3.11.13/Modules/main.c:360
#37 pymain_run_file (config=0x88f560 <_PyRuntime+59904>) at /usr/local/src/conda/python-3.11.13/Modules/main.c:379
#38 pymain_run_python (exitcode=0x7fffa58d6dd0) at /usr/local/src/conda/python-3.11.13/Modules/main.c:605
#39 Py_RunMain () at /usr/local/src/conda/python-3.11.13/Modules/main.c:684
#40 0x00000000005bcdf9 in Py_BytesMain (argc=<optimized out>, argv=<optimized out>) at /usr/local/src/conda/python-3.11.13/Modules/main.c:738
#41 0x00007d2dcc22a1ca in __libc_start_call_main (main=main@entry=0x5bcd50 <main>, argc=argc@entry=3, argv=argv@entry=0x7fffa58d7038) at ../sysdeps/nptl/libc_start_call_main.h:58
#42 0x00007d2dcc22a28b in __libc_start_main_impl (main=0x5bcd50 <main>, argc=3, argv=0x7fffa58d7038, init=<optimized out>, fini=<optimized out>, rtld_fini=<optimized out>, stack_end=0x7fffa58d7028) at ../csu/libc-start.c:360
#43 0x00000000005bcc43 in _start ()
---
[HIT] uct_ep_tag_unexp_eager
#0  uct_ep_pending_add (flags=0, req=0x1326fa60, ep=0x1326f2d0) at /data/ZYH/ucx-1.18.1/src/uct/api/uct.h:3216
#1  ucp_request_pending_add (req=0x1326f980) at core/ucp_request.c:330
#2  0x00007d2c996602be in ucp_request_try_send (req=0x1326f980) at /data/ZYH/ucx-1.18.1/src/ucp/core/ucp_request.inl:316
#3  ucp_request_send (req=0x1326f980) at /data/ZYH/ucx-1.18.1/src/ucp/core/ucp_request.inl:330
#4  ucp_wireup_msg_send (ep=0x7d2d430e0140, type=1 '\001', tl_bitmap=0x7fffa58d5a60, lanes2remote=0x0) at wireup/wireup.c:264
#5  0x00007d2c99669838 in ucp_wireup_send_request (ep=0x7d2d430e0140) at wireup/wireup.c:1792
#6  0x00007d2c9946bbc3 in ucp_ep_create_api_to_worker_addr (worker=0x122ff820, params=0x7fffa58d5d70, ep_p=0x7fffa58d5ca0) at core/ucp_ep.c:1129
#7  0x00007d2c9946bfe8 in ucp_ep_create (worker=0x122ff820, params=0x7fffa58d5d70, ep_p=0x12a3b8d0) at core/ucp_ep.c:1198
#8  0x00007d2c99930918 in c10d::Comm::ucx_connect_eps (this=0x1229efd0, eps=std::vector of length 2, capacity 2 = {...}, oob=std::shared_ptr<c10d::torch_ucc_oob_coll_info_t> (use count 3, weak count 0) = {...}) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:453
#9  0x00007d2c9993e451 in c10d::ProcessGroupUCC::initComm (this=0xa9b13a0, dev=...) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:1875
#10 0x00007d2c9993d8d9 in c10d::ProcessGroupUCC::send (this=0xa9b13a0, tensors=std::vector of length 1, capacity 1 = {...}, dstRank=1, tag=0) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:1710
#11 0x00007d2dca343100 in pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}::operator()(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int) const (__closure=0x96f13f8, c=0xa9b13a0, args#0=std::vector of length 1, capacity 1 = {...}, args#1=1, args#2=0) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:136
#12 0x00007d2dca41dc91 in pybind11::detail::argument_loader<c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int>::call_impl<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&, 0ul, 1ul, 2ul, 3ul, pybind11::gil_scoped_release>(pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&, std::integer_sequence<unsigned long, 0ul, 1ul, 2ul, 3ul>, pybind11::gil_scoped_release&&) && (this=0x7fffa58d6340, f=...) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/cast.h:1631
#13 0x00007d2dca3e930e in pybind11::detail::argument_loader<c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int>::call<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, pybind11::gil_scoped_release, pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&>(pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&) && (this=0x7fffa58d6340, f=...) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/cast.h:1600
#14 0x00007d2dca39a925 in pybind11::cpp_function::initialize<pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&&, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (*)(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(pybind11::detail::function_call&)#1}::operator()(pybind11::detail::function_call&) const (__closure=0x0, call=...) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:278
#15 0x00007d2dca39ab46 in pybind11::cpp_function::initialize<pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&&, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (*)(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(pybind11::detail::function_call&)#1}::_FUN(pybind11::detail::function_call&) () at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:249
#16 0x00007d2dc8fe0da1 in pybind11::cpp_function::dispatcher (self=0x7d2c9bc16820, args_in=0x7d2dcbd4c400, kwargs_in=0x0) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:971
#17 0x0000000000528db7 in cfunction_call (func=0x7d2c9bc1b1a0, args=<optimized out>, kwargs=<optimized out>) at /usr/local/src/conda/python-3.11.13/Objects/methodobject.c:542
#18 0x000000000050454c in _PyObject_MakeTpCall (tstate=0x8a9518 <_PyRuntime+166328>, callable=0x7d2c9bc1b1a0, args=<optimized out>, nargs=<optimized out>, keywords=0x0) at /usr/local/src/conda/python-3.11.13/Objects/call.c:214
#19 0x0000000000511cf6 in _PyEval_EvalFrameDefault (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, frame=<optimized out>, frame@entry=0x7d2dcc5831e0, throwflag=throwflag@entry=0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:4769
#20 0x0000000000539503 in _PyEval_EvalFrame (throwflag=0, frame=0x7d2dcc5831e0, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Include/internal/pycore_ceval.h:73
#21 _PyEval_Vector (kwnames=<optimized out>, argcount=1, args=0x7d2d647caa78, locals=0x0, func=<optimized out>, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:6434
#22 _PyFunction_Vectorcall (func=<optimized out>, stack=0x7d2d647caa78, nargsf=<optimized out>, kwnames=<optimized out>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:393
#23 0x000000000054358c in _PyVectorcall_Call (kwargs=<optimized out>, tuple=<optimized out>, callable=0x7d2c9bcd13a0, func=0x539390 <_PyFunction_Vectorcall>, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:257
#24 _PyObject_Call (kwargs=<optimized out>, args=<optimized out>, callable=0x7d2c9bcd13a0, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:328
#25 PyObject_Call (callable=0x7d2c9bcd13a0, args=<optimized out>, kwargs=<optimized out>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:355
#26 0x0000000000515f58 in do_call_core (use_tracing=<optimized out>, kwdict=0x7d2c99b21b80, callargs=0x7d2dcc1be590, func=0x7d2c9bcd13a0, tstate=<optimized out>) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:7349
#27 _PyEval_EvalFrameDefault (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, frame=<optimized out>, frame@entry=0x7d2dcc583020, throwflag=throwflag@entry=0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:5376
#28 0x00000000005cd0aa in _PyEval_EvalFrame (throwflag=0, frame=0x7d2dcc583020, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Include/internal/pycore_ceval.h:73
#29 _PyEval_Vector (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, func=func@entry=0x7d2dcc1d60c0, locals=locals@entry=0x7d2dcc1f69c0, args=args@entry=0x0, argcount=argcount@entry=0, kwnames=kwnames@entry=0x0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:6434
#30 0x00000000005cc77f in PyEval_EvalCode (co=co@entry=0x7d2dcc1c8030, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:1148
#31 0x00000000005ed557 in run_eval_code_obj (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, co=co@entry=0x7d2dcc1c8030, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:1741
#32 0x00000000005e9080 in run_mod (mod=mod@entry=0x5431ae0, filename=filename@entry=0x7d2dcc1ff780, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0, flags=flags@entry=0x7fffa58d6dd8, arena=arena@entry=0x7d2dcc11b670) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:1762
#33 0x00000000005fde72 in pyrun_file (fp=fp@entry=0x53c05a0, filename=filename@entry=0x7d2dcc1ff780, start=start@entry=257, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0, closeit=closeit@entry=1, flags=0x7fffa58d6dd8) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:1657
#34 0x00000000005fd28f in _PyRun_SimpleFileObject (fp=0x53c05a0, filename=0x7d2dcc1ff780, closeit=1, flags=0x7fffa58d6dd8) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:440
#35 0x00000000005fcfb3 in _PyRun_AnyFileObject (fp=0x53c05a0, filename=filename@entry=0x7d2dcc1ff780, closeit=closeit@entry=1, flags=flags@entry=0x7fffa58d6dd8) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:79
#36 0x00000000005f7dae in pymain_run_file_obj (skip_source_first_line=0, filename=0x7d2dcc1ff780, program_name=0x7d2dcc1973b0) at /usr/local/src/conda/python-3.11.13/Modules/main.c:360
#37 pymain_run_file (config=0x88f560 <_PyRuntime+59904>) at /usr/local/src/conda/python-3.11.13/Modules/main.c:379
#38 pymain_run_python (exitcode=0x7fffa58d6dd0) at /usr/local/src/conda/python-3.11.13/Modules/main.c:605
#39 Py_RunMain () at /usr/local/src/conda/python-3.11.13/Modules/main.c:684
#40 0x00000000005bcdf9 in Py_BytesMain (argc=<optimized out>, argv=<optimized out>) at /usr/local/src/conda/python-3.11.13/Modules/main.c:738
#41 0x00007d2dcc22a1ca in __libc_start_call_main (main=main@entry=0x5bcd50 <main>, argc=argc@entry=3, argv=argv@entry=0x7fffa58d7038) at ../sysdeps/nptl/libc_start_call_main.h:58
#42 0x00007d2dcc22a28b in __libc_start_main_impl (main=0x5bcd50 <main>, argc=3, argv=0x7fffa58d7038, init=<optimized out>, fini=<optimized out>, rtld_fini=<optimized out>, stack_end=0x7fffa58d7028) at ../csu/libc-start.c:360
#43 0x00000000005bcc43 in _start ()
---
[HIT] ucp_tag_send_nbx
#0  ucp_tag_send_nbx (ep=0x7d2c9c5f8140, buffer=0x122a1f80, count=1, tag=2305324039725383680, param=0x7fffa58d5750) at tag/tag_send.c:231
#1  0x00007d2c99aa5db8 in ucc_tl_ucp_send_common (buffer=0x122a1f80, msglen=256, mtype=UCC_MEMORY_TYPE_HOST, dest_group_rank=1, team=0x12ba0010, task=0x131cf3c0, cb=0x7d2c99aac019 <ucc_tl_ucp_send_completion_cb_mt>, user_data=0x131cf3c0) at /data/ZYH/ucc/src/components/tl/ucp/tl_ucp_sendrecv.h:100
#2  0x00007d2c99aa5faa in ucc_tl_ucp_send_nb_mt (buffer=0x122a1f80, msglen=256, mtype=UCC_MEMORY_TYPE_HOST, dest_group_rank=1, team=0x12ba0010, task=0x131cf3c0) at /data/ZYH/ucc/src/components/tl/ucp/tl_ucp_sendrecv.h:130
#3  0x00007d2c99acde46 in ucc_tl_ucp_send_nb (buffer=0x122a1f80, msglen=256, mtype=UCC_MEMORY_TYPE_HOST, dest_group_rank=1, team=0x12ba0010, task=0x131cf3c0) at ./tl_ucp_sendrecv.h:147
#4  0x00007d2c99ace4bb in ucc_tl_ucp_allreduce_knomial_progress (coll_task=0x131cf3c0) at allreduce/allreduce_knomial.c:103
#5  0x00007d2c99acd3cd in ucc_progress_queue_enqueue (pq=0x12a52130, task=0x131cf3c0) at /data/ZYH/ucc/src/core/ucc_progress_queue.h:35
#6  0x00007d2c99acecb4 in ucc_tl_ucp_allreduce_knomial_start (coll_task=0x131cf3c0) at allreduce/allreduce_knomial.c:211
#7  0x00007d2c99aad2e2 in ucc_tl_ucp_service_allreduce (team=0x12ba0010, sbuf=0x122a1f80, rbuf=0x122a2080, dt=64, count=32, op=UCC_OP_BAND, subset=..., task_p=0x132882a0) at tl_ucp_service_coll.c:125
#8  0x00007d2da8bd30a6 in ucc_service_allreduce (team=0x13288020, sbuf=0x122a1f80, rbuf=0x122a2080, dt=64, count=32, op=UCC_OP_BAND, subset=..., req=0x13288198) at core/ucc_service_coll.c:67
#9  0x00007d2da8bcd148 in ucc_team_alloc_id (team=0x13288020) at core/ucc_team.c:609
#10 0x00007d2da8bcc745 in ucc_team_create_test_single (context=0x12a3c3e0, team=0x13288020) at core/ucc_team.c:443
#11 0x00007d2da8bcc9fa in ucc_team_create_test (team=0x13288020) at core/ucc_team.c:493
#12 0x00007d2c99931f2e in c10d::Comm::ucc_create_team (this=0x1229efd0, team=@0xa9b1518: 0x13288020, oob=std::shared_ptr<c10d::torch_ucc_oob_coll_info_t> (use count 3, weak count 0) = {...}) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:575
#13 0x00007d2c9993e584 in c10d::ProcessGroupUCC::initComm (this=0xa9b13a0, dev=...) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:1878
#14 0x00007d2c9993d8d9 in c10d::ProcessGroupUCC::send (this=0xa9b13a0, tensors=std::vector of length 1, capacity 1 = {...}, dstRank=1, tag=0) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:1710
#15 0x00007d2dca343100 in pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}::operator()(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int) const (__closure=0x96f13f8, c=0xa9b13a0, args#0=std::vector of length 1, capacity 1 = {...}, args#1=1, args#2=0) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:136
#16 0x00007d2dca41dc91 in pybind11::detail::argument_loader<c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int>::call_impl<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&, 0ul, 1ul, 2ul, 3ul, pybind11::gil_scoped_release>(pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&, std::integer_sequence<unsigned long, 0ul, 1ul, 2ul, 3ul>, pybind11::gil_scoped_release&&) && (this=0x7fffa58d6340, f=...) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/cast.h:1631
#17 0x00007d2dca3e930e in pybind11::detail::argument_loader<c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int>::call<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, pybind11::gil_scoped_release, pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&>(pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&) && (this=0x7fffa58d6340, f=...) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/cast.h:1600
#18 0x00007d2dca39a925 in pybind11::cpp_function::initialize<pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&&, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (*)(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(pybind11::detail::function_call&)#1}::operator()(pybind11::detail::function_call&) const (__closure=0x0, call=...) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:278
#19 0x00007d2dca39ab46 in pybind11::cpp_function::initialize<pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&&, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (*)(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(pybind11::detail::function_call&)#1}::_FUN(pybind11::detail::function_call&) () at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:249
#20 0x00007d2dc8fe0da1 in pybind11::cpp_function::dispatcher (self=0x7d2c9bc16820, args_in=0x7d2dcbd4c400, kwargs_in=0x0) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:971
#21 0x0000000000528db7 in cfunction_call (func=0x7d2c9bc1b1a0, args=<optimized out>, kwargs=<optimized out>) at /usr/local/src/conda/python-3.11.13/Objects/methodobject.c:542
#22 0x000000000050454c in _PyObject_MakeTpCall (tstate=0x8a9518 <_PyRuntime+166328>, callable=0x7d2c9bc1b1a0, args=<optimized out>, nargs=<optimized out>, keywords=0x0) at /usr/local/src/conda/python-3.11.13/Objects/call.c:214
#23 0x0000000000511cf6 in _PyEval_EvalFrameDefault (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, frame=<optimized out>, frame@entry=0x7d2dcc5831e0, throwflag=throwflag@entry=0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:4769
#24 0x0000000000539503 in _PyEval_EvalFrame (throwflag=0, frame=0x7d2dcc5831e0, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Include/internal/pycore_ceval.h:73
#25 _PyEval_Vector (kwnames=<optimized out>, argcount=1, args=0x7d2d647caa78, locals=0x0, func=<optimized out>, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:6434
#26 _PyFunction_Vectorcall (func=<optimized out>, stack=0x7d2d647caa78, nargsf=<optimized out>, kwnames=<optimized out>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:393
#27 0x000000000054358c in _PyVectorcall_Call (kwargs=<optimized out>, tuple=<optimized out>, callable=0x7d2c9bcd13a0, func=0x539390 <_PyFunction_Vectorcall>, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:257
#28 _PyObject_Call (kwargs=<optimized out>, args=<optimized out>, callable=0x7d2c9bcd13a0, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:328
#29 PyObject_Call (callable=0x7d2c9bcd13a0, args=<optimized out>, kwargs=<optimized out>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:355
#30 0x0000000000515f58 in do_call_core (use_tracing=<optimized out>, kwdict=0x7d2c99b21b80, callargs=0x7d2dcc1be590, func=0x7d2c9bcd13a0, tstate=<optimized out>) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:7349
#31 _PyEval_EvalFrameDefault (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, frame=<optimized out>, frame@entry=0x7d2dcc583020, throwflag=throwflag@entry=0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:5376
#32 0x00000000005cd0aa in _PyEval_EvalFrame (throwflag=0, frame=0x7d2dcc583020, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Include/internal/pycore_ceval.h:73
#33 _PyEval_Vector (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, func=func@entry=0x7d2dcc1d60c0, locals=locals@entry=0x7d2dcc1f69c0, args=args@entry=0x0, argcount=argcount@entry=0, kwnames=kwnames@entry=0x0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:6434
#34 0x00000000005cc77f in PyEval_EvalCode (co=co@entry=0x7d2dcc1c8030, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:1148
#35 0x00000000005ed557 in run_eval_code_obj (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, co=co@entry=0x7d2dcc1c8030, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:1741
#36 0x00000000005e9080 in run_mod (mod=mod@entry=0x5431ae0, filename=filename@entry=0x7d2dcc1ff780, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0, flags=flags@entry=0x7fffa58d6dd8, arena=arena@entry=0x7d2dcc11b670) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:1762
#37 0x00000000005fde72 in pyrun_file (fp=fp@entry=0x53c05a0, filename=filename@entry=0x7d2dcc1ff780, start=start@entry=257, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0, closeit=closeit@entry=1, flags=0x7fffa58d6dd8) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:1657
#38 0x00000000005fd28f in _PyRun_SimpleFileObject (fp=0x53c05a0, filename=0x7d2dcc1ff780, closeit=1, flags=0x7fffa58d6dd8) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:440
#39 0x00000000005fcfb3 in _PyRun_AnyFileObject (fp=0x53c05a0, filename=filename@entry=0x7d2dcc1ff780, closeit=closeit@entry=1, flags=flags@entry=0x7fffa58d6dd8) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:79
#40 0x00000000005f7dae in pymain_run_file_obj (skip_source_first_line=0, filename=0x7d2dcc1ff780, program_name=0x7d2dcc1973b0) at /usr/local/src/conda/python-3.11.13/Modules/main.c:360
#41 pymain_run_file (config=0x88f560 <_PyRuntime+59904>) at /usr/local/src/conda/python-3.11.13/Modules/main.c:379
#42 pymain_run_python (exitcode=0x7fffa58d6dd0) at /usr/local/src/conda/python-3.11.13/Modules/main.c:605
#43 Py_RunMain () at /usr/local/src/conda/python-3.11.13/Modules/main.c:684
#44 0x00000000005bcdf9 in Py_BytesMain (argc=<optimized out>, argv=<optimized out>) at /usr/local/src/conda/python-3.11.13/Modules/main.c:738
#45 0x00007d2dcc22a1ca in __libc_start_call_main (main=main@entry=0x5bcd50 <main>, argc=argc@entry=3, argv=argv@entry=0x7fffa58d7038) at ../sysdeps/nptl/libc_start_call_main.h:58
#46 0x00007d2dcc22a28b in __libc_start_main_impl (main=0x5bcd50 <main>, argc=3, argv=0x7fffa58d7038, init=<optimized out>, fini=<optimized out>, rtld_fini=<optimized out>, stack_end=0x7fffa58d7028) at ../csu/libc-start.c:360
#47 0x00000000005bcc43 in _start ()
---
[HIT] uct_ep_am_short
#0  uct_ep_am_short (length=256, payload=0x122a1f80, header=2305324039725383680, id=2 '\002', ep=0x13489e00) at /data/ZYH/ucx-1.18.1/src/uct/api/uct.h:3015
#1  ucp_eager_short_progress (self=0x133a30a0) at tag/eager_single.c:29
#2  0x00007d2c9961b003 in ucp_request_try_send (req=0x133a2fc0) at /data/ZYH/ucx-1.18.1/src/ucp/core/ucp_request.inl:307
#3  ucp_request_send (req=0x133a2fc0) at /data/ZYH/ucx-1.18.1/src/ucp/core/ucp_request.inl:330
#4  ucp_proto_request_send_op_common (msg_length=256, select_param=0x7fffa58d5630, param=0x7fffa58d5750, req=0x133a2fc0, rkey_cfg_index=255 '\377', proto_select=0x12ae6b90, ep=0x7d2c9c5f8140, worker=0x12aa0c40) at /data/ZYH/ucx-1.18.1/src/ucp/proto/proto_common.inl:250
#5  ucp_proto_request_send_op (op_flags=0 '\000', header_length=0, param=0x7fffa58d5750, contig_length=256, datatype=2048, count=1, buffer=0x122a1f80, op_id=UCP_OP_ID_TAG_SEND, req=0x133a2fc0, rkey_cfg_index=255 '\377', proto_select=0x12ae6b90, ep=0x7d2c9c5f8140) at /data/ZYH/ucx-1.18.1/src/ucp/proto/proto_common.inl:300
#6  ucp_tag_send_nbx_inner (param=0x7fffa58d5750, tag=2305324039725383680, count=1, buffer=0x122a1f80, ep=0x7d2c9c5f8140) at tag/tag_send.c:295
#7  ucp_tag_send_nbx (ep=0x7d2c9c5f8140, buffer=0x122a1f80, count=1, tag=2305324039725383680, param=0x7fffa58d5750) at tag/tag_send.c:231
#8  0x00007d2c99aa5db8 in ucc_tl_ucp_send_common (buffer=0x122a1f80, msglen=256, mtype=UCC_MEMORY_TYPE_HOST, dest_group_rank=1, team=0x12ba0010, task=0x131cf3c0, cb=0x7d2c99aac019 <ucc_tl_ucp_send_completion_cb_mt>, user_data=0x131cf3c0) at /data/ZYH/ucc/src/components/tl/ucp/tl_ucp_sendrecv.h:100
#9  0x00007d2c99aa5faa in ucc_tl_ucp_send_nb_mt (buffer=0x122a1f80, msglen=256, mtype=UCC_MEMORY_TYPE_HOST, dest_group_rank=1, team=0x12ba0010, task=0x131cf3c0) at /data/ZYH/ucc/src/components/tl/ucp/tl_ucp_sendrecv.h:130
#10 0x00007d2c99acde46 in ucc_tl_ucp_send_nb (buffer=0x122a1f80, msglen=256, mtype=UCC_MEMORY_TYPE_HOST, dest_group_rank=1, team=0x12ba0010, task=0x131cf3c0) at ./tl_ucp_sendrecv.h:147
#11 0x00007d2c99ace4bb in ucc_tl_ucp_allreduce_knomial_progress (coll_task=0x131cf3c0) at allreduce/allreduce_knomial.c:103
#12 0x00007d2c99acd3cd in ucc_progress_queue_enqueue (pq=0x12a52130, task=0x131cf3c0) at /data/ZYH/ucc/src/core/ucc_progress_queue.h:35
#13 0x00007d2c99acecb4 in ucc_tl_ucp_allreduce_knomial_start (coll_task=0x131cf3c0) at allreduce/allreduce_knomial.c:211
#14 0x00007d2c99aad2e2 in ucc_tl_ucp_service_allreduce (team=0x12ba0010, sbuf=0x122a1f80, rbuf=0x122a2080, dt=64, count=32, op=UCC_OP_BAND, subset=..., task_p=0x132882a0) at tl_ucp_service_coll.c:125
#15 0x00007d2da8bd30a6 in ucc_service_allreduce (team=0x13288020, sbuf=0x122a1f80, rbuf=0x122a2080, dt=64, count=32, op=UCC_OP_BAND, subset=..., req=0x13288198) at core/ucc_service_coll.c:67
#16 0x00007d2da8bcd148 in ucc_team_alloc_id (team=0x13288020) at core/ucc_team.c:609
#17 0x00007d2da8bcc745 in ucc_team_create_test_single (context=0x12a3c3e0, team=0x13288020) at core/ucc_team.c:443
#18 0x00007d2da8bcc9fa in ucc_team_create_test (team=0x13288020) at core/ucc_team.c:493
#19 0x00007d2c99931f2e in c10d::Comm::ucc_create_team (this=0x1229efd0, team=@0xa9b1518: 0x13288020, oob=std::shared_ptr<c10d::torch_ucc_oob_coll_info_t> (use count 3, weak count 0) = {...}) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:575
#20 0x00007d2c9993e584 in c10d::ProcessGroupUCC::initComm (this=0xa9b13a0, dev=...) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:1878
#21 0x00007d2c9993d8d9 in c10d::ProcessGroupUCC::send (this=0xa9b13a0, tensors=std::vector of length 1, capacity 1 = {...}, dstRank=1, tag=0) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:1710
#22 0x00007d2dca343100 in pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}::operator()(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int) const (__closure=0x96f13f8, c=0xa9b13a0, args#0=std::vector of length 1, capacity 1 = {...}, args#1=1, args#2=0) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:136
#23 0x00007d2dca41dc91 in pybind11::detail::argument_loader<c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int>::call_impl<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&, 0ul, 1ul, 2ul, 3ul, pybind11::gil_scoped_release>(pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&, std::integer_sequence<unsigned long, 0ul, 1ul, 2ul, 3ul>, pybind11::gil_scoped_release&&) && (this=0x7fffa58d6340, f=...) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/cast.h:1631
#24 0x00007d2dca3e930e in pybind11::detail::argument_loader<c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int>::call<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, pybind11::gil_scoped_release, pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&>(pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&) && (this=0x7fffa58d6340, f=...) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/cast.h:1600
#25 0x00007d2dca39a925 in pybind11::cpp_function::initialize<pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&&, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (*)(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(pybind11::detail::function_call&)#1}::operator()(pybind11::detail::function_call&) const (__closure=0x0, call=...) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:278
#26 0x00007d2dca39ab46 in pybind11::cpp_function::initialize<pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&&, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (*)(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(pybind11::detail::function_call&)#1}::_FUN(pybind11::detail::function_call&) () at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:249
#27 0x00007d2dc8fe0da1 in pybind11::cpp_function::dispatcher (self=0x7d2c9bc16820, args_in=0x7d2dcbd4c400, kwargs_in=0x0) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:971
#28 0x0000000000528db7 in cfunction_call (func=0x7d2c9bc1b1a0, args=<optimized out>, kwargs=<optimized out>) at /usr/local/src/conda/python-3.11.13/Objects/methodobject.c:542
#29 0x000000000050454c in _PyObject_MakeTpCall (tstate=0x8a9518 <_PyRuntime+166328>, callable=0x7d2c9bc1b1a0, args=<optimized out>, nargs=<optimized out>, keywords=0x0) at /usr/local/src/conda/python-3.11.13/Objects/call.c:214
#30 0x0000000000511cf6 in _PyEval_EvalFrameDefault (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, frame=<optimized out>, frame@entry=0x7d2dcc5831e0, throwflag=throwflag@entry=0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:4769
#31 0x0000000000539503 in _PyEval_EvalFrame (throwflag=0, frame=0x7d2dcc5831e0, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Include/internal/pycore_ceval.h:73
#32 _PyEval_Vector (kwnames=<optimized out>, argcount=1, args=0x7d2d647caa78, locals=0x0, func=<optimized out>, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:6434
#33 _PyFunction_Vectorcall (func=<optimized out>, stack=0x7d2d647caa78, nargsf=<optimized out>, kwnames=<optimized out>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:393
#34 0x000000000054358c in _PyVectorcall_Call (kwargs=<optimized out>, tuple=<optimized out>, callable=0x7d2c9bcd13a0, func=0x539390 <_PyFunction_Vectorcall>, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:257
#35 _PyObject_Call (kwargs=<optimized out>, args=<optimized out>, callable=0x7d2c9bcd13a0, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:328
#36 PyObject_Call (callable=0x7d2c9bcd13a0, args=<optimized out>, kwargs=<optimized out>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:355
#37 0x0000000000515f58 in do_call_core (use_tracing=<optimized out>, kwdict=0x7d2c99b21b80, callargs=0x7d2dcc1be590, func=0x7d2c9bcd13a0, tstate=<optimized out>) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:7349
#38 _PyEval_EvalFrameDefault (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, frame=<optimized out>, frame@entry=0x7d2dcc583020, throwflag=throwflag@entry=0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:5376
#39 0x00000000005cd0aa in _PyEval_EvalFrame (throwflag=0, frame=0x7d2dcc583020, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Include/internal/pycore_ceval.h:73
#40 _PyEval_Vector (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, func=func@entry=0x7d2dcc1d60c0, locals=locals@entry=0x7d2dcc1f69c0, args=args@entry=0x0, argcount=argcount@entry=0, kwnames=kwnames@entry=0x0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:6434
#41 0x00000000005cc77f in PyEval_EvalCode (co=co@entry=0x7d2dcc1c8030, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:1148
#42 0x00000000005ed557 in run_eval_code_obj (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, co=co@entry=0x7d2dcc1c8030, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:1741
#43 0x00000000005e9080 in run_mod (mod=mod@entry=0x5431ae0, filename=filename@entry=0x7d2dcc1ff780, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0, flags=flags@entry=0x7fffa58d6dd8, arena=arena@entry=0x7d2dcc11b670) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:1762
#44 0x00000000005fde72 in pyrun_file (fp=fp@entry=0x53c05a0, filename=filename@entry=0x7d2dcc1ff780, start=start@entry=257, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0, closeit=closeit@entry=1, flags=0x7fffa58d6dd8) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:1657
#45 0x00000000005fd28f in _PyRun_SimpleFileObject (fp=0x53c05a0, filename=0x7d2dcc1ff780, closeit=1, flags=0x7fffa58d6dd8) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:440
#46 0x00000000005fcfb3 in _PyRun_AnyFileObject (fp=0x53c05a0, filename=filename@entry=0x7d2dcc1ff780, closeit=closeit@entry=1, flags=flags@entry=0x7fffa58d6dd8) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:79
#47 0x00000000005f7dae in pymain_run_file_obj (skip_source_first_line=0, filename=0x7d2dcc1ff780, program_name=0x7d2dcc1973b0) at /usr/local/src/conda/python-3.11.13/Modules/main.c:360
#48 pymain_run_file (config=0x88f560 <_PyRuntime+59904>) at /usr/local/src/conda/python-3.11.13/Modules/main.c:379
#49 pymain_run_python (exitcode=0x7fffa58d6dd0) at /usr/local/src/conda/python-3.11.13/Modules/main.c:605
---
[HIT] ucp_tag_recv_nbx
#0  ucp_tag_recv_nbx (worker=0x12aa0c40, buffer=0x13299050, count=1, tag=2305324039725449216, tag_mask=18446744073709551615, param=0x7fffa58d5750) at tag/tag_recv.c:224
#1  0x00007d2c99aa62f8 in ucc_tl_ucp_recv_common (buffer=0x13299050, msglen=256, mtype=UCC_MEMORY_TYPE_HOST, dest_group_rank=1, team=0x12ba0010, task=0x131cf3c0, cb=0x7d2c99aac2c8 <ucc_tl_ucp_recv_completion_cb_mt>, user_data=0x131cf3c0) at /data/ZYH/ucc/src/components/tl/ucp/tl_ucp_sendrecv.h:192
#2  0x00007d2c99aa6360 in ucc_tl_ucp_recv_nb_mt (buffer=0x13299050, msglen=256, mtype=UCC_MEMORY_TYPE_HOST, dest_group_rank=1, team=0x12ba0010, task=0x131cf3c0) at /data/ZYH/ucc/src/components/tl/ucp/tl_ucp_sendrecv.h:204
#3  0x00007d2c99acde96 in ucc_tl_ucp_recv_nb (buffer=0x13299050, msglen=256, mtype=UCC_MEMORY_TYPE_HOST, dest_group_rank=1, team=0x12ba0010, task=0x131cf3c0) at ./tl_ucp_sendrecv.h:240
#4  0x00007d2c99ace5c7 in ucc_tl_ucp_allreduce_knomial_progress (coll_task=0x131cf3c0) at allreduce/allreduce_knomial.c:115
#5  0x00007d2c99acd3cd in ucc_progress_queue_enqueue (pq=0x12a52130, task=0x131cf3c0) at /data/ZYH/ucc/src/core/ucc_progress_queue.h:35
#6  0x00007d2c99acecb4 in ucc_tl_ucp_allreduce_knomial_start (coll_task=0x131cf3c0) at allreduce/allreduce_knomial.c:211
#7  0x00007d2c99aad2e2 in ucc_tl_ucp_service_allreduce (team=0x12ba0010, sbuf=0x122a1f80, rbuf=0x122a2080, dt=64, count=32, op=UCC_OP_BAND, subset=..., task_p=0x132882a0) at tl_ucp_service_coll.c:125
#8  0x00007d2da8bd30a6 in ucc_service_allreduce (team=0x13288020, sbuf=0x122a1f80, rbuf=0x122a2080, dt=64, count=32, op=UCC_OP_BAND, subset=..., req=0x13288198) at core/ucc_service_coll.c:67
#9  0x00007d2da8bcd148 in ucc_team_alloc_id (team=0x13288020) at core/ucc_team.c:609
#10 0x00007d2da8bcc745 in ucc_team_create_test_single (context=0x12a3c3e0, team=0x13288020) at core/ucc_team.c:443
#11 0x00007d2da8bcc9fa in ucc_team_create_test (team=0x13288020) at core/ucc_team.c:493
#12 0x00007d2c99931f2e in c10d::Comm::ucc_create_team (this=0x1229efd0, team=@0xa9b1518: 0x13288020, oob=std::shared_ptr<c10d::torch_ucc_oob_coll_info_t> (use count 3, weak count 0) = {...}) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:575
#13 0x00007d2c9993e584 in c10d::ProcessGroupUCC::initComm (this=0xa9b13a0, dev=...) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:1878
#14 0x00007d2c9993d8d9 in c10d::ProcessGroupUCC::send (this=0xa9b13a0, tensors=std::vector of length 1, capacity 1 = {...}, dstRank=1, tag=0) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:1710
#15 0x00007d2dca343100 in pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}::operator()(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int) const (__closure=0x96f13f8, c=0xa9b13a0, args#0=std::vector of length 1, capacity 1 = {...}, args#1=1, args#2=0) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:136
#16 0x00007d2dca41dc91 in pybind11::detail::argument_loader<c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int>::call_impl<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&, 0ul, 1ul, 2ul, 3ul, pybind11::gil_scoped_release>(pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&, std::integer_sequence<unsigned long, 0ul, 1ul, 2ul, 3ul>, pybind11::gil_scoped_release&&) && (this=0x7fffa58d6340, f=...) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/cast.h:1631
#17 0x00007d2dca3e930e in pybind11::detail::argument_loader<c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int>::call<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, pybind11::gil_scoped_release, pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&>(pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&) && (this=0x7fffa58d6340, f=...) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/cast.h:1600
#18 0x00007d2dca39a925 in pybind11::cpp_function::initialize<pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&&, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (*)(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(pybind11::detail::function_call&)#1}::operator()(pybind11::detail::function_call&) const (__closure=0x0, call=...) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:278
#19 0x00007d2dca39ab46 in pybind11::cpp_function::initialize<pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&&, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (*)(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(pybind11::detail::function_call&)#1}::_FUN(pybind11::detail::function_call&) () at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:249
#20 0x00007d2dc8fe0da1 in pybind11::cpp_function::dispatcher (self=0x7d2c9bc16820, args_in=0x7d2dcbd4c400, kwargs_in=0x0) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:971
#21 0x0000000000528db7 in cfunction_call (func=0x7d2c9bc1b1a0, args=<optimized out>, kwargs=<optimized out>) at /usr/local/src/conda/python-3.11.13/Objects/methodobject.c:542
#22 0x000000000050454c in _PyObject_MakeTpCall (tstate=0x8a9518 <_PyRuntime+166328>, callable=0x7d2c9bc1b1a0, args=<optimized out>, nargs=<optimized out>, keywords=0x0) at /usr/local/src/conda/python-3.11.13/Objects/call.c:214
#23 0x0000000000511cf6 in _PyEval_EvalFrameDefault (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, frame=<optimized out>, frame@entry=0x7d2dcc5831e0, throwflag=throwflag@entry=0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:4769
#24 0x0000000000539503 in _PyEval_EvalFrame (throwflag=0, frame=0x7d2dcc5831e0, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Include/internal/pycore_ceval.h:73
#25 _PyEval_Vector (kwnames=<optimized out>, argcount=1, args=0x7d2d647caa78, locals=0x0, func=<optimized out>, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:6434
#26 _PyFunction_Vectorcall (func=<optimized out>, stack=0x7d2d647caa78, nargsf=<optimized out>, kwnames=<optimized out>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:393
#27 0x000000000054358c in _PyVectorcall_Call (kwargs=<optimized out>, tuple=<optimized out>, callable=0x7d2c9bcd13a0, func=0x539390 <_PyFunction_Vectorcall>, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:257
#28 _PyObject_Call (kwargs=<optimized out>, args=<optimized out>, callable=0x7d2c9bcd13a0, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:328
#29 PyObject_Call (callable=0x7d2c9bcd13a0, args=<optimized out>, kwargs=<optimized out>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:355
#30 0x0000000000515f58 in do_call_core (use_tracing=<optimized out>, kwdict=0x7d2c99b21b80, callargs=0x7d2dcc1be590, func=0x7d2c9bcd13a0, tstate=<optimized out>) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:7349
#31 _PyEval_EvalFrameDefault (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, frame=<optimized out>, frame@entry=0x7d2dcc583020, throwflag=throwflag@entry=0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:5376
#32 0x00000000005cd0aa in _PyEval_EvalFrame (throwflag=0, frame=0x7d2dcc583020, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Include/internal/pycore_ceval.h:73
#33 _PyEval_Vector (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, func=func@entry=0x7d2dcc1d60c0, locals=locals@entry=0x7d2dcc1f69c0, args=args@entry=0x0, argcount=argcount@entry=0, kwnames=kwnames@entry=0x0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:6434
#34 0x00000000005cc77f in PyEval_EvalCode (co=co@entry=0x7d2dcc1c8030, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:1148
#35 0x00000000005ed557 in run_eval_code_obj (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, co=co@entry=0x7d2dcc1c8030, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:1741
#36 0x00000000005e9080 in run_mod (mod=mod@entry=0x5431ae0, filename=filename@entry=0x7d2dcc1ff780, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0, flags=flags@entry=0x7fffa58d6dd8, arena=arena@entry=0x7d2dcc11b670) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:1762
#37 0x00000000005fde72 in pyrun_file (fp=fp@entry=0x53c05a0, filename=filename@entry=0x7d2dcc1ff780, start=start@entry=257, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0, closeit=closeit@entry=1, flags=0x7fffa58d6dd8) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:1657
#38 0x00000000005fd28f in _PyRun_SimpleFileObject (fp=0x53c05a0, filename=0x7d2dcc1ff780, closeit=1, flags=0x7fffa58d6dd8) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:440
#39 0x00000000005fcfb3 in _PyRun_AnyFileObject (fp=0x53c05a0, filename=filename@entry=0x7d2dcc1ff780, closeit=closeit@entry=1, flags=flags@entry=0x7fffa58d6dd8) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:79
#40 0x00000000005f7dae in pymain_run_file_obj (skip_source_first_line=0, filename=0x7d2dcc1ff780, program_name=0x7d2dcc1973b0) at /usr/local/src/conda/python-3.11.13/Modules/main.c:360
#41 pymain_run_file (config=0x88f560 <_PyRuntime+59904>) at /usr/local/src/conda/python-3.11.13/Modules/main.c:379
#42 pymain_run_python (exitcode=0x7fffa58d6dd0) at /usr/local/src/conda/python-3.11.13/Modules/main.c:605
#43 Py_RunMain () at /usr/local/src/conda/python-3.11.13/Modules/main.c:684
#44 0x00000000005bcdf9 in Py_BytesMain (argc=<optimized out>, argv=<optimized out>) at /usr/local/src/conda/python-3.11.13/Modules/main.c:738
#45 0x00007d2dcc22a1ca in __libc_start_call_main (main=main@entry=0x5bcd50 <main>, argc=argc@entry=3, argv=argv@entry=0x7fffa58d7038) at ../sysdeps/nptl/libc_start_call_main.h:58
#46 0x00007d2dcc22a28b in __libc_start_main_impl (main=0x5bcd50 <main>, argc=3, argv=0x7fffa58d7038, init=<optimized out>, fini=<optimized out>, rtld_fini=<optimized out>, stack_end=0x7fffa58d7028) at ../csu/libc-start.c:360
#47 0x00000000005bcc43 in _start ()
---
[HIT] ucp_worker_progress
#0  ucp_worker_progress (worker=0x12aa0c40) at core/ucp_worker.c:3023
#1  0x00007d2c99acd9ea in ucc_tl_ucp_test (task=0x131cf3c0) at ./tl_ucp_coll.h:408
#2  0x00007d2c99ace61d in ucc_tl_ucp_allreduce_knomial_progress (coll_task=0x131cf3c0) at allreduce/allreduce_knomial.c:123
#3  0x00007d2c99acd3cd in ucc_progress_queue_enqueue (pq=0x12a52130, task=0x131cf3c0) at /data/ZYH/ucc/src/core/ucc_progress_queue.h:35
#4  0x00007d2c99acecb4 in ucc_tl_ucp_allreduce_knomial_start (coll_task=0x131cf3c0) at allreduce/allreduce_knomial.c:211
#5  0x00007d2c99aad2e2 in ucc_tl_ucp_service_allreduce (team=0x12ba0010, sbuf=0x122a1f80, rbuf=0x122a2080, dt=64, count=32, op=UCC_OP_BAND, subset=..., task_p=0x132882a0) at tl_ucp_service_coll.c:125
#6  0x00007d2da8bd30a6 in ucc_service_allreduce (team=0x13288020, sbuf=0x122a1f80, rbuf=0x122a2080, dt=64, count=32, op=UCC_OP_BAND, subset=..., req=0x13288198) at core/ucc_service_coll.c:67
#7  0x00007d2da8bcd148 in ucc_team_alloc_id (team=0x13288020) at core/ucc_team.c:609
#8  0x00007d2da8bcc745 in ucc_team_create_test_single (context=0x12a3c3e0, team=0x13288020) at core/ucc_team.c:443
#9  0x00007d2da8bcc9fa in ucc_team_create_test (team=0x13288020) at core/ucc_team.c:493
#10 0x00007d2c99931f2e in c10d::Comm::ucc_create_team (this=0x1229efd0, team=@0xa9b1518: 0x13288020, oob=std::shared_ptr<c10d::torch_ucc_oob_coll_info_t> (use count 3, weak count 0) = {...}) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:575
#11 0x00007d2c9993e584 in c10d::ProcessGroupUCC::initComm (this=0xa9b13a0, dev=...) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:1878
#12 0x00007d2c9993d8d9 in c10d::ProcessGroupUCC::send (this=0xa9b13a0, tensors=std::vector of length 1, capacity 1 = {...}, dstRank=1, tag=0) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:1710
#13 0x00007d2dca343100 in pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}::operator()(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int) const (__closure=0x96f13f8, c=0xa9b13a0, args#0=std::vector of length 1, capacity 1 = {...}, args#1=1, args#2=0) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:136
#14 0x00007d2dca41dc91 in pybind11::detail::argument_loader<c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int>::call_impl<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&, 0ul, 1ul, 2ul, 3ul, pybind11::gil_scoped_release>(pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&, std::integer_sequence<unsigned long, 0ul, 1ul, 2ul, 3ul>, pybind11::gil_scoped_release&&) && (this=0x7fffa58d6340, f=...) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/cast.h:1631
#15 0x00007d2dca3e930e in pybind11::detail::argument_loader<c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int>::call<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, pybind11::gil_scoped_release, pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&>(pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&) && (this=0x7fffa58d6340, f=...) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/cast.h:1600
#16 0x00007d2dca39a925 in pybind11::cpp_function::initialize<pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&&, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (*)(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(pybind11::detail::function_call&)#1}::operator()(pybind11::detail::function_call&) const (__closure=0x0, call=...) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:278
#17 0x00007d2dca39ab46 in pybind11::cpp_function::initialize<pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&&, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (*)(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(pybind11::detail::function_call&)#1}::_FUN(pybind11::detail::function_call&) () at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:249
#18 0x00007d2dc8fe0da1 in pybind11::cpp_function::dispatcher (self=0x7d2c9bc16820, args_in=0x7d2dcbd4c400, kwargs_in=0x0) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:971
#19 0x0000000000528db7 in cfunction_call (func=0x7d2c9bc1b1a0, args=<optimized out>, kwargs=<optimized out>) at /usr/local/src/conda/python-3.11.13/Objects/methodobject.c:542
#20 0x000000000050454c in _PyObject_MakeTpCall (tstate=0x8a9518 <_PyRuntime+166328>, callable=0x7d2c9bc1b1a0, args=<optimized out>, nargs=<optimized out>, keywords=0x0) at /usr/local/src/conda/python-3.11.13/Objects/call.c:214
#21 0x0000000000511cf6 in _PyEval_EvalFrameDefault (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, frame=<optimized out>, frame@entry=0x7d2dcc5831e0, throwflag=throwflag@entry=0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:4769
#22 0x0000000000539503 in _PyEval_EvalFrame (throwflag=0, frame=0x7d2dcc5831e0, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Include/internal/pycore_ceval.h:73
#23 _PyEval_Vector (kwnames=<optimized out>, argcount=1, args=0x7d2d647caa78, locals=0x0, func=<optimized out>, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:6434
#24 _PyFunction_Vectorcall (func=<optimized out>, stack=0x7d2d647caa78, nargsf=<optimized out>, kwnames=<optimized out>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:393
#25 0x000000000054358c in _PyVectorcall_Call (kwargs=<optimized out>, tuple=<optimized out>, callable=0x7d2c9bcd13a0, func=0x539390 <_PyFunction_Vectorcall>, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:257
#26 _PyObject_Call (kwargs=<optimized out>, args=<optimized out>, callable=0x7d2c9bcd13a0, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:328
#27 PyObject_Call (callable=0x7d2c9bcd13a0, args=<optimized out>, kwargs=<optimized out>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:355
#28 0x0000000000515f58 in do_call_core (use_tracing=<optimized out>, kwdict=0x7d2c99b21b80, callargs=0x7d2dcc1be590, func=0x7d2c9bcd13a0, tstate=<optimized out>) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:7349
#29 _PyEval_EvalFrameDefault (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, frame=<optimized out>, frame@entry=0x7d2dcc583020, throwflag=throwflag@entry=0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:5376
#30 0x00000000005cd0aa in _PyEval_EvalFrame (throwflag=0, frame=0x7d2dcc583020, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Include/internal/pycore_ceval.h:73
#31 _PyEval_Vector (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, func=func@entry=0x7d2dcc1d60c0, locals=locals@entry=0x7d2dcc1f69c0, args=args@entry=0x0, argcount=argcount@entry=0, kwnames=kwnames@entry=0x0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:6434
#32 0x00000000005cc77f in PyEval_EvalCode (co=co@entry=0x7d2dcc1c8030, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:1148
#33 0x00000000005ed557 in run_eval_code_obj (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, co=co@entry=0x7d2dcc1c8030, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:1741
#34 0x00000000005e9080 in run_mod (mod=mod@entry=0x5431ae0, filename=filename@entry=0x7d2dcc1ff780, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0, flags=flags@entry=0x7fffa58d6dd8, arena=arena@entry=0x7d2dcc11b670) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:1762
#35 0x00000000005fde72 in pyrun_file (fp=fp@entry=0x53c05a0, filename=filename@entry=0x7d2dcc1ff780, start=start@entry=257, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0, closeit=closeit@entry=1, flags=0x7fffa58d6dd8) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:1657
#36 0x00000000005fd28f in _PyRun_SimpleFileObject (fp=0x53c05a0, filename=0x7d2dcc1ff780, closeit=1, flags=0x7fffa58d6dd8) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:440
#37 0x00000000005fcfb3 in _PyRun_AnyFileObject (fp=0x53c05a0, filename=filename@entry=0x7d2dcc1ff780, closeit=closeit@entry=1, flags=flags@entry=0x7fffa58d6dd8) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:79
#38 0x00000000005f7dae in pymain_run_file_obj (skip_source_first_line=0, filename=0x7d2dcc1ff780, program_name=0x7d2dcc1973b0) at /usr/local/src/conda/python-3.11.13/Modules/main.c:360
#39 pymain_run_file (config=0x88f560 <_PyRuntime+59904>) at /usr/local/src/conda/python-3.11.13/Modules/main.c:379
#40 pymain_run_python (exitcode=0x7fffa58d6dd0) at /usr/local/src/conda/python-3.11.13/Modules/main.c:605
#41 Py_RunMain () at /usr/local/src/conda/python-3.11.13/Modules/main.c:684
#42 0x00000000005bcdf9 in Py_BytesMain (argc=<optimized out>, argv=<optimized out>) at /usr/local/src/conda/python-3.11.13/Modules/main.c:738
#43 0x00007d2dcc22a1ca in __libc_start_call_main (main=main@entry=0x5bcd50 <main>, argc=argc@entry=3, argv=argv@entry=0x7fffa58d7038) at ../sysdeps/nptl/libc_start_call_main.h:58
#44 0x00007d2dcc22a28b in __libc_start_main_impl (main=0x5bcd50 <main>, argc=3, argv=0x7fffa58d7038, init=<optimized out>, fini=<optimized out>, rtld_fini=<optimized out>, stack_end=0x7fffa58d7028) at ../csu/libc-start.c:360
#45 0x00000000005bcc43 in _start ()
---
[HIT] uct_worker_progress
#0  uct_worker_progress (worker=0x12a54c80) at /data/ZYH/ucx-1.18.1/src/uct/api/uct.h:2813
#1  ucp_worker_progress (worker=0x12aa0c40) at core/ucp_worker.c:3027
#2  0x00007d2c99acd9ea in ucc_tl_ucp_test (task=0x131cf3c0) at ./tl_ucp_coll.h:408
#3  0x00007d2c99ace61d in ucc_tl_ucp_allreduce_knomial_progress (coll_task=0x131cf3c0) at allreduce/allreduce_knomial.c:123
#4  0x00007d2c99acd3cd in ucc_progress_queue_enqueue (pq=0x12a52130, task=0x131cf3c0) at /data/ZYH/ucc/src/core/ucc_progress_queue.h:35
#5  0x00007d2c99acecb4 in ucc_tl_ucp_allreduce_knomial_start (coll_task=0x131cf3c0) at allreduce/allreduce_knomial.c:211
#6  0x00007d2c99aad2e2 in ucc_tl_ucp_service_allreduce (team=0x12ba0010, sbuf=0x122a1f80, rbuf=0x122a2080, dt=64, count=32, op=UCC_OP_BAND, subset=..., task_p=0x132882a0) at tl_ucp_service_coll.c:125
#7  0x00007d2da8bd30a6 in ucc_service_allreduce (team=0x13288020, sbuf=0x122a1f80, rbuf=0x122a2080, dt=64, count=32, op=UCC_OP_BAND, subset=..., req=0x13288198) at core/ucc_service_coll.c:67
#8  0x00007d2da8bcd148 in ucc_team_alloc_id (team=0x13288020) at core/ucc_team.c:609
#9  0x00007d2da8bcc745 in ucc_team_create_test_single (context=0x12a3c3e0, team=0x13288020) at core/ucc_team.c:443
#10 0x00007d2da8bcc9fa in ucc_team_create_test (team=0x13288020) at core/ucc_team.c:493
#11 0x00007d2c99931f2e in c10d::Comm::ucc_create_team (this=0x1229efd0, team=@0xa9b1518: 0x13288020, oob=std::shared_ptr<c10d::torch_ucc_oob_coll_info_t> (use count 3, weak count 0) = {...}) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:575
#12 0x00007d2c9993e584 in c10d::ProcessGroupUCC::initComm (this=0xa9b13a0, dev=...) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:1878
#13 0x00007d2c9993d8d9 in c10d::ProcessGroupUCC::send (this=0xa9b13a0, tensors=std::vector of length 1, capacity 1 = {...}, dstRank=1, tag=0) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:1710
#14 0x00007d2dca343100 in pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}::operator()(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int) const (__closure=0x96f13f8, c=0xa9b13a0, args#0=std::vector of length 1, capacity 1 = {...}, args#1=1, args#2=0) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:136
#15 0x00007d2dca41dc91 in pybind11::detail::argument_loader<c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int>::call_impl<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&, 0ul, 1ul, 2ul, 3ul, pybind11::gil_scoped_release>(pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&, std::integer_sequence<unsigned long, 0ul, 1ul, 2ul, 3ul>, pybind11::gil_scoped_release&&) && (this=0x7fffa58d6340, f=...) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/cast.h:1631
#16 0x00007d2dca3e930e in pybind11::detail::argument_loader<c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int>::call<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, pybind11::gil_scoped_release, pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&>(pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&) && (this=0x7fffa58d6340, f=...) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/cast.h:1600
#17 0x00007d2dca39a925 in pybind11::cpp_function::initialize<pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&&, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (*)(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(pybind11::detail::function_call&)#1}::operator()(pybind11::detail::function_call&) const (__closure=0x0, call=...) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:278
#18 0x00007d2dca39ab46 in pybind11::cpp_function::initialize<pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&&, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (*)(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(pybind11::detail::function_call&)#1}::_FUN(pybind11::detail::function_call&) () at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:249
#19 0x00007d2dc8fe0da1 in pybind11::cpp_function::dispatcher (self=0x7d2c9bc16820, args_in=0x7d2dcbd4c400, kwargs_in=0x0) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:971
#20 0x0000000000528db7 in cfunction_call (func=0x7d2c9bc1b1a0, args=<optimized out>, kwargs=<optimized out>) at /usr/local/src/conda/python-3.11.13/Objects/methodobject.c:542
#21 0x000000000050454c in _PyObject_MakeTpCall (tstate=0x8a9518 <_PyRuntime+166328>, callable=0x7d2c9bc1b1a0, args=<optimized out>, nargs=<optimized out>, keywords=0x0) at /usr/local/src/conda/python-3.11.13/Objects/call.c:214
#22 0x0000000000511cf6 in _PyEval_EvalFrameDefault (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, frame=<optimized out>, frame@entry=0x7d2dcc5831e0, throwflag=throwflag@entry=0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:4769
#23 0x0000000000539503 in _PyEval_EvalFrame (throwflag=0, frame=0x7d2dcc5831e0, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Include/internal/pycore_ceval.h:73
#24 _PyEval_Vector (kwnames=<optimized out>, argcount=1, args=0x7d2d647caa78, locals=0x0, func=<optimized out>, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:6434
#25 _PyFunction_Vectorcall (func=<optimized out>, stack=0x7d2d647caa78, nargsf=<optimized out>, kwnames=<optimized out>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:393
#26 0x000000000054358c in _PyVectorcall_Call (kwargs=<optimized out>, tuple=<optimized out>, callable=0x7d2c9bcd13a0, func=0x539390 <_PyFunction_Vectorcall>, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:257
#27 _PyObject_Call (kwargs=<optimized out>, args=<optimized out>, callable=0x7d2c9bcd13a0, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:328
#28 PyObject_Call (callable=0x7d2c9bcd13a0, args=<optimized out>, kwargs=<optimized out>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:355
#29 0x0000000000515f58 in do_call_core (use_tracing=<optimized out>, kwdict=0x7d2c99b21b80, callargs=0x7d2dcc1be590, func=0x7d2c9bcd13a0, tstate=<optimized out>) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:7349
#30 _PyEval_EvalFrameDefault (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, frame=<optimized out>, frame@entry=0x7d2dcc583020, throwflag=throwflag@entry=0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:5376
#31 0x00000000005cd0aa in _PyEval_EvalFrame (throwflag=0, frame=0x7d2dcc583020, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Include/internal/pycore_ceval.h:73
#32 _PyEval_Vector (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, func=func@entry=0x7d2dcc1d60c0, locals=locals@entry=0x7d2dcc1f69c0, args=args@entry=0x0, argcount=argcount@entry=0, kwnames=kwnames@entry=0x0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:6434
#33 0x00000000005cc77f in PyEval_EvalCode (co=co@entry=0x7d2dcc1c8030, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:1148
#34 0x00000000005ed557 in run_eval_code_obj (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, co=co@entry=0x7d2dcc1c8030, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:1741
#35 0x00000000005e9080 in run_mod (mod=mod@entry=0x5431ae0, filename=filename@entry=0x7d2dcc1ff780, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0, flags=flags@entry=0x7fffa58d6dd8, arena=arena@entry=0x7d2dcc11b670) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:1762
#36 0x00000000005fde72 in pyrun_file (fp=fp@entry=0x53c05a0, filename=filename@entry=0x7d2dcc1ff780, start=start@entry=257, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0, closeit=closeit@entry=1, flags=0x7fffa58d6dd8) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:1657
#37 0x00000000005fd28f in _PyRun_SimpleFileObject (fp=0x53c05a0, filename=0x7d2dcc1ff780, closeit=1, flags=0x7fffa58d6dd8) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:440
#38 0x00000000005fcfb3 in _PyRun_AnyFileObject (fp=0x53c05a0, filename=filename@entry=0x7d2dcc1ff780, closeit=closeit@entry=1, flags=flags@entry=0x7fffa58d6dd8) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:79
#39 0x00000000005f7dae in pymain_run_file_obj (skip_source_first_line=0, filename=0x7d2dcc1ff780, program_name=0x7d2dcc1973b0) at /usr/local/src/conda/python-3.11.13/Modules/main.c:360
#40 pymain_run_file (config=0x88f560 <_PyRuntime+59904>) at /usr/local/src/conda/python-3.11.13/Modules/main.c:379
#41 pymain_run_python (exitcode=0x7fffa58d6dd0) at /usr/local/src/conda/python-3.11.13/Modules/main.c:605
#42 Py_RunMain () at /usr/local/src/conda/python-3.11.13/Modules/main.c:684
#43 0x00000000005bcdf9 in Py_BytesMain (argc=<optimized out>, argv=<optimized out>) at /usr/local/src/conda/python-3.11.13/Modules/main.c:738
#44 0x00007d2dcc22a1ca in __libc_start_call_main (main=main@entry=0x5bcd50 <main>, argc=argc@entry=3, argv=argv@entry=0x7fffa58d7038) at ../sysdeps/nptl/libc_start_call_main.h:58
#45 0x00007d2dcc22a28b in __libc_start_main_impl (main=0x5bcd50 <main>, argc=3, argv=0x7fffa58d7038, init=<optimized out>, fini=<optimized out>, rtld_fini=<optimized out>, stack_end=0x7fffa58d7028) at ../csu/libc-start.c:360
#46 0x00000000005bcc43 in _start ()
---
[HIT] uct_ep_connect_to_sockaddr
#0  uct_ep_destroy (ep=0x13489e00) at base/uct_iface.c:751
#1  0x00007d2c9948bd22 in ucp_proxy_ep_replace (proxy_ep=0x13489e00) at core/ucp_proxy_ep.c:209
#2  0x00007d2c996618cf in ucp_wireup_eps_progress (arg=0x7d2c9c5f8140) at wireup/wireup.c:499
#3  0x00007d2d71892223 in ucs_callbackq_oneshot_elems_dispatch (cbq=0x12a54c80) at datastruct/callbackq.c:457
#4  0x00007d2d71892305 in ucs_callbackq_proxy_callback (arg=0x12a54c80) at datastruct/callbackq.c:477
#5  0x00007d2c9949a8c4 in ucs_callbackq_dispatch (cbq=0x12a54c80) at /data/ZYH/ucx-1.18.1/src/ucs/datastruct/callbackq.h:215
#6  0x00007d2c994aabfe in uct_worker_progress (worker=0x12a54c80) at /data/ZYH/ucx-1.18.1/src/uct/api/uct.h:2813
#7  ucp_worker_progress (worker=0x12aa0c40) at core/ucp_worker.c:3027
#8  0x00007d2c99acd9ea in ucc_tl_ucp_test (task=0x131cf3c0) at ./tl_ucp_coll.h:408
#9  0x00007d2c99ace61d in ucc_tl_ucp_allreduce_knomial_progress (coll_task=0x131cf3c0) at allreduce/allreduce_knomial.c:123
#10 0x00007d2c99acd3cd in ucc_progress_queue_enqueue (pq=0x12a52130, task=0x131cf3c0) at /data/ZYH/ucc/src/core/ucc_progress_queue.h:35
#11 0x00007d2c99acecb4 in ucc_tl_ucp_allreduce_knomial_start (coll_task=0x131cf3c0) at allreduce/allreduce_knomial.c:211
#12 0x00007d2c99aad2e2 in ucc_tl_ucp_service_allreduce (team=0x12ba0010, sbuf=0x122a1f80, rbuf=0x122a2080, dt=64, count=32, op=UCC_OP_BAND, subset=..., task_p=0x132882a0) at tl_ucp_service_coll.c:125
#13 0x00007d2da8bd30a6 in ucc_service_allreduce (team=0x13288020, sbuf=0x122a1f80, rbuf=0x122a2080, dt=64, count=32, op=UCC_OP_BAND, subset=..., req=0x13288198) at core/ucc_service_coll.c:67
#14 0x00007d2da8bcd148 in ucc_team_alloc_id (team=0x13288020) at core/ucc_team.c:609
#15 0x00007d2da8bcc745 in ucc_team_create_test_single (context=0x12a3c3e0, team=0x13288020) at core/ucc_team.c:443
#16 0x00007d2da8bcc9fa in ucc_team_create_test (team=0x13288020) at core/ucc_team.c:493
#17 0x00007d2c99931f2e in c10d::Comm::ucc_create_team (this=0x1229efd0, team=@0xa9b1518: 0x13288020, oob=std::shared_ptr<c10d::torch_ucc_oob_coll_info_t> (use count 3, weak count 0) = {...}) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:575
#18 0x00007d2c9993e584 in c10d::ProcessGroupUCC::initComm (this=0xa9b13a0, dev=...) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:1878
#19 0x00007d2c9993d8d9 in c10d::ProcessGroupUCC::send (this=0xa9b13a0, tensors=std::vector of length 1, capacity 1 = {...}, dstRank=1, tag=0) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:1710
#20 0x00007d2dca343100 in pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}::operator()(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int) const (__closure=0x96f13f8, c=0xa9b13a0, args#0=std::vector of length 1, capacity 1 = {...}, args#1=1, args#2=0) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:136
#21 0x00007d2dca41dc91 in pybind11::detail::argument_loader<c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int>::call_impl<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&, 0ul, 1ul, 2ul, 3ul, pybind11::gil_scoped_release>(pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&, std::integer_sequence<unsigned long, 0ul, 1ul, 2ul, 3ul>, pybind11::gil_scoped_release&&) && (this=0x7fffa58d6340, f=...) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/cast.h:1631
#22 0x00007d2dca3e930e in pybind11::detail::argument_loader<c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int>::call<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, pybind11::gil_scoped_release, pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&>(pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&) && (this=0x7fffa58d6340, f=...) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/cast.h:1600
#23 0x00007d2dca39a925 in pybind11::cpp_function::initialize<pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&&, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (*)(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(pybind11::detail::function_call&)#1}::operator()(pybind11::detail::function_call&) const (__closure=0x0, call=...) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:278
#24 0x00007d2dca39ab46 in pybind11::cpp_function::initialize<pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&&, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (*)(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(pybind11::detail::function_call&)#1}::_FUN(pybind11::detail::function_call&) () at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:249
#25 0x00007d2dc8fe0da1 in pybind11::cpp_function::dispatcher (self=0x7d2c9bc16820, args_in=0x7d2dcbd4c400, kwargs_in=0x0) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:971
#26 0x0000000000528db7 in cfunction_call (func=0x7d2c9bc1b1a0, args=<optimized out>, kwargs=<optimized out>) at /usr/local/src/conda/python-3.11.13/Objects/methodobject.c:542
#27 0x000000000050454c in _PyObject_MakeTpCall (tstate=0x8a9518 <_PyRuntime+166328>, callable=0x7d2c9bc1b1a0, args=<optimized out>, nargs=<optimized out>, keywords=0x0) at /usr/local/src/conda/python-3.11.13/Objects/call.c:214
#28 0x0000000000511cf6 in _PyEval_EvalFrameDefault (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, frame=<optimized out>, frame@entry=0x7d2dcc5831e0, throwflag=throwflag@entry=0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:4769
#29 0x0000000000539503 in _PyEval_EvalFrame (throwflag=0, frame=0x7d2dcc5831e0, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Include/internal/pycore_ceval.h:73
#30 _PyEval_Vector (kwnames=<optimized out>, argcount=1, args=0x7d2d647caa78, locals=0x0, func=<optimized out>, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:6434
#31 _PyFunction_Vectorcall (func=<optimized out>, stack=0x7d2d647caa78, nargsf=<optimized out>, kwnames=<optimized out>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:393
#32 0x000000000054358c in _PyVectorcall_Call (kwargs=<optimized out>, tuple=<optimized out>, callable=0x7d2c9bcd13a0, func=0x539390 <_PyFunction_Vectorcall>, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:257
#33 _PyObject_Call (kwargs=<optimized out>, args=<optimized out>, callable=0x7d2c9bcd13a0, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:328
#34 PyObject_Call (callable=0x7d2c9bcd13a0, args=<optimized out>, kwargs=<optimized out>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:355
#35 0x0000000000515f58 in do_call_core (use_tracing=<optimized out>, kwdict=0x7d2c99b21b80, callargs=0x7d2dcc1be590, func=0x7d2c9bcd13a0, tstate=<optimized out>) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:7349
#36 _PyEval_EvalFrameDefault (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, frame=<optimized out>, frame@entry=0x7d2dcc583020, throwflag=throwflag@entry=0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:5376
#37 0x00000000005cd0aa in _PyEval_EvalFrame (throwflag=0, frame=0x7d2dcc583020, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Include/internal/pycore_ceval.h:73
#38 _PyEval_Vector (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, func=func@entry=0x7d2dcc1d60c0, locals=locals@entry=0x7d2dcc1f69c0, args=args@entry=0x0, argcount=argcount@entry=0, kwnames=kwnames@entry=0x0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:6434
#39 0x00000000005cc77f in PyEval_EvalCode (co=co@entry=0x7d2dcc1c8030, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:1148
#40 0x00000000005ed557 in run_eval_code_obj (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, co=co@entry=0x7d2dcc1c8030, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:1741
#41 0x00000000005e9080 in run_mod (mod=mod@entry=0x5431ae0, filename=filename@entry=0x7d2dcc1ff780, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0, flags=flags@entry=0x7fffa58d6dd8, arena=arena@entry=0x7d2dcc11b670) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:1762
#42 0x00000000005fde72 in pyrun_file (fp=fp@entry=0x53c05a0, filename=filename@entry=0x7d2dcc1ff780, start=start@entry=257, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0, closeit=closeit@entry=1, flags=0x7fffa58d6dd8) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:1657
#43 0x00000000005fd28f in _PyRun_SimpleFileObject (fp=0x53c05a0, filename=0x7d2dcc1ff780, closeit=1, flags=0x7fffa58d6dd8) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:440
#44 0x00000000005fcfb3 in _PyRun_AnyFileObject (fp=0x53c05a0, filename=filename@entry=0x7d2dcc1ff780, closeit=closeit@entry=1, flags=flags@entry=0x7fffa58d6dd8) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:79
#45 0x00000000005f7dae in pymain_run_file_obj (skip_source_first_line=0, filename=0x7d2dcc1ff780, program_name=0x7d2dcc1973b0) at /usr/local/src/conda/python-3.11.13/Modules/main.c:360
#46 pymain_run_file (config=0x88f560 <_PyRuntime+59904>) at /usr/local/src/conda/python-3.11.13/Modules/main.c:379
#47 pymain_run_python (exitcode=0x7fffa58d6dd0) at /usr/local/src/conda/python-3.11.13/Modules/main.c:605
#48 Py_RunMain () at /usr/local/src/conda/python-3.11.13/Modules/main.c:684
#49 0x00000000005bcdf9 in Py_BytesMain (argc=<optimized out>, argv=<optimized out>) at /usr/local/src/conda/python-3.11.13/Modules/main.c:738
---
[HIT] ucp_request_free
#0  ucp_request_free (request=0x133a30d0) at core/ucp_request.c:236
#1  0x00007d2c99aac0fb in ucc_tl_ucp_send_completion_cb_mt (request=0x133a30d0, status=UCS_OK, user_data=0x131cf3c0) at tl_ucp_coll.c:123
#2  0x00007d2c995f4060 in ucp_request_complete_send (status=UCS_OK, req=0x133a2fc0) at /data/ZYH/ucx-1.18.1/src/ucp/core/ucp_request.inl:255
#3  ucp_eager_short_progress (self=0x133a30a0) at tag/eager_single.c:43
#4  0x00007d2c996641b5 in ucp_request_try_send (req=0x133a2fc0) at /data/ZYH/ucx-1.18.1/src/ucp/core/ucp_request.inl:307
#5  ucp_request_send (req=0x133a2fc0) at /data/ZYH/ucx-1.18.1/src/ucp/core/ucp_request.inl:330
#6  ucp_wireup_replay_pending_request (self=0x133a30a0, ucp_ep=0x7d2c9c5f8140) at wireup/wireup.c:985
#7  0x00007d2c99664278 in ucp_wireup_replay_pending_requests (ucp_ep=0x7d2c9c5f8140, tmp_pending_queue=0x7fffa58d5650) at wireup/wireup.c:997
#8  0x00007d2c996618fe in ucp_wireup_eps_progress (arg=0x7d2c9c5f8140) at wireup/wireup.c:503
#9  0x00007d2d71892223 in ucs_callbackq_oneshot_elems_dispatch (cbq=0x12a54c80) at datastruct/callbackq.c:457
#10 0x00007d2d71892305 in ucs_callbackq_proxy_callback (arg=0x12a54c80) at datastruct/callbackq.c:477
#11 0x00007d2c9949a8c4 in ucs_callbackq_dispatch (cbq=0x12a54c80) at /data/ZYH/ucx-1.18.1/src/ucs/datastruct/callbackq.h:215
#12 0x00007d2c994aabfe in uct_worker_progress (worker=0x12a54c80) at /data/ZYH/ucx-1.18.1/src/uct/api/uct.h:2813
#13 ucp_worker_progress (worker=0x12aa0c40) at core/ucp_worker.c:3027
#14 0x00007d2c99acd9ea in ucc_tl_ucp_test (task=0x131cf3c0) at ./tl_ucp_coll.h:408
#15 0x00007d2c99ace61d in ucc_tl_ucp_allreduce_knomial_progress (coll_task=0x131cf3c0) at allreduce/allreduce_knomial.c:123
#16 0x00007d2c99acd3cd in ucc_progress_queue_enqueue (pq=0x12a52130, task=0x131cf3c0) at /data/ZYH/ucc/src/core/ucc_progress_queue.h:35
#17 0x00007d2c99acecb4 in ucc_tl_ucp_allreduce_knomial_start (coll_task=0x131cf3c0) at allreduce/allreduce_knomial.c:211
#18 0x00007d2c99aad2e2 in ucc_tl_ucp_service_allreduce (team=0x12ba0010, sbuf=0x122a1f80, rbuf=0x122a2080, dt=64, count=32, op=UCC_OP_BAND, subset=..., task_p=0x132882a0) at tl_ucp_service_coll.c:125
#19 0x00007d2da8bd30a6 in ucc_service_allreduce (team=0x13288020, sbuf=0x122a1f80, rbuf=0x122a2080, dt=64, count=32, op=UCC_OP_BAND, subset=..., req=0x13288198) at core/ucc_service_coll.c:67
#20 0x00007d2da8bcd148 in ucc_team_alloc_id (team=0x13288020) at core/ucc_team.c:609
#21 0x00007d2da8bcc745 in ucc_team_create_test_single (context=0x12a3c3e0, team=0x13288020) at core/ucc_team.c:443
#22 0x00007d2da8bcc9fa in ucc_team_create_test (team=0x13288020) at core/ucc_team.c:493
#23 0x00007d2c99931f2e in c10d::Comm::ucc_create_team (this=0x1229efd0, team=@0xa9b1518: 0x13288020, oob=std::shared_ptr<c10d::torch_ucc_oob_coll_info_t> (use count 3, weak count 0) = {...}) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:575
#24 0x00007d2c9993e584 in c10d::ProcessGroupUCC::initComm (this=0xa9b13a0, dev=...) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:1878
#25 0x00007d2c9993d8d9 in c10d::ProcessGroupUCC::send (this=0xa9b13a0, tensors=std::vector of length 1, capacity 1 = {...}, dstRank=1, tag=0) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:1710
#26 0x00007d2dca343100 in pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}::operator()(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int) const (__closure=0x96f13f8, c=0xa9b13a0, args#0=std::vector of length 1, capacity 1 = {...}, args#1=1, args#2=0) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:136
#27 0x00007d2dca41dc91 in pybind11::detail::argument_loader<c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int>::call_impl<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&, 0ul, 1ul, 2ul, 3ul, pybind11::gil_scoped_release>(pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&, std::integer_sequence<unsigned long, 0ul, 1ul, 2ul, 3ul>, pybind11::gil_scoped_release&&) && (this=0x7fffa58d6340, f=...) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/cast.h:1631
#28 0x00007d2dca3e930e in pybind11::detail::argument_loader<c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int>::call<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, pybind11::gil_scoped_release, pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&>(pybind11::cpp_function::cpp_function<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&) && (this=0x7fffa58d6340, f=...) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/cast.h:1600
#29 0x00007d2dca39a925 in pybind11::cpp_function::initialize<pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&&, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (*)(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(pybind11::detail::function_call&)#1}::operator()(pybind11::detail::function_call&) const (__closure=0x0, call=...) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:278
#30 0x00007d2dca39ab46 in pybind11::cpp_function::initialize<pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(pybind11::cpp_function::initialize<c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> >, c10d::ProcessGroup, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int, pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::call_guard<pybind11::gil_scoped_release>, char [108]>(c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (c10d::ProcessGroup::*)(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int)#1}&&, c10::intrusive_ptr<c10d::Work, c10::detail::intrusive_target_default_null_type<c10d::Work> > (*)(c10d::ProcessGroup*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&, pybind11::arg const&, pybind11::arg const&, pybind11::arg const&, pybind11::call_guard<pybind11::gil_scoped_release> const&, char const (&) [108])::{lambda(pybind11::detail::function_call&)#1}::_FUN(pybind11::detail::function_call&) () at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:249
#31 0x00007d2dc8fe0da1 in pybind11::cpp_function::dispatcher (self=0x7d2c9bc16820, args_in=0x7d2dcbd4c400, kwargs_in=0x0) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:971
#32 0x0000000000528db7 in cfunction_call (func=0x7d2c9bc1b1a0, args=<optimized out>, kwargs=<optimized out>) at /usr/local/src/conda/python-3.11.13/Objects/methodobject.c:542
#33 0x000000000050454c in _PyObject_MakeTpCall (tstate=0x8a9518 <_PyRuntime+166328>, callable=0x7d2c9bc1b1a0, args=<optimized out>, nargs=<optimized out>, keywords=0x0) at /usr/local/src/conda/python-3.11.13/Objects/call.c:214
#34 0x0000000000511cf6 in _PyEval_EvalFrameDefault (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, frame=<optimized out>, frame@entry=0x7d2dcc5831e0, throwflag=throwflag@entry=0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:4769
#35 0x0000000000539503 in _PyEval_EvalFrame (throwflag=0, frame=0x7d2dcc5831e0, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Include/internal/pycore_ceval.h:73
#36 _PyEval_Vector (kwnames=<optimized out>, argcount=1, args=0x7d2d647caa78, locals=0x0, func=<optimized out>, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:6434
#37 _PyFunction_Vectorcall (func=<optimized out>, stack=0x7d2d647caa78, nargsf=<optimized out>, kwnames=<optimized out>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:393
#38 0x000000000054358c in _PyVectorcall_Call (kwargs=<optimized out>, tuple=<optimized out>, callable=0x7d2c9bcd13a0, func=0x539390 <_PyFunction_Vectorcall>, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:257
#39 _PyObject_Call (kwargs=<optimized out>, args=<optimized out>, callable=0x7d2c9bcd13a0, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:328
#40 PyObject_Call (callable=0x7d2c9bcd13a0, args=<optimized out>, kwargs=<optimized out>) at /usr/local/src/conda/python-3.11.13/Objects/call.c:355
#41 0x0000000000515f58 in do_call_core (use_tracing=<optimized out>, kwdict=0x7d2c99b21b80, callargs=0x7d2dcc1be590, func=0x7d2c9bcd13a0, tstate=<optimized out>) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:7349
#42 _PyEval_EvalFrameDefault (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, frame=<optimized out>, frame@entry=0x7d2dcc583020, throwflag=throwflag@entry=0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:5376
#43 0x00000000005cd0aa in _PyEval_EvalFrame (throwflag=0, frame=0x7d2dcc583020, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Include/internal/pycore_ceval.h:73
#44 _PyEval_Vector (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, func=func@entry=0x7d2dcc1d60c0, locals=locals@entry=0x7d2dcc1f69c0, args=args@entry=0x0, argcount=argcount@entry=0, kwnames=kwnames@entry=0x0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:6434
#45 0x00000000005cc77f in PyEval_EvalCode (co=co@entry=0x7d2dcc1c8030, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:1148
#46 0x00000000005ed557 in run_eval_code_obj (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, co=co@entry=0x7d2dcc1c8030, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:1741
#47 0x00000000005e9080 in run_mod (mod=mod@entry=0x5431ae0, filename=filename@entry=0x7d2dcc1ff780, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0, flags=flags@entry=0x7fffa58d6dd8, arena=arena@entry=0x7d2dcc11b670) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:1762
#48 0x00000000005fde72 in pyrun_file (fp=fp@entry=0x53c05a0, filename=filename@entry=0x7d2dcc1ff780, start=start@entry=257, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0, closeit=closeit@entry=1, flags=0x7fffa58d6dd8) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:1657
#49 0x00000000005fd28f in _PyRun_SimpleFileObject (fp=0x53c05a0, filename=0x7d2dcc1ff780, closeit=1, flags=0x7fffa58d6dd8) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:440
---
[HIT] uct_ep_am_zcopy
#0  uct_ep_am_zcopy (comp=0x135f6bd8, flags=0, iovcnt=1, iov=0x7d2c5486eb20, header_length=16, header=0x7d2c5486eb10, id=12 '\f', ep=0x7d2c5003d110) at /data/ZYH/ucx-1.18.1/src/uct/api/uct.h:3112
#1  ucp_proto_am_zcopy_multi_common_send_func (hdr_size_middle=16, hdr_middle=0x7d2c5486eb10, am_id_middle=UCP_AM_ID_RNDV_DATA, hdr_size_first=16, hdr_first=0x7d2c5486eb10, am_id_first=UCP_AM_ID_RNDV_DATA, next_iter=0x7d2c5486f0a0, lpriv=0x136150f0, req=0x135f6b40) at /data/ZYH/ucx-1.18.1/src/ucp/proto/proto_multi.inl:353
#2  ucp_rndv_am_zcopy_send_func (req=0x135f6b40, lpriv=0x136150f0, next_iter=0x7d2c5486f0a0, lane_shift=0x7d2c5486edd6 "\001") at rndv/rndv_am.c:152
#3  0x00007d2c995393ab in ucp_proto_multi_progress (dt_mask=5, complete_func=0x7d2c99537c3d <ucp_rndv_am_zcopy_complete>, send_func=0x7d2c995371ba <ucp_rndv_am_zcopy_send_func>, mpriv=0x136150c0, req=0x135f6b40) at /data/ZYH/ucx-1.18.1/src/ucp/proto/proto_multi.inl:182
#4  ucp_proto_multi_zcopy_progress (uct_comp_cb=0x7d2c994be0dd <ucp_proto_request_zcopy_completion>, complete_func=0x7d2c99537c3d <ucp_rndv_am_zcopy_complete>, send_func=0x7d2c995371ba <ucp_rndv_am_zcopy_send_func>, dt_mask=5, uct_mem_flags=256, init_func=0x0, mpriv=0x136150c0, req=0x135f6b40) at /data/ZYH/ucx-1.18.1/src/ucp/proto/proto_multi.inl:251
#5  ucp_rndv_am_zcopy_proto_progress (uct_req=0x135f6c20) at rndv/rndv_am.c:171
#6  0x00007d2c99530936 in ucp_request_try_send (req=0x135f6b40) at /data/ZYH/ucx-1.18.1/src/ucp/core/ucp_request.inl:307
#7  ucp_request_send (req=0x135f6b40) at /data/ZYH/ucx-1.18.1/src/ucp/core/ucp_request.inl:330
#8  ucp_proto_rndv_send_start_inner (sg_count=1 '\001', header_length=58, rtr=0x12890082, op_attr_mask=0, req=0x135f6b40, worker=0x122ff820) at rndv/proto_rndv.c:879
#9  ucp_proto_rndv_send_start (worker=0x122ff820, req=0x135f6b40, op_attr_mask=0, rtr=0x12890082, header_length=58, sg_count=1 '\001') at rndv/proto_rndv.c:854
#10 0x00007d2c99532e1b in ucp_proto_rndv_handle_rtr (arg=0x122ff820, data=0x12890082, length=58, flags=0) at rndv/proto_rndv.c:936
#11 0x00007d2c9958c5c7 in ucp_rndv_rtr_handler_inner (flags=0, length=58, data=0x12890082, arg=0x122ff820) at rndv/rndv.c:2276
#12 ucp_rndv_rtr_handler (arg=0x122ff820, data=0x12890082, length=58, flags=0) at rndv/rndv.c:2259
#13 0x00007d2c56968a27 in uct_iface_invoke_am (iface=0x12806020, id=11 '\v', data=0x12890082, length=58, flags=0) at /data/ZYH/ucx-1.18.1/src/uct/base/uct_iface.h:948
#14 0x00007d2c5696c829 in uct_rc_mlx5_iface_common_am_handler (poll_flags=2, byte_len=60, flags=0, hdr=0x12890080, cqe=0x128900c0, iface=0x12806020) at rc/rc_mlx5.inl:412
#15 uct_rc_mlx5_iface_common_poll_rx (poll_flags=2, iface=0x12806020) at rc/rc_mlx5.inl:1492
#16 uct_rc_mlx5_iface_progress (flags=2, arg=0x12806020) at rc/rc_mlx5_iface.c:122
#17 uct_rc_mlx5_iface_progress_cyclic (arg=0x12806020) at rc/rc_mlx5_iface.c:132
#18 0x00007d2c9949a8c4 in ucs_callbackq_dispatch (cbq=0x1229f530) at /data/ZYH/ucx-1.18.1/src/ucs/datastruct/callbackq.h:215
#19 0x00007d2c994aabfe in uct_worker_progress (worker=0x1229f530) at /data/ZYH/ucx-1.18.1/src/uct/api/uct.h:2813
#20 ucp_worker_progress (worker=0x122ff820) at core/ucp_worker.c:3027
#21 0x00007d2c9999ad5d in c10d::CommUCX::progress (this=0x1229efe8) at /data/ZYH/torch_ucc/src/torch_ucc_comm.cpp:73
#22 0x00007d2c99933a1a in c10d::Comm::progress_loop (this=0x1229efd0) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:708
#23 0x00007d2c99999bec in std::__invoke_impl<void, void (c10d::Comm::*)(), c10d::Comm*> (__f=@0x12a3b870: (void (c10d::Comm::*)(class c10d::Comm * const)) 0x7d2c999338b4 <c10d::Comm::progress_loop()>, __t=@0x12a3b868: 0x1229efd0) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/invoke.h:74
#24 0x00007d2c99999aae in std::__invoke<void (c10d::Comm::*)(), c10d::Comm*> (__fn=@0x12a3b870: (void (c10d::Comm::*)(class c10d::Comm * const)) 0x7d2c999338b4 <c10d::Comm::progress_loop()>) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/invoke.h:96
#25 0x00007d2c9999994e in std::thread::_Invoker<std::tuple<void (c10d::Comm::*)(), c10d::Comm*> >::_M_invoke<0ul, 1ul> (this=0x12a3b868) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/std_thread.h:279
#26 0x00007d2c99999745 in std::thread::_Invoker<std::tuple<void (c10d::Comm::*)(), c10d::Comm*> >::operator() (this=0x12a3b868) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/std_thread.h:286
#27 0x00007d2c99999469 in std::thread::_State_impl<std::thread::_Invoker<std::tuple<void (c10d::Comm::*)(), c10d::Comm*> > >::_M_run (this=0x12a3b860) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/std_thread.h:231
#28 0x00007d2d950ecdb4 in ?? () from /lib/x86_64-linux-gnu/libstdc++.so.6
#29 0x00007d2dcc29caa4 in start_thread (arg=<optimized out>) at ./nptl/pthread_create.c:447
#30 0x00007d2dcc329c3c in clone3 () at ../sysdeps/unix/sysv/linux/x86_64/clone3.S:78
---
[HIT] ucp_rkey_destroy
#0  ucp_rkey_destroy (rkey=0x7d2c28006f40) at core/ucp_rkey.c:1006
#1  0x00007d2c99537ccd in ucp_proto_rndv_rkey_destroy (req=0x135f6b40) at rndv/proto_rndv.inl:156
#2  ucp_rndv_am_destroy_rkey (req=0x135f6b40) at rndv/rndv_am.c:50
#3  ucp_rndv_am_zcopy_complete (req=0x135f6b40) at rndv/rndv_am.c:162
#4  0x00007d2c995397ff in ucp_proto_multi_progress (dt_mask=5, complete_func=0x7d2c99537c3d <ucp_rndv_am_zcopy_complete>, send_func=0x7d2c995371ba <ucp_rndv_am_zcopy_send_func>, mpriv=0x136150c0, req=0x135f6b40) at /data/ZYH/ucx-1.18.1/src/ucp/proto/proto_multi.inl:197
#5  ucp_proto_multi_zcopy_progress (uct_comp_cb=0x7d2c994be0dd <ucp_proto_request_zcopy_completion>, complete_func=0x7d2c99537c3d <ucp_rndv_am_zcopy_complete>, send_func=0x7d2c995371ba <ucp_rndv_am_zcopy_send_func>, dt_mask=5, uct_mem_flags=256, init_func=0x0, mpriv=0x136150c0, req=0x135f6b40) at /data/ZYH/ucx-1.18.1/src/ucp/proto/proto_multi.inl:251
#6  ucp_rndv_am_zcopy_proto_progress (uct_req=0x135f6c20) at rndv/rndv_am.c:171
#7  0x00007d2c99530936 in ucp_request_try_send (req=0x135f6b40) at /data/ZYH/ucx-1.18.1/src/ucp/core/ucp_request.inl:307
#8  ucp_request_send (req=0x135f6b40) at /data/ZYH/ucx-1.18.1/src/ucp/core/ucp_request.inl:330
#9  ucp_proto_rndv_send_start_inner (sg_count=1 '\001', header_length=58, rtr=0x12890082, op_attr_mask=0, req=0x135f6b40, worker=0x122ff820) at rndv/proto_rndv.c:879
#10 ucp_proto_rndv_send_start (worker=0x122ff820, req=0x135f6b40, op_attr_mask=0, rtr=0x12890082, header_length=58, sg_count=1 '\001') at rndv/proto_rndv.c:854
#11 0x00007d2c99532e1b in ucp_proto_rndv_handle_rtr (arg=0x122ff820, data=0x12890082, length=58, flags=0) at rndv/proto_rndv.c:936
#12 0x00007d2c9958c5c7 in ucp_rndv_rtr_handler_inner (flags=0, length=58, data=0x12890082, arg=0x122ff820) at rndv/rndv.c:2276
#13 ucp_rndv_rtr_handler (arg=0x122ff820, data=0x12890082, length=58, flags=0) at rndv/rndv.c:2259
#14 0x00007d2c56968a27 in uct_iface_invoke_am (iface=0x12806020, id=11 '\v', data=0x12890082, length=58, flags=0) at /data/ZYH/ucx-1.18.1/src/uct/base/uct_iface.h:948
#15 0x00007d2c5696c829 in uct_rc_mlx5_iface_common_am_handler (poll_flags=2, byte_len=60, flags=0, hdr=0x12890080, cqe=0x128900c0, iface=0x12806020) at rc/rc_mlx5.inl:412
#16 uct_rc_mlx5_iface_common_poll_rx (poll_flags=2, iface=0x12806020) at rc/rc_mlx5.inl:1492
#17 uct_rc_mlx5_iface_progress (flags=2, arg=0x12806020) at rc/rc_mlx5_iface.c:122
#18 uct_rc_mlx5_iface_progress_cyclic (arg=0x12806020) at rc/rc_mlx5_iface.c:132
#19 0x00007d2c9949a8c4 in ucs_callbackq_dispatch (cbq=0x1229f530) at /data/ZYH/ucx-1.18.1/src/ucs/datastruct/callbackq.h:215
#20 0x00007d2c994aabfe in uct_worker_progress (worker=0x1229f530) at /data/ZYH/ucx-1.18.1/src/uct/api/uct.h:2813
#21 ucp_worker_progress (worker=0x122ff820) at core/ucp_worker.c:3027
#22 0x00007d2c9999ad5d in c10d::CommUCX::progress (this=0x1229efe8) at /data/ZYH/torch_ucc/src/torch_ucc_comm.cpp:73
#23 0x00007d2c99933a1a in c10d::Comm::progress_loop (this=0x1229efd0) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:708
#24 0x00007d2c99999bec in std::__invoke_impl<void, void (c10d::Comm::*)(), c10d::Comm*> (__f=@0x12a3b870: (void (c10d::Comm::*)(class c10d::Comm * const)) 0x7d2c999338b4 <c10d::Comm::progress_loop()>, __t=@0x12a3b868: 0x1229efd0) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/invoke.h:74
#25 0x00007d2c99999aae in std::__invoke<void (c10d::Comm::*)(), c10d::Comm*> (__fn=@0x12a3b870: (void (c10d::Comm::*)(class c10d::Comm * const)) 0x7d2c999338b4 <c10d::Comm::progress_loop()>) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/invoke.h:96
#26 0x00007d2c9999994e in std::thread::_Invoker<std::tuple<void (c10d::Comm::*)(), c10d::Comm*> >::_M_invoke<0ul, 1ul> (this=0x12a3b868) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/std_thread.h:279
#27 0x00007d2c99999745 in std::thread::_Invoker<std::tuple<void (c10d::Comm::*)(), c10d::Comm*> >::operator() (this=0x12a3b868) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/std_thread.h:286
#28 0x00007d2c99999469 in std::thread::_State_impl<std::thread::_Invoker<std::tuple<void (c10d::Comm::*)(), c10d::Comm*> > >::_M_run (this=0x12a3b860) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/std_thread.h:231
#29 0x00007d2d950ecdb4 in ?? () from /lib/x86_64-linux-gnu/libstdc++.so.6
#30 0x00007d2dcc29caa4 in start_thread (arg=<optimized out>) at ./nptl/pthread_create.c:447
#31 0x00007d2dcc329c3c in clone3 () at ../sysdeps/unix/sysv/linux/x86_64/clone3.S:78
---
[HIT] ucp_dt_make_iov
#0  ucp_request_check_status (request=0x133a2f90) at core/ucp_request.c:169
#1  0x00007d2c99aab228 in ucc_tl_ucp_close_eps (worker=0x122ade68, ctx=0x122ade10) at tl_ucp_ep.c:108
#2  0x00007d2c99aa84d3 in ucc_tl_ucp_eps_cleanup (worker=0x122ade68, ctx=0x122ade10) at tl_ucp_context.c:423
#3  0x00007d2c99aa8641 in ucc_tl_ucp_context_t_cleanup (self=0x122ade10) at tl_ucp_context.c:457
#4  0x00007d2d718cb331 in ucs_class_call_cleanup_chain (cls=0x7d2c99b147a0 <ucc_tl_ucp_context_t_class>, obj=0x122ade10, limit=-1) at type/class.c:56
#5  0x00007d2c99aa391c in ucc_tl_ucp_context_t_delete (self=0x122ade10) at tl_ucp.c:297
#6  0x00007d2da8bc9efb in ucc_context_destroy (context=0x12a3c3e0) at core/ucc_context.c:931
#7  0x00007d2c9999e23d in c10d::CommUCC::~CommUCC (this=0x1229f008, __in_chrg=<optimized out>) at /data/ZYH/torch_ucc/src/torch_ucc_comm.cpp:261
#8  0x00007d2c9992f35d in c10d::Comm::~Comm (this=0x1229efd0, __in_chrg=<optimized out>) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:360
#9  0x00007d2c999998d7 in std::_Destroy<c10d::Comm> (__pointer=0x1229efd0) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/stl_construct.h:151
#10 0x00007d2c9999970c in std::allocator_traits<std::allocator<void> >::destroy<c10d::Comm> (__p=0x1229efd0) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/alloc_traits.h:648
#11 0x00007d2c99999328 in std::_Sp_counted_ptr_inplace<c10d::Comm, std::allocator<void>, (__gnu_cxx::_Lock_policy)2>::_M_dispose (this=0x1229efc0) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr_base.h:613
#12 0x00007d2c99955479 in std::_Sp_counted_base<(__gnu_cxx::_Lock_policy)2>::_M_release_last_use (this=0x1229efc0) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr_base.h:175
#13 0x00007d2c9993ed13 in std::_Sp_counted_base<(__gnu_cxx::_Lock_policy)2>::_M_release_last_use_cold (this=0x1229efc0) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr_base.h:199
#14 0x00007d2c999196e0 in std::_Sp_counted_base<(__gnu_cxx::_Lock_policy)2>::_M_release (this=0x1229efc0) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr_base.h:353
#15 0x00007d2c9993f602 in std::__shared_count<(__gnu_cxx::_Lock_policy)2>::~__shared_count (this=0x7fffa58d6528, __in_chrg=<optimized out>) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr_base.h:1071
#16 0x00007d2c9992baab in std::__shared_ptr<c10d::Comm, (__gnu_cxx::_Lock_policy)2>::~__shared_ptr (this=0x7fffa58d6520, __in_chrg=<optimized out>) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr_base.h:1524
#17 0x00007d2c9995fbbe in std::__shared_ptr<c10d::Comm, (__gnu_cxx::_Lock_policy)2>::operator= (this=0xa9b14e8, __r=...) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr_base.h:1620
#18 0x00007d2c9994949a in std::shared_ptr<c10d::Comm>::operator= (this=0xa9b14e8, __r=...) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr.h:440
#19 0x00007d2c99935129 in c10d::ProcessGroupUCC::~ProcessGroupUCC (this=0xa9b13a0, __in_chrg=<optimized out>) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:810
#20 0x00007d2c99935501 in c10d::ProcessGroupUCC::~ProcessGroupUCC (this=0xa9b13a0, __in_chrg=<optimized out>) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:812
#21 0x00007d2dca3254dd in c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> >::reset_ (this=0x7d2c9a4d4288) at /data/ZYH/pytorch/c10/util/intrusive_ptr.h:297
#22 0x00007d2dca30094a in c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> >::~intrusive_ptr (this=0x7d2c9a4d4288, __in_chrg=<optimized out>) at /data/ZYH/pytorch/c10/util/intrusive_ptr.h:377
#23 0x00007d2dca33fe29 in pybind11::class_<c10d::ProcessGroup, c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> >, c10d::PyProcessGroup>::dealloc (v_h=...) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:1926
#24 0x00007d2dc8fdce78 in pybind11::detail::clear_instance (self=0x7d2c9a4d4270) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/detail/class.h:434
#25 0x00007d2dc8fdcfb6 in pybind11::detail::pybind11_object_dealloc (self=0x7d2c9a4d4270) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/detail/class.h:467
#26 0x0000000000522608 in _Py_Dealloc (op=<optimized out>) at /usr/local/src/conda/python-3.11.13/Objects/object.c:2390
#27 Py_DECREF (op=<optimized out>) at /usr/local/src/conda/python-3.11.13/Include/object.h:538
#28 Py_XDECREF (op=<optimized out>) at /usr/local/src/conda/python-3.11.13/Include/object.h:602
#29 _PyFrame_Clear (frame=0x7d2dcc583140) at /usr/local/src/conda/python-3.11.13/Python/frame.c:141
#30 0x0000000000511902 in _PyEvalFrameClearAndPop (frame=0x7d2dcc583140, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:6406
#31 _PyEval_EvalFrameDefault (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, frame=0x7d2dcc583090, frame@entry=0x7d2dcc583020, throwflag=throwflag@entry=0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:2435
#32 0x00000000005cd0aa in _PyEval_EvalFrame (throwflag=0, frame=0x7d2dcc583020, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Include/internal/pycore_ceval.h:73
#33 _PyEval_Vector (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, func=func@entry=0x7d2dcc1d60c0, locals=locals@entry=0x7d2dcc1f69c0, args=args@entry=0x0, argcount=argcount@entry=0, kwnames=kwnames@entry=0x0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:6434
#34 0x00000000005cc77f in PyEval_EvalCode (co=co@entry=0x7d2dcc1c8030, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:1148
#35 0x00000000005ed557 in run_eval_code_obj (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, co=co@entry=0x7d2dcc1c8030, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:1741
#36 0x00000000005e9080 in run_mod (mod=mod@entry=0x5431ae0, filename=filename@entry=0x7d2dcc1ff780, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0, flags=flags@entry=0x7fffa58d6dd8, arena=arena@entry=0x7d2dcc11b670) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:1762
#37 0x00000000005fde72 in pyrun_file (fp=fp@entry=0x53c05a0, filename=filename@entry=0x7d2dcc1ff780, start=start@entry=257, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0, closeit=closeit@entry=1, flags=0x7fffa58d6dd8) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:1657
#38 0x00000000005fd28f in _PyRun_SimpleFileObject (fp=0x53c05a0, filename=0x7d2dcc1ff780, closeit=1, flags=0x7fffa58d6dd8) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:440
#39 0x00000000005fcfb3 in _PyRun_AnyFileObject (fp=0x53c05a0, filename=filename@entry=0x7d2dcc1ff780, closeit=closeit@entry=1, flags=flags@entry=0x7fffa58d6dd8) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:79
#40 0x00000000005f7dae in pymain_run_file_obj (skip_source_first_line=0, filename=0x7d2dcc1ff780, program_name=0x7d2dcc1973b0) at /usr/local/src/conda/python-3.11.13/Modules/main.c:360
#41 pymain_run_file (config=0x88f560 <_PyRuntime+59904>) at /usr/local/src/conda/python-3.11.13/Modules/main.c:379
#42 pymain_run_python (exitcode=0x7fffa58d6dd0) at /usr/local/src/conda/python-3.11.13/Modules/main.c:605
#43 Py_RunMain () at /usr/local/src/conda/python-3.11.13/Modules/main.c:684
#44 0x00000000005bcdf9 in Py_BytesMain (argc=<optimized out>, argv=<optimized out>) at /usr/local/src/conda/python-3.11.13/Modules/main.c:738
#45 0x00007d2dcc22a1ca in __libc_start_call_main (main=main@entry=0x5bcd50 <main>, argc=argc@entry=3, argv=argv@entry=0x7fffa58d7038) at ../sysdeps/nptl/libc_start_call_main.h:58
#46 0x00007d2dcc22a28b in __libc_start_main_impl (main=0x5bcd50 <main>, argc=3, argv=0x7fffa58d7038, init=<optimized out>, fini=<optimized out>, rtld_fini=<optimized out>, stack_end=0x7fffa58d7028) at ../csu/libc-start.c:360
#47 0x00000000005bcc43 in _start ()
---
[HIT] ucp_worker_destroy
#0  ucp_worker_destroy (worker=0x12aa0c40) at core/ucp_worker.c:2880
#1  0x00007d2c99aa8531 in ucc_tl_ucp_worker_cleanup (worker=...) at tl_ucp_context.c:436
#2  0x00007d2c99aa86d5 in ucc_tl_ucp_context_t_cleanup (self=0x122ade10) at tl_ucp_context.c:464
#3  0x00007d2d718cb331 in ucs_class_call_cleanup_chain (cls=0x7d2c99b147a0 <ucc_tl_ucp_context_t_class>, obj=0x122ade10, limit=-1) at type/class.c:56
#4  0x00007d2c99aa391c in ucc_tl_ucp_context_t_delete (self=0x122ade10) at tl_ucp.c:297
#5  0x00007d2da8bc9efb in ucc_context_destroy (context=0x12a3c3e0) at core/ucc_context.c:931
#6  0x00007d2c9999e23d in c10d::CommUCC::~CommUCC (this=0x1229f008, __in_chrg=<optimized out>) at /data/ZYH/torch_ucc/src/torch_ucc_comm.cpp:261
#7  0x00007d2c9992f35d in c10d::Comm::~Comm (this=0x1229efd0, __in_chrg=<optimized out>) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:360
#8  0x00007d2c999998d7 in std::_Destroy<c10d::Comm> (__pointer=0x1229efd0) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/stl_construct.h:151
#9  0x00007d2c9999970c in std::allocator_traits<std::allocator<void> >::destroy<c10d::Comm> (__p=0x1229efd0) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/alloc_traits.h:648
#10 0x00007d2c99999328 in std::_Sp_counted_ptr_inplace<c10d::Comm, std::allocator<void>, (__gnu_cxx::_Lock_policy)2>::_M_dispose (this=0x1229efc0) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr_base.h:613
#11 0x00007d2c99955479 in std::_Sp_counted_base<(__gnu_cxx::_Lock_policy)2>::_M_release_last_use (this=0x1229efc0) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr_base.h:175
#12 0x00007d2c9993ed13 in std::_Sp_counted_base<(__gnu_cxx::_Lock_policy)2>::_M_release_last_use_cold (this=0x1229efc0) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr_base.h:199
#13 0x00007d2c999196e0 in std::_Sp_counted_base<(__gnu_cxx::_Lock_policy)2>::_M_release (this=0x1229efc0) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr_base.h:353
#14 0x00007d2c9993f602 in std::__shared_count<(__gnu_cxx::_Lock_policy)2>::~__shared_count (this=0x7fffa58d6528, __in_chrg=<optimized out>) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr_base.h:1071
#15 0x00007d2c9992baab in std::__shared_ptr<c10d::Comm, (__gnu_cxx::_Lock_policy)2>::~__shared_ptr (this=0x7fffa58d6520, __in_chrg=<optimized out>) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr_base.h:1524
#16 0x00007d2c9995fbbe in std::__shared_ptr<c10d::Comm, (__gnu_cxx::_Lock_policy)2>::operator= (this=0xa9b14e8, __r=...) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr_base.h:1620
#17 0x00007d2c9994949a in std::shared_ptr<c10d::Comm>::operator= (this=0xa9b14e8, __r=...) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr.h:440
#18 0x00007d2c99935129 in c10d::ProcessGroupUCC::~ProcessGroupUCC (this=0xa9b13a0, __in_chrg=<optimized out>) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:810
#19 0x00007d2c99935501 in c10d::ProcessGroupUCC::~ProcessGroupUCC (this=0xa9b13a0, __in_chrg=<optimized out>) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:812
#20 0x00007d2dca3254dd in c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> >::reset_ (this=0x7d2c9a4d4288) at /data/ZYH/pytorch/c10/util/intrusive_ptr.h:297
#21 0x00007d2dca30094a in c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> >::~intrusive_ptr (this=0x7d2c9a4d4288, __in_chrg=<optimized out>) at /data/ZYH/pytorch/c10/util/intrusive_ptr.h:377
#22 0x00007d2dca33fe29 in pybind11::class_<c10d::ProcessGroup, c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> >, c10d::PyProcessGroup>::dealloc (v_h=...) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:1926
#23 0x00007d2dc8fdce78 in pybind11::detail::clear_instance (self=0x7d2c9a4d4270) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/detail/class.h:434
#24 0x00007d2dc8fdcfb6 in pybind11::detail::pybind11_object_dealloc (self=0x7d2c9a4d4270) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/detail/class.h:467
#25 0x0000000000522608 in _Py_Dealloc (op=<optimized out>) at /usr/local/src/conda/python-3.11.13/Objects/object.c:2390
#26 Py_DECREF (op=<optimized out>) at /usr/local/src/conda/python-3.11.13/Include/object.h:538
#27 Py_XDECREF (op=<optimized out>) at /usr/local/src/conda/python-3.11.13/Include/object.h:602
#28 _PyFrame_Clear (frame=0x7d2dcc583140) at /usr/local/src/conda/python-3.11.13/Python/frame.c:141
#29 0x0000000000511902 in _PyEvalFrameClearAndPop (frame=0x7d2dcc583140, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:6406
#30 _PyEval_EvalFrameDefault (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, frame=0x7d2dcc583090, frame@entry=0x7d2dcc583020, throwflag=throwflag@entry=0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:2435
#31 0x00000000005cd0aa in _PyEval_EvalFrame (throwflag=0, frame=0x7d2dcc583020, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Include/internal/pycore_ceval.h:73
#32 _PyEval_Vector (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, func=func@entry=0x7d2dcc1d60c0, locals=locals@entry=0x7d2dcc1f69c0, args=args@entry=0x0, argcount=argcount@entry=0, kwnames=kwnames@entry=0x0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:6434
#33 0x00000000005cc77f in PyEval_EvalCode (co=co@entry=0x7d2dcc1c8030, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:1148
#34 0x00000000005ed557 in run_eval_code_obj (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, co=co@entry=0x7d2dcc1c8030, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:1741
#35 0x00000000005e9080 in run_mod (mod=mod@entry=0x5431ae0, filename=filename@entry=0x7d2dcc1ff780, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0, flags=flags@entry=0x7fffa58d6dd8, arena=arena@entry=0x7d2dcc11b670) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:1762
#36 0x00000000005fde72 in pyrun_file (fp=fp@entry=0x53c05a0, filename=filename@entry=0x7d2dcc1ff780, start=start@entry=257, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0, closeit=closeit@entry=1, flags=0x7fffa58d6dd8) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:1657
#37 0x00000000005fd28f in _PyRun_SimpleFileObject (fp=0x53c05a0, filename=0x7d2dcc1ff780, closeit=1, flags=0x7fffa58d6dd8) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:440
#38 0x00000000005fcfb3 in _PyRun_AnyFileObject (fp=0x53c05a0, filename=filename@entry=0x7d2dcc1ff780, closeit=closeit@entry=1, flags=flags@entry=0x7fffa58d6dd8) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:79
#39 0x00000000005f7dae in pymain_run_file_obj (skip_source_first_line=0, filename=0x7d2dcc1ff780, program_name=0x7d2dcc1973b0) at /usr/local/src/conda/python-3.11.13/Modules/main.c:360
#40 pymain_run_file (config=0x88f560 <_PyRuntime+59904>) at /usr/local/src/conda/python-3.11.13/Modules/main.c:379
#41 pymain_run_python (exitcode=0x7fffa58d6dd0) at /usr/local/src/conda/python-3.11.13/Modules/main.c:605
#42 Py_RunMain () at /usr/local/src/conda/python-3.11.13/Modules/main.c:684
#43 0x00000000005bcdf9 in Py_BytesMain (argc=<optimized out>, argv=<optimized out>) at /usr/local/src/conda/python-3.11.13/Modules/main.c:738
#44 0x00007d2dcc22a1ca in __libc_start_call_main (main=main@entry=0x5bcd50 <main>, argc=argc@entry=3, argv=argv@entry=0x7fffa58d7038) at ../sysdeps/nptl/libc_start_call_main.h:58
#45 0x00007d2dcc22a28b in __libc_start_main_impl (main=0x5bcd50 <main>, argc=3, argv=0x7fffa58d7038, init=<optimized out>, fini=<optimized out>, rtld_fini=<optimized out>, stack_end=0x7fffa58d7028) at ../csu/libc-start.c:360
#46 0x00000000005bcc43 in _start ()
---
[HIT] uct_iface_close
#0  uct_iface_close (iface=0x12a4f5b0) at base/uct_iface.c:394
#1  0x00007d2c994a081e in ucp_worker_uct_iface_close (wiface=0x12a4f180) at core/ucp_worker.c:835
#2  0x00007d2c994a4697 in ucp_worker_iface_cleanup (wiface=0x12a4f180) at core/ucp_worker.c:1531
#3  0x00007d2c994a34a0 in ucp_worker_close_ifaces (worker=0x12aa0c40) at core/ucp_worker.c:1195
#4  0x00007d2c994aa095 in ucp_worker_destroy (worker=0x12aa0c40) at core/ucp_worker.c:2922
#5  0x00007d2c99aa8531 in ucc_tl_ucp_worker_cleanup (worker=...) at tl_ucp_context.c:436
#6  0x00007d2c99aa86d5 in ucc_tl_ucp_context_t_cleanup (self=0x122ade10) at tl_ucp_context.c:464
#7  0x00007d2d718cb331 in ucs_class_call_cleanup_chain (cls=0x7d2c99b147a0 <ucc_tl_ucp_context_t_class>, obj=0x122ade10, limit=-1) at type/class.c:56
#8  0x00007d2c99aa391c in ucc_tl_ucp_context_t_delete (self=0x122ade10) at tl_ucp.c:297
#9  0x00007d2da8bc9efb in ucc_context_destroy (context=0x12a3c3e0) at core/ucc_context.c:931
#10 0x00007d2c9999e23d in c10d::CommUCC::~CommUCC (this=0x1229f008, __in_chrg=<optimized out>) at /data/ZYH/torch_ucc/src/torch_ucc_comm.cpp:261
#11 0x00007d2c9992f35d in c10d::Comm::~Comm (this=0x1229efd0, __in_chrg=<optimized out>) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:360
#12 0x00007d2c999998d7 in std::_Destroy<c10d::Comm> (__pointer=0x1229efd0) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/stl_construct.h:151
#13 0x00007d2c9999970c in std::allocator_traits<std::allocator<void> >::destroy<c10d::Comm> (__p=0x1229efd0) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/alloc_traits.h:648
#14 0x00007d2c99999328 in std::_Sp_counted_ptr_inplace<c10d::Comm, std::allocator<void>, (__gnu_cxx::_Lock_policy)2>::_M_dispose (this=0x1229efc0) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr_base.h:613
#15 0x00007d2c99955479 in std::_Sp_counted_base<(__gnu_cxx::_Lock_policy)2>::_M_release_last_use (this=0x1229efc0) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr_base.h:175
#16 0x00007d2c9993ed13 in std::_Sp_counted_base<(__gnu_cxx::_Lock_policy)2>::_M_release_last_use_cold (this=0x1229efc0) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr_base.h:199
#17 0x00007d2c999196e0 in std::_Sp_counted_base<(__gnu_cxx::_Lock_policy)2>::_M_release (this=0x1229efc0) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr_base.h:353
#18 0x00007d2c9993f602 in std::__shared_count<(__gnu_cxx::_Lock_policy)2>::~__shared_count (this=0x7fffa58d6528, __in_chrg=<optimized out>) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr_base.h:1071
#19 0x00007d2c9992baab in std::__shared_ptr<c10d::Comm, (__gnu_cxx::_Lock_policy)2>::~__shared_ptr (this=0x7fffa58d6520, __in_chrg=<optimized out>) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr_base.h:1524
#20 0x00007d2c9995fbbe in std::__shared_ptr<c10d::Comm, (__gnu_cxx::_Lock_policy)2>::operator= (this=0xa9b14e8, __r=...) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr_base.h:1620
#21 0x00007d2c9994949a in std::shared_ptr<c10d::Comm>::operator= (this=0xa9b14e8, __r=...) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr.h:440
#22 0x00007d2c99935129 in c10d::ProcessGroupUCC::~ProcessGroupUCC (this=0xa9b13a0, __in_chrg=<optimized out>) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:810
#23 0x00007d2c99935501 in c10d::ProcessGroupUCC::~ProcessGroupUCC (this=0xa9b13a0, __in_chrg=<optimized out>) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:812
#24 0x00007d2dca3254dd in c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> >::reset_ (this=0x7d2c9a4d4288) at /data/ZYH/pytorch/c10/util/intrusive_ptr.h:297
#25 0x00007d2dca30094a in c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> >::~intrusive_ptr (this=0x7d2c9a4d4288, __in_chrg=<optimized out>) at /data/ZYH/pytorch/c10/util/intrusive_ptr.h:377
#26 0x00007d2dca33fe29 in pybind11::class_<c10d::ProcessGroup, c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> >, c10d::PyProcessGroup>::dealloc (v_h=...) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:1926
#27 0x00007d2dc8fdce78 in pybind11::detail::clear_instance (self=0x7d2c9a4d4270) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/detail/class.h:434
#28 0x00007d2dc8fdcfb6 in pybind11::detail::pybind11_object_dealloc (self=0x7d2c9a4d4270) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/detail/class.h:467
#29 0x0000000000522608 in _Py_Dealloc (op=<optimized out>) at /usr/local/src/conda/python-3.11.13/Objects/object.c:2390
#30 Py_DECREF (op=<optimized out>) at /usr/local/src/conda/python-3.11.13/Include/object.h:538
#31 Py_XDECREF (op=<optimized out>) at /usr/local/src/conda/python-3.11.13/Include/object.h:602
#32 _PyFrame_Clear (frame=0x7d2dcc583140) at /usr/local/src/conda/python-3.11.13/Python/frame.c:141
#33 0x0000000000511902 in _PyEvalFrameClearAndPop (frame=0x7d2dcc583140, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:6406
#34 _PyEval_EvalFrameDefault (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, frame=0x7d2dcc583090, frame@entry=0x7d2dcc583020, throwflag=throwflag@entry=0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:2435
#35 0x00000000005cd0aa in _PyEval_EvalFrame (throwflag=0, frame=0x7d2dcc583020, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Include/internal/pycore_ceval.h:73
#36 _PyEval_Vector (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, func=func@entry=0x7d2dcc1d60c0, locals=locals@entry=0x7d2dcc1f69c0, args=args@entry=0x0, argcount=argcount@entry=0, kwnames=kwnames@entry=0x0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:6434
#37 0x00000000005cc77f in PyEval_EvalCode (co=co@entry=0x7d2dcc1c8030, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:1148
#38 0x00000000005ed557 in run_eval_code_obj (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, co=co@entry=0x7d2dcc1c8030, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:1741
#39 0x00000000005e9080 in run_mod (mod=mod@entry=0x5431ae0, filename=filename@entry=0x7d2dcc1ff780, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0, flags=flags@entry=0x7fffa58d6dd8, arena=arena@entry=0x7d2dcc11b670) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:1762
#40 0x00000000005fde72 in pyrun_file (fp=fp@entry=0x53c05a0, filename=filename@entry=0x7d2dcc1ff780, start=start@entry=257, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0, closeit=closeit@entry=1, flags=0x7fffa58d6dd8) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:1657
#41 0x00000000005fd28f in _PyRun_SimpleFileObject (fp=0x53c05a0, filename=0x7d2dcc1ff780, closeit=1, flags=0x7fffa58d6dd8) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:440
#42 0x00000000005fcfb3 in _PyRun_AnyFileObject (fp=0x53c05a0, filename=filename@entry=0x7d2dcc1ff780, closeit=closeit@entry=1, flags=flags@entry=0x7fffa58d6dd8) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:79
#43 0x00000000005f7dae in pymain_run_file_obj (skip_source_first_line=0, filename=0x7d2dcc1ff780, program_name=0x7d2dcc1973b0) at /usr/local/src/conda/python-3.11.13/Modules/main.c:360
#44 pymain_run_file (config=0x88f560 <_PyRuntime+59904>) at /usr/local/src/conda/python-3.11.13/Modules/main.c:379
#45 pymain_run_python (exitcode=0x7fffa58d6dd0) at /usr/local/src/conda/python-3.11.13/Modules/main.c:605
#46 Py_RunMain () at /usr/local/src/conda/python-3.11.13/Modules/main.c:684
#47 0x00000000005bcdf9 in Py_BytesMain (argc=<optimized out>, argv=<optimized out>) at /usr/local/src/conda/python-3.11.13/Modules/main.c:738
#48 0x00007d2dcc22a1ca in __libc_start_call_main (main=main@entry=0x5bcd50 <main>, argc=argc@entry=3, argv=argv@entry=0x7fffa58d7038) at ../sysdeps/nptl/libc_start_call_main.h:58
#49 0x00007d2dcc22a28b in __libc_start_main_impl (main=0x5bcd50 <main>, argc=3, argv=0x7fffa58d7038, init=<optimized out>, fini=<optimized out>, rtld_fini=<optimized out>, stack_end=0x7fffa58d7028) at ../csu/libc-start.c:360
---
[HIT] uct_iface_unset_event_handler
#0  uct_md_mem_dereg (md=0x12a9cad0, memh=0x12a4ff30) at base/uct_md.c:592
#1  0x00007d2d646b0716 in uct_iface_mem_free (mem=0x7fffa58d5d90) at base/uct_mem.c:436
#2  0x00007d2d646b0a8a in uct_iface_mp_chunk_release_inner (chunk=0x7d2d3c24c018, mp=0x12c195f8) at base/uct_mem.c:493
#3  uct_iface_mp_chunk_release (mp=0x12c195f8, chunk=0x7d2d3c24c018) at base/uct_mem.c:478
#4  0x00007d2d718964c3 in ucs_mpool_cleanup (mp=0x12c195f8, leak_check=0) at datastruct/mpool.c:191
#5  0x00007d2d3e1cb894 in uct_ud_iface_t_cleanup (self=0x12c19020) at ud/base/ud_iface.c:607
#6  0x00007d2d718cb331 in ucs_class_call_cleanup_chain (cls=0x7d2d3e1fef80 <uct_ud_verbs_iface_t_class>, obj=0x12c19020, limit=-1) at type/class.c:56
#7  0x00007d2d3e1e5915 in uct_ud_verbs_iface_t_delete (self=0x12c19020) at ud/verbs/ud_verbs.c:831
#8  0x00007d2d646b2e1e in uct_iface_close (iface=0x12c19020) at base/uct_iface.c:395
#9  0x00007d2c994a081e in ucp_worker_uct_iface_close (wiface=0x12ac8470) at core/ucp_worker.c:835
#10 0x00007d2c994a4697 in ucp_worker_iface_cleanup (wiface=0x12ac8470) at core/ucp_worker.c:1531
#11 0x00007d2c994a34a0 in ucp_worker_close_ifaces (worker=0x12aa0c40) at core/ucp_worker.c:1195
#12 0x00007d2c994aa095 in ucp_worker_destroy (worker=0x12aa0c40) at core/ucp_worker.c:2922
#13 0x00007d2c99aa8531 in ucc_tl_ucp_worker_cleanup (worker=...) at tl_ucp_context.c:436
#14 0x00007d2c99aa86d5 in ucc_tl_ucp_context_t_cleanup (self=0x122ade10) at tl_ucp_context.c:464
#15 0x00007d2d718cb331 in ucs_class_call_cleanup_chain (cls=0x7d2c99b147a0 <ucc_tl_ucp_context_t_class>, obj=0x122ade10, limit=-1) at type/class.c:56
#16 0x00007d2c99aa391c in ucc_tl_ucp_context_t_delete (self=0x122ade10) at tl_ucp.c:297
#17 0x00007d2da8bc9efb in ucc_context_destroy (context=0x12a3c3e0) at core/ucc_context.c:931
#18 0x00007d2c9999e23d in c10d::CommUCC::~CommUCC (this=0x1229f008, __in_chrg=<optimized out>) at /data/ZYH/torch_ucc/src/torch_ucc_comm.cpp:261
#19 0x00007d2c9992f35d in c10d::Comm::~Comm (this=0x1229efd0, __in_chrg=<optimized out>) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:360
#20 0x00007d2c999998d7 in std::_Destroy<c10d::Comm> (__pointer=0x1229efd0) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/stl_construct.h:151
#21 0x00007d2c9999970c in std::allocator_traits<std::allocator<void> >::destroy<c10d::Comm> (__p=0x1229efd0) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/alloc_traits.h:648
#22 0x00007d2c99999328 in std::_Sp_counted_ptr_inplace<c10d::Comm, std::allocator<void>, (__gnu_cxx::_Lock_policy)2>::_M_dispose (this=0x1229efc0) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr_base.h:613
#23 0x00007d2c99955479 in std::_Sp_counted_base<(__gnu_cxx::_Lock_policy)2>::_M_release_last_use (this=0x1229efc0) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr_base.h:175
#24 0x00007d2c9993ed13 in std::_Sp_counted_base<(__gnu_cxx::_Lock_policy)2>::_M_release_last_use_cold (this=0x1229efc0) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr_base.h:199
#25 0x00007d2c999196e0 in std::_Sp_counted_base<(__gnu_cxx::_Lock_policy)2>::_M_release (this=0x1229efc0) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr_base.h:353
#26 0x00007d2c9993f602 in std::__shared_count<(__gnu_cxx::_Lock_policy)2>::~__shared_count (this=0x7fffa58d6528, __in_chrg=<optimized out>) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr_base.h:1071
#27 0x00007d2c9992baab in std::__shared_ptr<c10d::Comm, (__gnu_cxx::_Lock_policy)2>::~__shared_ptr (this=0x7fffa58d6520, __in_chrg=<optimized out>) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr_base.h:1524
#28 0x00007d2c9995fbbe in std::__shared_ptr<c10d::Comm, (__gnu_cxx::_Lock_policy)2>::operator= (this=0xa9b14e8, __r=...) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr_base.h:1620
#29 0x00007d2c9994949a in std::shared_ptr<c10d::Comm>::operator= (this=0xa9b14e8, __r=...) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr.h:440
#30 0x00007d2c99935129 in c10d::ProcessGroupUCC::~ProcessGroupUCC (this=0xa9b13a0, __in_chrg=<optimized out>) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:810
#31 0x00007d2c99935501 in c10d::ProcessGroupUCC::~ProcessGroupUCC (this=0xa9b13a0, __in_chrg=<optimized out>) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:812
#32 0x00007d2dca3254dd in c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> >::reset_ (this=0x7d2c9a4d4288) at /data/ZYH/pytorch/c10/util/intrusive_ptr.h:297
#33 0x00007d2dca30094a in c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> >::~intrusive_ptr (this=0x7d2c9a4d4288, __in_chrg=<optimized out>) at /data/ZYH/pytorch/c10/util/intrusive_ptr.h:377
#34 0x00007d2dca33fe29 in pybind11::class_<c10d::ProcessGroup, c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> >, c10d::PyProcessGroup>::dealloc (v_h=...) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:1926
#35 0x00007d2dc8fdce78 in pybind11::detail::clear_instance (self=0x7d2c9a4d4270) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/detail/class.h:434
#36 0x00007d2dc8fdcfb6 in pybind11::detail::pybind11_object_dealloc (self=0x7d2c9a4d4270) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/detail/class.h:467
#37 0x0000000000522608 in _Py_Dealloc (op=<optimized out>) at /usr/local/src/conda/python-3.11.13/Objects/object.c:2390
#38 Py_DECREF (op=<optimized out>) at /usr/local/src/conda/python-3.11.13/Include/object.h:538
#39 Py_XDECREF (op=<optimized out>) at /usr/local/src/conda/python-3.11.13/Include/object.h:602
#40 _PyFrame_Clear (frame=0x7d2dcc583140) at /usr/local/src/conda/python-3.11.13/Python/frame.c:141
#41 0x0000000000511902 in _PyEvalFrameClearAndPop (frame=0x7d2dcc583140, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:6406
#42 _PyEval_EvalFrameDefault (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, frame=0x7d2dcc583090, frame@entry=0x7d2dcc583020, throwflag=throwflag@entry=0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:2435
#43 0x00000000005cd0aa in _PyEval_EvalFrame (throwflag=0, frame=0x7d2dcc583020, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Include/internal/pycore_ceval.h:73
#44 _PyEval_Vector (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, func=func@entry=0x7d2dcc1d60c0, locals=locals@entry=0x7d2dcc1f69c0, args=args@entry=0x0, argcount=argcount@entry=0, kwnames=kwnames@entry=0x0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:6434
#45 0x00000000005cc77f in PyEval_EvalCode (co=co@entry=0x7d2dcc1c8030, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:1148
#46 0x00000000005ed557 in run_eval_code_obj (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, co=co@entry=0x7d2dcc1c8030, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:1741
#47 0x00000000005e9080 in run_mod (mod=mod@entry=0x5431ae0, filename=filename@entry=0x7d2dcc1ff780, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0, flags=flags@entry=0x7fffa58d6dd8, arena=arena@entry=0x7d2dcc11b670) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:1762
#48 0x00000000005fde72 in pyrun_file (fp=fp@entry=0x53c05a0, filename=filename@entry=0x7d2dcc1ff780, start=start@entry=257, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0, closeit=closeit@entry=1, flags=0x7fffa58d6dd8) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:1657
#49 0x00000000005fd28f in _PyRun_SimpleFileObject (fp=0x53c05a0, filename=0x7d2dcc1ff780, closeit=1, flags=0x7fffa58d6dd8) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:440
---
[HIT] ucp_cleanup
#0  ucp_cleanup (context=0x12a51690) at core/ucp_context.c:2354
#1  0x00007d2c99aa853d in ucc_tl_ucp_worker_cleanup (worker=...) at tl_ucp_context.c:437
#2  0x00007d2c99aa86d5 in ucc_tl_ucp_context_t_cleanup (self=0x122ade10) at tl_ucp_context.c:464
#3  0x00007d2d718cb331 in ucs_class_call_cleanup_chain (cls=0x7d2c99b147a0 <ucc_tl_ucp_context_t_class>, obj=0x122ade10, limit=-1) at type/class.c:56
#4  0x00007d2c99aa391c in ucc_tl_ucp_context_t_delete (self=0x122ade10) at tl_ucp.c:297
#5  0x00007d2da8bc9efb in ucc_context_destroy (context=0x12a3c3e0) at core/ucc_context.c:931
#6  0x00007d2c9999e23d in c10d::CommUCC::~CommUCC (this=0x1229f008, __in_chrg=<optimized out>) at /data/ZYH/torch_ucc/src/torch_ucc_comm.cpp:261
#7  0x00007d2c9992f35d in c10d::Comm::~Comm (this=0x1229efd0, __in_chrg=<optimized out>) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:360
#8  0x00007d2c999998d7 in std::_Destroy<c10d::Comm> (__pointer=0x1229efd0) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/stl_construct.h:151
#9  0x00007d2c9999970c in std::allocator_traits<std::allocator<void> >::destroy<c10d::Comm> (__p=0x1229efd0) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/alloc_traits.h:648
#10 0x00007d2c99999328 in std::_Sp_counted_ptr_inplace<c10d::Comm, std::allocator<void>, (__gnu_cxx::_Lock_policy)2>::_M_dispose (this=0x1229efc0) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr_base.h:613
#11 0x00007d2c99955479 in std::_Sp_counted_base<(__gnu_cxx::_Lock_policy)2>::_M_release_last_use (this=0x1229efc0) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr_base.h:175
#12 0x00007d2c9993ed13 in std::_Sp_counted_base<(__gnu_cxx::_Lock_policy)2>::_M_release_last_use_cold (this=0x1229efc0) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr_base.h:199
#13 0x00007d2c999196e0 in std::_Sp_counted_base<(__gnu_cxx::_Lock_policy)2>::_M_release (this=0x1229efc0) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr_base.h:353
#14 0x00007d2c9993f602 in std::__shared_count<(__gnu_cxx::_Lock_policy)2>::~__shared_count (this=0x7fffa58d6528, __in_chrg=<optimized out>) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr_base.h:1071
#15 0x00007d2c9992baab in std::__shared_ptr<c10d::Comm, (__gnu_cxx::_Lock_policy)2>::~__shared_ptr (this=0x7fffa58d6520, __in_chrg=<optimized out>) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr_base.h:1524
#16 0x00007d2c9995fbbe in std::__shared_ptr<c10d::Comm, (__gnu_cxx::_Lock_policy)2>::operator= (this=0xa9b14e8, __r=...) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr_base.h:1620
#17 0x00007d2c9994949a in std::shared_ptr<c10d::Comm>::operator= (this=0xa9b14e8, __r=...) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr.h:440
#18 0x00007d2c99935129 in c10d::ProcessGroupUCC::~ProcessGroupUCC (this=0xa9b13a0, __in_chrg=<optimized out>) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:810
#19 0x00007d2c99935501 in c10d::ProcessGroupUCC::~ProcessGroupUCC (this=0xa9b13a0, __in_chrg=<optimized out>) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:812
#20 0x00007d2dca3254dd in c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> >::reset_ (this=0x7d2c9a4d4288) at /data/ZYH/pytorch/c10/util/intrusive_ptr.h:297
#21 0x00007d2dca30094a in c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> >::~intrusive_ptr (this=0x7d2c9a4d4288, __in_chrg=<optimized out>) at /data/ZYH/pytorch/c10/util/intrusive_ptr.h:377
#22 0x00007d2dca33fe29 in pybind11::class_<c10d::ProcessGroup, c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> >, c10d::PyProcessGroup>::dealloc (v_h=...) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:1926
#23 0x00007d2dc8fdce78 in pybind11::detail::clear_instance (self=0x7d2c9a4d4270) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/detail/class.h:434
#24 0x00007d2dc8fdcfb6 in pybind11::detail::pybind11_object_dealloc (self=0x7d2c9a4d4270) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/detail/class.h:467
#25 0x0000000000522608 in _Py_Dealloc (op=<optimized out>) at /usr/local/src/conda/python-3.11.13/Objects/object.c:2390
#26 Py_DECREF (op=<optimized out>) at /usr/local/src/conda/python-3.11.13/Include/object.h:538
#27 Py_XDECREF (op=<optimized out>) at /usr/local/src/conda/python-3.11.13/Include/object.h:602
#28 _PyFrame_Clear (frame=0x7d2dcc583140) at /usr/local/src/conda/python-3.11.13/Python/frame.c:141
#29 0x0000000000511902 in _PyEvalFrameClearAndPop (frame=0x7d2dcc583140, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:6406
#30 _PyEval_EvalFrameDefault (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, frame=0x7d2dcc583090, frame@entry=0x7d2dcc583020, throwflag=throwflag@entry=0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:2435
#31 0x00000000005cd0aa in _PyEval_EvalFrame (throwflag=0, frame=0x7d2dcc583020, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Include/internal/pycore_ceval.h:73
#32 _PyEval_Vector (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, func=func@entry=0x7d2dcc1d60c0, locals=locals@entry=0x7d2dcc1f69c0, args=args@entry=0x0, argcount=argcount@entry=0, kwnames=kwnames@entry=0x0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:6434
#33 0x00000000005cc77f in PyEval_EvalCode (co=co@entry=0x7d2dcc1c8030, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:1148
#34 0x00000000005ed557 in run_eval_code_obj (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, co=co@entry=0x7d2dcc1c8030, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:1741
#35 0x00000000005e9080 in run_mod (mod=mod@entry=0x5431ae0, filename=filename@entry=0x7d2dcc1ff780, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0, flags=flags@entry=0x7fffa58d6dd8, arena=arena@entry=0x7d2dcc11b670) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:1762
#36 0x00000000005fde72 in pyrun_file (fp=fp@entry=0x53c05a0, filename=filename@entry=0x7d2dcc1ff780, start=start@entry=257, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0, closeit=closeit@entry=1, flags=0x7fffa58d6dd8) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:1657
#37 0x00000000005fd28f in _PyRun_SimpleFileObject (fp=0x53c05a0, filename=0x7d2dcc1ff780, closeit=1, flags=0x7fffa58d6dd8) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:440
#38 0x00000000005fcfb3 in _PyRun_AnyFileObject (fp=0x53c05a0, filename=filename@entry=0x7d2dcc1ff780, closeit=closeit@entry=1, flags=flags@entry=0x7fffa58d6dd8) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:79
#39 0x00000000005f7dae in pymain_run_file_obj (skip_source_first_line=0, filename=0x7d2dcc1ff780, program_name=0x7d2dcc1973b0) at /usr/local/src/conda/python-3.11.13/Modules/main.c:360
#40 pymain_run_file (config=0x88f560 <_PyRuntime+59904>) at /usr/local/src/conda/python-3.11.13/Modules/main.c:379
#41 pymain_run_python (exitcode=0x7fffa58d6dd0) at /usr/local/src/conda/python-3.11.13/Modules/main.c:605
#42 Py_RunMain () at /usr/local/src/conda/python-3.11.13/Modules/main.c:684
#43 0x00000000005bcdf9 in Py_BytesMain (argc=<optimized out>, argv=<optimized out>) at /usr/local/src/conda/python-3.11.13/Modules/main.c:738
#44 0x00007d2dcc22a1ca in __libc_start_call_main (main=main@entry=0x5bcd50 <main>, argc=argc@entry=3, argv=argv@entry=0x7fffa58d7038) at ../sysdeps/nptl/libc_start_call_main.h:58
#45 0x00007d2dcc22a28b in __libc_start_main_impl (main=0x5bcd50 <main>, argc=3, argv=0x7fffa58d7038, init=<optimized out>, fini=<optimized out>, rtld_fini=<optimized out>, stack_end=0x7fffa58d7028) at ../csu/libc-start.c:360
#46 0x00000000005bcc43 in _start ()
---
[HIT] ucm_unset_event_handler
#0  ucm_unset_event_handler (events=2228224, cb=0x7d2d718b2100 <ucs_rcache_unmapped_callback>, arg=0x12a58060) at event/event.c:642
#1  0x00007d2d718b4d9b in ucs_rcache_t_cleanup (self=0x12a58060) at memory/rcache.c:1391
#2  0x00007d2d718cb331 in ucs_class_call_cleanup_chain (cls=0x7d2d718fa420 <ucs_rcache_t_class>, obj=0x12a58060, limit=-1) at type/class.c:56
#3  0x00007d2d718b5076 in ucs_rcache_destroy (self=0x12a58060) at memory/rcache.c:1421
#4  0x00007d2c99488448 in ucp_mem_rcache_cleanup (context=0x12a51690) at core/ucp_mm.c:1713
#5  0x00007d2c9943f289 in ucp_cleanup (context=0x12a51690) at core/ucp_context.c:2355
#6  0x00007d2c99aa853d in ucc_tl_ucp_worker_cleanup (worker=...) at tl_ucp_context.c:437
#7  0x00007d2c99aa86d5 in ucc_tl_ucp_context_t_cleanup (self=0x122ade10) at tl_ucp_context.c:464
#8  0x00007d2d718cb331 in ucs_class_call_cleanup_chain (cls=0x7d2c99b147a0 <ucc_tl_ucp_context_t_class>, obj=0x122ade10, limit=-1) at type/class.c:56
#9  0x00007d2c99aa391c in ucc_tl_ucp_context_t_delete (self=0x122ade10) at tl_ucp.c:297
#10 0x00007d2da8bc9efb in ucc_context_destroy (context=0x12a3c3e0) at core/ucc_context.c:931
#11 0x00007d2c9999e23d in c10d::CommUCC::~CommUCC (this=0x1229f008, __in_chrg=<optimized out>) at /data/ZYH/torch_ucc/src/torch_ucc_comm.cpp:261
#12 0x00007d2c9992f35d in c10d::Comm::~Comm (this=0x1229efd0, __in_chrg=<optimized out>) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:360
#13 0x00007d2c999998d7 in std::_Destroy<c10d::Comm> (__pointer=0x1229efd0) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/stl_construct.h:151
#14 0x00007d2c9999970c in std::allocator_traits<std::allocator<void> >::destroy<c10d::Comm> (__p=0x1229efd0) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/alloc_traits.h:648
#15 0x00007d2c99999328 in std::_Sp_counted_ptr_inplace<c10d::Comm, std::allocator<void>, (__gnu_cxx::_Lock_policy)2>::_M_dispose (this=0x1229efc0) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr_base.h:613
#16 0x00007d2c99955479 in std::_Sp_counted_base<(__gnu_cxx::_Lock_policy)2>::_M_release_last_use (this=0x1229efc0) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr_base.h:175
#17 0x00007d2c9993ed13 in std::_Sp_counted_base<(__gnu_cxx::_Lock_policy)2>::_M_release_last_use_cold (this=0x1229efc0) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr_base.h:199
#18 0x00007d2c999196e0 in std::_Sp_counted_base<(__gnu_cxx::_Lock_policy)2>::_M_release (this=0x1229efc0) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr_base.h:353
#19 0x00007d2c9993f602 in std::__shared_count<(__gnu_cxx::_Lock_policy)2>::~__shared_count (this=0x7fffa58d6528, __in_chrg=<optimized out>) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr_base.h:1071
#20 0x00007d2c9992baab in std::__shared_ptr<c10d::Comm, (__gnu_cxx::_Lock_policy)2>::~__shared_ptr (this=0x7fffa58d6520, __in_chrg=<optimized out>) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr_base.h:1524
#21 0x00007d2c9995fbbe in std::__shared_ptr<c10d::Comm, (__gnu_cxx::_Lock_policy)2>::operator= (this=0xa9b14e8, __r=...) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr_base.h:1620
#22 0x00007d2c9994949a in std::shared_ptr<c10d::Comm>::operator= (this=0xa9b14e8, __r=...) at /home/e0355@innostar-ic.com/miniconda3/envs/torch-dbg/lib/gcc/x86_64-conda-linux-gnu/12.4.0/include/c++/bits/shared_ptr.h:440
#23 0x00007d2c99935129 in c10d::ProcessGroupUCC::~ProcessGroupUCC (this=0xa9b13a0, __in_chrg=<optimized out>) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:810
#24 0x00007d2c99935501 in c10d::ProcessGroupUCC::~ProcessGroupUCC (this=0xa9b13a0, __in_chrg=<optimized out>) at /data/ZYH/torch_ucc/src/torch_ucc.cpp:812
#25 0x00007d2dca3254dd in c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> >::reset_ (this=0x7d2c9a4d4288) at /data/ZYH/pytorch/c10/util/intrusive_ptr.h:297
#26 0x00007d2dca30094a in c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> >::~intrusive_ptr (this=0x7d2c9a4d4288, __in_chrg=<optimized out>) at /data/ZYH/pytorch/c10/util/intrusive_ptr.h:377
#27 0x00007d2dca33fe29 in pybind11::class_<c10d::ProcessGroup, c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> >, c10d::PyProcessGroup>::dealloc (v_h=...) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/pybind11.h:1926
#28 0x00007d2dc8fdce78 in pybind11::detail::clear_instance (self=0x7d2c9a4d4270) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/detail/class.h:434
#29 0x00007d2dc8fdcfb6 in pybind11::detail::pybind11_object_dealloc (self=0x7d2c9a4d4270) at /data/ZYH/pytorch/third_party/pybind11/include/pybind11/detail/class.h:467
#30 0x0000000000522608 in _Py_Dealloc (op=<optimized out>) at /usr/local/src/conda/python-3.11.13/Objects/object.c:2390
#31 Py_DECREF (op=<optimized out>) at /usr/local/src/conda/python-3.11.13/Include/object.h:538
#32 Py_XDECREF (op=<optimized out>) at /usr/local/src/conda/python-3.11.13/Include/object.h:602
#33 _PyFrame_Clear (frame=0x7d2dcc583140) at /usr/local/src/conda/python-3.11.13/Python/frame.c:141
#34 0x0000000000511902 in _PyEvalFrameClearAndPop (frame=0x7d2dcc583140, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:6406
#35 _PyEval_EvalFrameDefault (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, frame=0x7d2dcc583090, frame@entry=0x7d2dcc583020, throwflag=throwflag@entry=0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:2435
#36 0x00000000005cd0aa in _PyEval_EvalFrame (throwflag=0, frame=0x7d2dcc583020, tstate=0x8a9518 <_PyRuntime+166328>) at /usr/local/src/conda/python-3.11.13/Include/internal/pycore_ceval.h:73
#37 _PyEval_Vector (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, func=func@entry=0x7d2dcc1d60c0, locals=locals@entry=0x7d2dcc1f69c0, args=args@entry=0x0, argcount=argcount@entry=0, kwnames=kwnames@entry=0x0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:6434
#38 0x00000000005cc77f in PyEval_EvalCode (co=co@entry=0x7d2dcc1c8030, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0) at /usr/local/src/conda/python-3.11.13/Python/ceval.c:1148
#39 0x00000000005ed557 in run_eval_code_obj (tstate=tstate@entry=0x8a9518 <_PyRuntime+166328>, co=co@entry=0x7d2dcc1c8030, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:1741
#40 0x00000000005e9080 in run_mod (mod=mod@entry=0x5431ae0, filename=filename@entry=0x7d2dcc1ff780, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0, flags=flags@entry=0x7fffa58d6dd8, arena=arena@entry=0x7d2dcc11b670) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:1762
#41 0x00000000005fde72 in pyrun_file (fp=fp@entry=0x53c05a0, filename=filename@entry=0x7d2dcc1ff780, start=start@entry=257, globals=globals@entry=0x7d2dcc1f69c0, locals=locals@entry=0x7d2dcc1f69c0, closeit=closeit@entry=1, flags=0x7fffa58d6dd8) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:1657
#42 0x00000000005fd28f in _PyRun_SimpleFileObject (fp=0x53c05a0, filename=0x7d2dcc1ff780, closeit=1, flags=0x7fffa58d6dd8) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:440
#43 0x00000000005fcfb3 in _PyRun_AnyFileObject (fp=0x53c05a0, filename=filename@entry=0x7d2dcc1ff780, closeit=closeit@entry=1, flags=flags@entry=0x7fffa58d6dd8) at /usr/local/src/conda/python-3.11.13/Python/pythonrun.c:79
#44 0x00000000005f7dae in pymain_run_file_obj (skip_source_first_line=0, filename=0x7d2dcc1ff780, program_name=0x7d2dcc1973b0) at /usr/local/src/conda/python-3.11.13/Modules/main.c:360
#45 pymain_run_file (config=0x88f560 <_PyRuntime+59904>) at /usr/local/src/conda/python-3.11.13/Modules/main.c:379
#46 pymain_run_python (exitcode=0x7fffa58d6dd0) at /usr/local/src/conda/python-3.11.13/Modules/main.c:605
#47 Py_RunMain () at /usr/local/src/conda/python-3.11.13/Modules/main.c:684
#48 0x00000000005bcdf9 in Py_BytesMain (argc=<optimized out>, argv=<optimized out>) at /usr/local/src/conda/python-3.11.13/Modules/main.c:738
#49 0x00007d2dcc22a1ca in __libc_start_call_main (main=main@entry=0x5bcd50 <main>, argc=argc@entry=3, argv=argv@entry=0x7fffa58d7038) at ../sysdeps/nptl/libc_start_call_main.h:58